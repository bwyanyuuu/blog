<!DOCTYPE HTML>
<!--
    Massively by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
    -->
<html>
    <head>
        <title>Computer Networking - Hcyanyuuu's Blog</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
        <!-- <link rel="stylesheet" href="https://assets.hackmd.io/build/emojify.js/dist/css/basic/emojify.min.css">
            <link href="https://assets.hackmd.io/build/font-vendor.b86e2bf451b246b1a88e.css" rel="stylesheet">
            <link href="https://assets.hackmd.io/build/common-vendor.b8ecfc406ac0b5f77a26.css" rel="stylesheet">
            <link rel="stylesheet" href="assets/css/main.css" /><link rel="stylesheet" href="assets/css/index-vendor.8a602875f0438be6661b.css">
            <link href="https://assets.hackmd.io/build/index.41f65c147f42ef2a6007.css"rel="stylesheet">--> 
        <link rel="stylesheet" href="assets/css/font-awesome.min.css" />
        <link rel="stylesheet" href="assets/css/ionicons.min.css" />
        <link rel="stylesheet" href="assets/css/octicons.min.css" />
        <link rel="stylesheet" href="assets/css/prism.min.css" />
        <link rel="stylesheet" href="assets/css/emojify.min.css" />
        <link rel="stylesheet" href="assets/css/index-vendor.8a602875f0438be6661b.css" />
        <link rel="stylesheet" href="assets/css/main.css" />
        <link rel="stylesheet" href="assets/css/style.css" />
        <noscript>
            <link rel="stylesheet" href="assets/css/noscript.css" />
        </noscript>
        <script charset="utf-8" src="https://assets.hackmd.io/build/MathJax/config/TeX-AMS_CHTML.js?v=2.7.5"></script>
        <link rel="stylesheet" href="assets/css/latex.css" />
        <script charset="utf-8" src="https://assets.hackmd.io/build/MathJax/extensions/Safe.js?v=2.7.5"></script>
        <link rel="stylesheet" href="assets/css/latex2.css" />
        <link rel="icon" type="image/png" href="images/icon.png">
    </head>
    <body class="is-preload">
        <!-- Wrapper -->
        <div id="wrapper">
        <!-- Header -->
        <header id="header">
            <a class="logo"><img src="images/logo.png" alt="" /></a>
        </header>
        <!-- Nav -->
        <nav id="nav">
            <ul class="links">
                <li><a href="index.html">Home</a></li>
                <!--<li><a href="cn.html">Computer Networking</a></li>-->
            </ul>
            <ul class="icons">
                <li><a href="https://github.com/hcyanyuuu" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
            </ul>
        </nav>
        <!-- Main -->
        <div id="main">
            <!-- Post -->
            <section class="post">
            <header class="major">
                <span class="date">Febuary 2, 2020</span>
                <h1>Computer Networking</h1>
            </header>
            <!-- Text stuff -->
            <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true" style="position: relative;">
                <h2 id="Directory"><a class="anchor hidden-xs" href="#Directory" title="Directory"><span class="octicon octicon-link"></span></a>Directory</h2>
                <p>
                    <span class="toc">
                <ul>
                <li><a href="#Introduction" title="Introduction">Introduction</a><ul>
                <li><a href="#“Nuts-and-Bolts”-View" title="“Nuts and Bolts” View">“Nuts and Bolts” View</a></li>
                <li><a href="#Network-Structure" title="Network Structure">Network Structure</a></li>
                <li><a href="#Access-networks" title="Access networks">Access networks</a></li>
                <li><a href="#Physical-media" title="Physical media">Physical media</a></li>
                <li><a href="#Network-Core" title="Network Core">Network Core</a><ul>
                <li><a href="#Circuit-Switching" title="Circuit Switching">Circuit Switching</a></li>
                <li><a href="#Packet-Switching" title="Packet Switching">Packet Switching</a></li>
                <li><a href="#比較" title="比較">比較</a></li>
                </ul>
                </li>
                <li><a href="#計算" title="計算">計算</a></li>
                <li><a href="#Layer--Protocal" title="Layer + Protocal">Layer + Protocal</a></li>
                </ul>
                </li>
                <li><a href="#Application-Layer" title="Application Layer">Application Layer</a><ul>
                <li><a href="#HTTP--HyperText-Transer-Protocal-" title="HTTP ( HyperText Transer Protocal )">HTTP ( HyperText Transer Protocal )</a><ul>
                <li><a href="#use-TCP" title="use TCP">use TCP</a></li>
                <li><a href="#Stateless-" title="Stateless :">Stateless :</a></li>
                <li><a href="#HTTP-Connections-" title="HTTP Connections :">HTTP Connections :</a></li>
                <li><a href="#Request-Message" title="Request Message">Request Message</a></li>
                <li><a href="#Response-Message" title="Response Message">Response Message</a></li>
                <li><a href="#User-server-State--cookie" title="User-server State : cookie">User-server State : cookie</a></li>
                <li><a href="#Web-Caches-proxy-server-代理伺服器-" title="Web Caches (proxy server 代理伺服器) :">Web Caches (proxy server 代理伺服器) :</a></li>
                <li><a href="#Conditional-GET" title="Conditional GET">Conditional GET</a></li>
                </ul>
                </li>
                <li><a href="#Electronic-Email" title="Electronic Email">Electronic Email</a><ul>
                <li><a href="#3-major-components" title="3 major components:">3 major components:</a></li>
                <li><a href="#過程：" title="過程：">過程：</a></li>
                <li><a href="#實作-不需要outlook…等等，打指令即可完成" title="實作 (不需要outlook…等等，打指令即可完成)">實作 (不需要outlook…等等，打指令即可完成)</a></li>
                <li><a href="#接收會用到的3種protocal" title="接收會用到的3種protocal">接收會用到的3種protocal</a></li>
                </ul>
                </li>
                <li><a href="#DNS-Domain-Name-System" title="DNS (Domain Name System)">DNS (Domain Name System)</a><ul>
                <li><a href="#功能" title="功能">功能</a></li>
                <li><a href="#Hierarchy-階層性" title="Hierarchy 階層性">Hierarchy 階層性</a></li>
                <li><a href="#Name-Severs" title="Name Severs">Name Severs</a></li>
                <li><a href="#過程" title="過程">過程</a></li>
                <li><a href="#DNS-Records-amp-msg" title="DNS Records &amp; msg">DNS Records &amp; msg</a></li>
                <li><a href="#建立新的-DNS-伺服器" title="建立新的 DNS 伺服器">建立新的 DNS 伺服器</a></li>
                <li><a href="#Attack-DNS" title="Attack DNS">Attack DNS</a></li>
                </ul>
                </li>
                <li><a href="#Video-Streaming-and-Content-Distribution-Networks" title="Video Streaming and Content Distribution Networks">Video Streaming and Content Distribution Networks</a><ul>
                <li><a href="#Multimedia--video" title="Multimedia : video">Multimedia : video</a></li>
                <li><a href="#Streaming-multimedia--DASH-Dynamic-Adaptive-Streaming-over-HTTP" title="Streaming multimedia : DASH (Dynamic, Adaptive Streaming over HTTP)">Streaming multimedia : DASH (Dynamic, Adaptive Streaming over HTTP)</a></li>
                <li><a href="#Content-Distribution-Networks-CDNs" title="Content Distribution Networks (CDNs)">Content Distribution Networks (CDNs)</a></li>
                </ul>
                </li>
                <li><a href="#Socket-Programming" title="Socket Programming">Socket Programming</a></li>
                <li><a href="#important-themes" title="important themes:">important themes:</a></li>
                </ul>
                </li>
                <li><a href="#Transport-Layer" title="Transport Layer">Transport Layer</a><ul>
                <li><a href="#Transport-Service" title="Transport Service">Transport Service</a></li>
                <li><a href="#TCP" title="TCP">TCP</a></li>
                <li><a href="#UDP-User-Datagram-Protocal-RFC-768" title="UDP (User Datagram Protocal) [RFC 768]">UDP (User Datagram Protocal) [RFC 768]</a></li>
                <li><a href="#Multiplexingdemultiplexing" title="Multiplexing/demultiplexing">Multiplexing/demultiplexing</a></li>
                <li><a href="#Principles-of-reliable-data-transfer" title="Principles of reliable data transfer">Principles of reliable data transfer</a><ul>
                <li><a href="#Pipelined-Protocal：" title="Pipelined Protocal：">Pipelined Protocal：</a></li>
                </ul>
                </li>
                <li><a href="#TCP1" title="TCP">TCP</a><ul>
                <li><a href="#TCP-fast-retransmit" title="TCP fast retransmit">TCP fast retransmit</a></li>
                <li><a href="#Flow-Control" title="Flow Control">Flow Control</a></li>
                <li><a href="#Connection-Management" title="Connection Management">Connection Management</a></li>
                <li><a href="#Congestion-Control" title="Congestion Control">Congestion Control</a></li>
                </ul>
                </li>
                </ul>
                </li>
                <li><a href="#Network-Layer" title="Network Layer">Network Layer</a><ul>
                <li><a href="#Overview-of-Network-layer" title="Overview of Network layer">Overview of Network layer</a></li>
                <li><a href="#Router-內部" title="Router 內部">Router 內部</a><ul>
                <li><a href="#Switching-fabrics-交換的方法" title="Switching fabrics (交換的方法)">Switching fabrics (交換的方法)</a></li>
                <li><a href="#Queuing" title="Queuing">Queuing</a></li>
                </ul>
                </li>
                <li><a href="#IP" title="IP">IP</a><ul>
                <li><a href="#IP-addressing-introduction" title="IP addressing: introduction">IP addressing: introduction</a></li>
                </ul>
                </li>
                <li><a href="#Dynamic-Host-Configuration-Protocol-DHCP" title="Dynamic Host Configuration Protocol (DHCP)">Dynamic Host Configuration Protocol (DHCP)</a></li>
                <li><a href="#Network-Address-Translation-NAT" title="Network Address Translation (NAT)">Network Address Translation (NAT)</a></li>
                <li><a href="#Routing-Protocol-amp-Static-Route" title="Routing Protocol &amp; Static Route">Routing Protocol &amp; Static Route</a><ul>
                <li><a href="#Dijkstra’s-algorithm-Link-State" title="Dijkstra’s algorithm (Link State)">Dijkstra’s algorithm (Link State)</a></li>
                <li><a href="#Distance-vector-algorithm-Bellman-Ford" title="Distance vector algorithm (Bellman-Ford)">Distance vector algorithm (Bellman-Ford)</a></li>
                <li><a href="#Routing-Information-Protocol-RIP" title="Routing Information Protocol (RIP)">Routing Information Protocol (RIP)</a></li>
                <li><a href="#OSPF-Open-Shortest-Path-First" title="OSPF (Open Shortest Path First)">OSPF (Open Shortest Path First)</a></li>
                <li><a href="#Static-route-amp-Default-route" title="Static route &amp; Default route">Static route &amp; Default route</a></li>
                </ul>
                </li>
                <li><a href="#Access-Control-List-ACL" title="Access Control List (ACL)">Access Control List (ACL)</a></li>
                <li><a href="#Simple-Network-Management-Protocol" title="Simple Network Management Protocol">Simple Network Management Protocol</a></li>
                </ul>
                </li>
                <li><a href="#Data-Link-Layer" title="Data-Link Layer">Data-Link Layer</a><ul>
                <li><a href="#Introduction1" title="Introduction">Introduction</a></li>
                <li><a href="#Error-detection" title="Error detection">Error detection</a></li>
                <li><a href="#Multiple-access-protocols" title="Multiple access protocols">Multiple access protocols</a><ul>
                <li><a href="#Channel-Partitioning" title="Channel Partitioning">Channel Partitioning</a></li>
                <li><a href="#Random-Access" title="Random Access">Random Access</a></li>
                <li><a href="#“Taking-Turns”" title="“Taking Turns”">“Taking Turns”</a></li>
                </ul>
                </li>
                <li><a href="#MAC-address" title="MAC address">MAC address</a></li>
                <li><a href="#ARP-address-resolution-protocol" title="ARP (address resolution protocol)">ARP (address resolution protocol)</a></li>
                <li><a href="#Ethernet" title="Ethernet">Ethernet</a></li>
                <li><a href="#Ethernet-switch" title="Ethernet switch">Ethernet switch</a></li>
                <li><a href="#VLAN-Virtual-LAN" title="VLAN (Virtual LAN)">VLAN (Virtual LAN)</a><ul>
                <li><a href="#IEEE-8021Q-Frame：" title="IEEE 802.1Q (Frame)：">IEEE 802.1Q (Frame)：</a></li>
                <li><a href="#VLAN-aware-Network：" title="VLAN-aware Network：">VLAN-aware Network：</a></li>
                <li><a href="#VLAN-間的-routing-→-Inter-VLAN-routing" title="VLAN 間的 routing → Inter-VLAN routing">VLAN 間的 routing → Inter-VLAN routing</a></li>
                </ul>
                </li>
                <li><a href="#STP-Spanning-Tree-Protocal-8021D" title="STP (Spanning Tree Protocal) (802.1D)">STP (Spanning Tree Protocal) (802.1D)</a><ul>
                <li><a href="#RSTP-Rapid-Spanning-Tree-Protocol-8021W" title="RSTP (Rapid Spanning Tree Protocol) (802.1W)">RSTP (Rapid Spanning Tree Protocol) (802.1W)</a></li>
                <li><a href="#BDPU-Bridge-Protocol-Data-Units-8023-Ethernet" title="BDPU (Bridge Protocol Data Units) (802.3 Ethernet)">BDPU (Bridge Protocol Data Units) (802.3 Ethernet)</a></li>
                </ul>
                </li>
                <li><a href="#Virtual-Private-Network-VPN-" title="Virtual Private Network (VPN) ">Virtual Private Network (VPN) </a></li>
                <li><a href="#Security" title="Security">Security</a><ul>
                <li><a href="#Cisco-Discovery-Protocol-CDP" title="Cisco Discovery Protocol (CDP)">Cisco Discovery Protocol (CDP)</a></li>
                <li><a href="#Telnet-Attacks" title="Telnet Attacks">Telnet Attacks</a></li>
                <li><a href="#ARP-Spoofing" title="ARP Spoofing">ARP Spoofing</a></li>
                <li><a href="#MAC-Spoofing" title="MAC Spoofing">MAC Spoofing</a></li>
                <li><a href="#VLAN-Hopping" title="VLAN Hopping">VLAN Hopping</a></li>
                <li><a href="#Two-types-of-DHCP-attacks" title="Two types of DHCP attacks">Two types of DHCP attacks</a></li>
                </ul>
                </li>
                <li><a href="#EtherChannel-Link-Aggregation" title="EtherChannel (Link Aggregation)">EtherChannel (Link Aggregation)</a></li>
                <li><a href="#First-Hop-Redundancy-Protocols-FHRP" title="First Hop Redundancy Protocols (FHRP)">First Hop Redundancy Protocols (FHRP)</a><ul>
                <li><a href="#Hot-Standby-Router-Protocol-HSRP" title="Hot Standby Router Protocol (HSRP)">Hot Standby Router Protocol (HSRP)</a></li>
                <li><a href="#Virtual-Router-Redundancy-Protocol-VRRP-RFC-2338" title="Virtual Router Redundancy Protocol (VRRP) (RFC 2338">Virtual Router Redundancy Protocol (VRRP) (RFC 2338</a></li>
                </ul>
                </li>
                <li><a href="#網路協定-amp-Port-Number" title="網路協定 &amp; Port Number">網路協定 &amp; Port Number</a></li>
                </ul>
                </li>
                </ul>
                </span></p>
                <p><a href="https://sls.weco.net/CollectiveNote20/Network" target="_blank" rel="noopener">https://sls.weco.net/CollectiveNote20/Network</a></p>
                <h2 id="Introduction"><a class="anchor hidden-xs" href="#Introduction" title="Introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>
                <h3 id="“Nuts-and-Bolts”-View"><a class="anchor hidden-xs" href="#“Nuts-and-Bolts”-View" title="“Nuts-and-Bolts”-View"><span class="octicon octicon-link"></span></a>“Nuts and Bolts” View</h3>
                <p>● 億萬個 computing devices　　　　　　　　● communication links<br>
                    　　◇ hosts = end systems　　　　　　　　　 　◇ fiber, copper, radio, satellite<br>
                    　　◇ running network apps　 　 　　　　　　　◇ transmission rate : bandwidth<br>
                    ● packet switches 　　　　　　　 　　　　 　● Internet standards<br>
                    　　◇ forward packets (chunks of data) 　　 　　 ◇ RFC : Request for comments<br>
                    　　◇ routersand switches 　　 　 　 　 　 　　　◇ IETF : Internet Engineering Task Force<br>
                    ● Protocols 控制接收、發送訊息　 　 　　　　● Internet: “network of networks”<br>
                    　　◇ Ex. TCP, IP, HTTP, Skype, 802.11 　　　　 　◇ Interconnected ISPs
                </p>
                <h3 id="Network-Structure"><a class="anchor hidden-xs" href="#Network-Structure" title="Network-Structure"><span class="octicon octicon-link"></span></a>Network Structure</h3>
                <p>● network edge :　　　　　　　　　　 　 　　● network core:<br>
                    　　◇ hosts : clients and servers　　　　　　　　 ◇ interconnected routers<br>
                    　　◇ servers often in data centers　　　　　　　◇ network of networks<br>
                    ● access networks, physical media :　　　 　　 ● shared or dedicated (獨享)?<br>
                    　　◇ wired, wireless communication links
                </p>
                <h3 id="Access-networks"><a class="anchor hidden-xs" href="#Access-networks" title="Access-networks"><span class="octicon octicon-link"></span></a>Access networks</h3>
                <ul>
                    <li>
                        <p>digital subscriber line (DSL) <img src="https://i.imgur.com/JjYPygF.png" alt="" width="500" height="200"></p>
                        <ul>
                            <li>&lt; 2.5 Mbps upstream rate (通常 &lt; 1 Mbps)</li>
                            <li>&lt; 24 Mbps downstream rate (通常 &lt; 10 Mbps)</li>
                        </ul>
                    </li>
                    <li>
                        <p>cable network<br>
                            <img src="https://i.imgur.com/I1dtvnB.png" alt="" width="550" height="200">
                        </p>
                        <ul>
                            <li>frequency division multiplexing : 用頻率區分頻道</li>
                            <li>
                                HFC : hybrid fiber coax
                                <ul>
                                    <li>30Mbps downstream, 2 Mbps upstream</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>home network<br>
                            <img src="https://i.imgur.com/yfgYLfn.png" alt="" width="460" height="300">
                        </p>
                    </li>
                    <li>
                        <p>Enterprise access networks<br>
                            <img src="https://i.imgur.com/sUyO619.png" alt="" width="470" height="200">
                        </p>
                        <ul>
                            <li>10 Mbps, 100Mbps, 1Gbps, 10Gbps</li>
                            <li>通常連到 Ethernet switch</li>
                        </ul>
                    </li>
                    <li>
                        <p>Wireless access networks<img src="https://i.imgur.com/44TmeYh.png" alt="" width="550" height="270"></p>
                    </li>
                </ul>
                <h3 id="Physical-media"><a class="anchor hidden-xs" href="#Physical-media" title="Physical-media"><span class="octicon octicon-link"></span></a>Physical media</h3>
                <ul>
                    <li>physical link : 在送收端中間那條實體的線</li>
                </ul>
                <ol>
                    <li>
                        guided media :
                        <ul>
                            <li>訊號在介質裡傳播 : copper, fiber, coax</li>
                        </ul>
                    </li>
                    <li>unguided media : 不需介質，例如：radio</li>
                </ol>
                <ul>
                    <li>
                        twisted pair (TP) (雙絞線)
                        <ul>
                            <li>
                                兩根絕緣 copper wires (銅線)
                                <ul>
                                    <li>Category 5: 100 Mbps, 1 Gbps Ethernet</li>
                                    <li>Category 6: 10Gbps</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        coaxial cable (同軸纜線) :
                        <ul>
                            <li>兩根同心銅導體、雙向</li>
                            <li>
                                broadband :
                                <ul>
                                    <li>multiple channels on cable、HFC</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        fiber optic cable (光纖電纜) :
                        <ul>
                            <li>玻璃纖維載有光脈衝 (light pulses), each pulse a bit</li>
                            <li>
                                高速運行 :
                                <ul>
                                    <li>高速點對點傳輸 (例如：10’s-100’s Gbps transmission rate)</li>
                                </ul>
                            </li>
                            <li>
                                錯誤率低：
                                <ul>
                                    <li>中繼器相距很遠</li>
                                    <li>抗電磁噪聲</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        radio link types:
                        <ul>
                            <li>terrestrial microwave (地面微波)：高達 45 Mbps channels</li>
                            <li>LAN (例如：WiFi)：54 Mbps</li>
                            <li>wide-area (例如：cellular)：4G cellular → ~ 10 Mbps</li>
                            <li>
                                衛星
                                <ul>
                                    <li>Kbps to 45Mbps channel (或多個較小的通道)</li>
                                    <li>270毫秒的終端延遲 (end-end delay)</li>
                                    <li>地球同步與低海拔</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Network-Core"><a class="anchor hidden-xs" href="#Network-Core" title="Network-Core"><span class="octicon octicon-link"></span></a>Network Core</h3>
                <ul>
                    <li>routing : 決定把封包送去哪</li>
                    <li>forwarding : 把封包傳出去</li>
                </ul>
                <h4 id="Circuit-Switching"><a class="anchor hidden-xs" href="#Circuit-Switching" title="Circuit-Switching"><span class="octicon octicon-link"></span></a>Circuit Switching</h4>
                <ul>
                    <li>switch間很多條線，選一條拿到就獨享</li>
                    <li><img src="https://i.imgur.com/JrnAD4G.png" alt="" width="400" height="230"></li>
                </ul>
                <h4 id="Packet-Switching"><a class="anchor hidden-xs" href="#Packet-Switching" title="Packet-Switching"><span class="octicon octicon-link"></span></a>Packet Switching</h4>
                <ul>
                    <li>可以容納更多人使用，因為不會每一刻都多人在用 → 提高效率</li>
                    <li>非常適合突發數據：資源共享，更簡單，無需建連線</li>
                    <li>可能出現過度擁塞：數據包延遲和丟失 → protocal 需要可靠的數據傳輸，塞車控制</li>
                </ul>
                <h4 id="比較"><a class="anchor hidden-xs" href="#比較" title="比較"><span class="octicon octicon-link"></span></a>比較</h4>
                <p><img src="https://i.imgur.com/OD0OO2N.png" alt=""></p>
                <h3 id="計算"><a class="anchor hidden-xs" href="#計算" title="計算"><span class="octicon octicon-link"></span></a>計算</h3>
                <p><img src="https://i.imgur.com/htUObF3.png" alt=""></p>
                <ul>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mi>o</mi><mi>d</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>c</mi></mrow></msub><mo>+</mo><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>u</mi><mi>e</mi></mrow></msub><mo>+</mo><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub><mo>=</mo><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-4" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-5" class="mjx-texatom" style=""><span id="MJXc-Node-6" class="mjx-mrow"><span id="MJXc-Node-7" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-8" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-9" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-10" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-11" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">l</span></span></span></span></span></span><span id="MJXc-Node-12" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-13" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-14" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-15" class="mjx-texatom" style=""><span id="MJXc-Node-16" class="mjx-mrow"><span id="MJXc-Node-17" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-18" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-19" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-20" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span></span></span></span></span><span id="MJXc-Node-21" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-22" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-23" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-24" class="mjx-texatom" style=""><span id="MJXc-Node-25" class="mjx-mrow"><span id="MJXc-Node-26" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-27" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-28" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-29" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-30" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span></span></span></span></span><span id="MJXc-Node-31" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-32" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-33" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-34" class="mjx-texatom" style=""><span id="MJXc-Node-35" class="mjx-mrow"><span id="MJXc-Node-36" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-37" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-38" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-39" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-40" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span></span></span><span id="MJXc-Node-41" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-42" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-43" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-44" class="mjx-texatom" style=""><span id="MJXc-Node-45" class="mjx-mrow"><span id="MJXc-Node-46" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-47" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-48" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-49" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span></span></span><span id="MJXc-Node-50" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-51" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-52" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-53" class="mjx-texatom" style=""><span id="MJXc-Node-54" class="mjx-mrow"><span id="MJXc-Node-55" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-56" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-57" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-58" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-59" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">l</span></span></span></span></span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>n</mi>
                                                <mi>o</mi>
                                                <mi>d</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                        <mo>=</mo>
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>p</mi>
                                                <mi>r</mi>
                                                <mi>o</mi>
                                                <mi>c</mi>
                                            </mrow>
                                        </msub>
                                        <mo>+</mo>
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>q</mi>
                                                <mi>u</mi>
                                                <mi>e</mi>
                                                <mi>u</mi>
                                                <mi>e</mi>
                                            </mrow>
                                        </msub>
                                        <mo>+</mo>
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>t</mi>
                                                <mi>r</mi>
                                                <mi>a</mi>
                                                <mi>n</mi>
                                                <mi>s</mi>
                                            </mrow>
                                        </msub>
                                        <mo>+</mo>
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>p</mi>
                                                <mi>r</mi>
                                                <mi>o</mi>
                                                <mi>p</mi>
                                            </mrow>
                                        </msub>
                                        <mo>=</mo>
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>t</mi>
                                                <mi>o</mi>
                                                <mi>t</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-1">d_{nodal}= d_{proc}+ d_{queue}+ d_{trans}+ d_{prop} = d_{total}</script>
                        </span>
                        (sec)
                    </li>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>c</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-60" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-61" class="mjx-mrow"><span id="MJXc-Node-62" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-63" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-64" class="mjx-texatom" style=""><span id="MJXc-Node-65" class="mjx-mrow"><span id="MJXc-Node-66" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-67" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-68" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-69" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span></span></span></span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>p</mi>
                                                <mi>r</mi>
                                                <mi>o</mi>
                                                <mi>c</mi>
                                            </mrow>
                                        </msub>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-2">d_{proc}</script>
                        </span>
                        nodal processing (&lt; msec)：檢查 bit errors、決定要從哪個埠出去
                    </li>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mi>u</mi><mi>e</mi><mi>u</mi><mi>e</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-70" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-71" class="mjx-mrow"><span id="MJXc-Node-72" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-73" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-74" class="mjx-texatom" style=""><span id="MJXc-Node-75" class="mjx-mrow"><span id="MJXc-Node-76" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em; padding-right: 0.014em;">q</span></span><span id="MJXc-Node-77" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-78" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-79" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-80" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span></span></span></span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>q</mi>
                                                <mi>u</mi>
                                                <mi>e</mi>
                                                <mi>u</mi>
                                                <mi>e</mi>
                                            </mrow>
                                        </msub>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-3">d_{queue}</script>
                        </span>
                        queueing delay：
                        <ul>
                            <li>排隊的時間，與交通壅塞度成正比</li>
                            <li>a：單位時間封包平均到達率 (pkt / sec)</li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi>L</mi><mi>a</mi></mrow><mi>R</mi></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-81" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-82" class="mjx-mrow"><span id="MJXc-Node-83" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.997em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.41em; top: -1.335em;"><span id="MJXc-Node-84" class="mjx-mrow" style=""><span id="MJXc-Node-85" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">L</span></span><span id="MJXc-Node-86" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.41em; bottom: -0.638em;"><span id="MJXc-Node-87" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.997em;"></span></span><span class="mjx-vsize" style="height: 1.395em; vertical-align: -0.451em;"></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfrac>
                                                    <mrow>
                                                        <mi>L</mi>
                                                        <mi>a</mi>
                                                    </mrow>
                                                    <mi>R</mi>
                                                </mfrac>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-4">\frac{La}{R}</script>
                                </span>
                                ~ 0：延遲少
                            </li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi>L</mi><mi>a</mi></mrow><mi>R</mi></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-88" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-89" class="mjx-mrow"><span id="MJXc-Node-90" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.997em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.41em; top: -1.335em;"><span id="MJXc-Node-91" class="mjx-mrow" style=""><span id="MJXc-Node-92" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">L</span></span><span id="MJXc-Node-93" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.41em; bottom: -0.638em;"><span id="MJXc-Node-94" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.997em;"></span></span><span class="mjx-vsize" style="height: 1.395em; vertical-align: -0.451em;"></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfrac>
                                                    <mrow>
                                                        <mi>L</mi>
                                                        <mi>a</mi>
                                                    </mrow>
                                                    <mi>R</mi>
                                                </mfrac>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-5">\frac{La}{R}</script>
                                </span>
                                &gt; 1：延遲多，封包到達速度比處理速度還快 → 永遠的延遲
                            </li>
                        </ul>
                    </li>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-95" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-96" class="mjx-mrow"><span id="MJXc-Node-97" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-98" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-99" class="mjx-texatom" style=""><span id="MJXc-Node-100" class="mjx-mrow"><span id="MJXc-Node-101" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-102" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-103" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-104" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-105" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span></span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>t</mi>
                                                <mi>r</mi>
                                                <mi>a</mi>
                                                <mi>n</mi>
                                                <mi>s</mi>
                                            </mrow>
                                        </msub>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-6">d_{trans}</script>
                        </span>
                        transmission delay：
                        <ul>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mo>=</mo><mfrac><mi>L</mi><mi>R</mi></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-106" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-107" class="mjx-mrow"><span id="MJXc-Node-108" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-109" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-110" class="mjx-texatom" style=""><span id="MJXc-Node-111" class="mjx-mrow"><span id="MJXc-Node-112" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-113" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-114" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-115" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span></span></span><span id="MJXc-Node-117" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-118" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.678em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.959em; top: -1.325em;"><span id="MJXc-Node-119" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">L</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.959em; bottom: -0.638em;"><span id="MJXc-Node-120" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.678em;"></span></span><span class="mjx-vsize" style="height: 1.388em; vertical-align: -0.451em;"></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msub>
                                                    <mi>d</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>t</mi>
                                                        <mi>r</mi>
                                                        <mi>a</mi>
                                                        <mi>n</mi>
                                                        <mi>s</mi>
                                                    </mrow>
                                                </msub>
                                                <mo>=</mo>
                                                <mfrac>
                                                    <mi>L</mi>
                                                    <mi>R</mi>
                                                </mfrac>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-7">d_{trans} = \frac {L}{R}</script>
                                </span>
                                ，<strong>傳到 link 上所需的時間 (跟頻寬相關)</strong>
                            </li>
                            <li>L = 封包大小 (bits)</li>
                            <li>R = transmission rate (bits/sec → bps)</li>
                            <li>store and forward：這個封包的全部都到了才會開始往下一個地方傳</li>
                            <li>
                                end-end delay = 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mn>2</mn><mi>L</mi></mrow><mi>R</mi></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-121" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-122" class="mjx-mrow"><span id="MJXc-Node-123" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.977em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.381em; top: -1.325em;"><span id="MJXc-Node-124" class="mjx-mrow" style=""><span id="MJXc-Node-125" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span><span id="MJXc-Node-126" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.381em; bottom: -0.638em;"><span id="MJXc-Node-127" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.977em;"></span></span><span class="mjx-vsize" style="height: 1.388em; vertical-align: -0.451em;"></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfrac>
                                                    <mrow>
                                                        <mn>2</mn>
                                                        <mi>L</mi>
                                                    </mrow>
                                                    <mi>R</mi>
                                                </mfrac>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-8">\frac{2L}{R}</script>
                                </span>
                                (假設無 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-128" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-129" class="mjx-mrow"><span id="MJXc-Node-130" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-131" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-132" class="mjx-texatom" style=""><span id="MJXc-Node-133" class="mjx-mrow"><span id="MJXc-Node-134" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-135" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-136" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-137" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msub>
                                                    <mi>d</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>p</mi>
                                                        <mi>r</mi>
                                                        <mi>o</mi>
                                                        <mi>p</mi>
                                                    </mrow>
                                                </msub>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-9">d_{prop}</script>
                                </span>
                                )
                            </li>
                        </ul>
                    </li>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-138" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-139" class="mjx-mrow"><span id="MJXc-Node-140" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-141" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-142" class="mjx-texatom" style=""><span id="MJXc-Node-143" class="mjx-mrow"><span id="MJXc-Node-144" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-145" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-146" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-147" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span></span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>p</mi>
                                                <mi>r</mi>
                                                <mi>o</mi>
                                                <mi>p</mi>
                                            </mrow>
                                        </msub>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-10">d_{prop}</script>
                        </span>
                        propagation delay：
                        <ul>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub><mo>=</mo><mfrac><mi>d</mi><mi>S</mi></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-148" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-149" class="mjx-mrow"><span id="MJXc-Node-150" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-151" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-152" class="mjx-texatom" style=""><span id="MJXc-Node-153" class="mjx-mrow"><span id="MJXc-Node-154" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-155" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-156" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-157" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span></span></span><span id="MJXc-Node-158" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-159" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.598em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.845em; top: -1.346em;"><span id="MJXc-Node-160" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.845em; bottom: -0.661em;"><span id="MJXc-Node-161" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.279em; padding-right: 0.032em;">S</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.598em;"></span></span><span class="mjx-vsize" style="height: 1.419em; vertical-align: -0.468em;"></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msub>
                                                    <mi>d</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>p</mi>
                                                        <mi>r</mi>
                                                        <mi>o</mi>
                                                        <mi>p</mi>
                                                    </mrow>
                                                </msub>
                                                <mo>=</mo>
                                                <mfrac>
                                                    <mi>d</mi>
                                                    <mi>S</mi>
                                                </mfrac>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-11">d_{prop}= \frac{d}{S}</script>
                                </span>
                                ，<strong>在 link 上傳遞所需的時間 (跟線長相關)</strong>
                            </li>
                            <li>d = 這條線路的長度</li>
                            <li>S = 傳遞速度 (~2x108 m/sec)</li>
                        </ul>
                    </li>
                    <li>
                        Band-width delay product = 
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo>&amp;#x00D7;</mo><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-162" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-163" class="mjx-mrow"><span id="MJXc-Node-164" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-165" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-166" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-167" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-168" class="mjx-texatom" style=""><span id="MJXc-Node-169" class="mjx-mrow"><span id="MJXc-Node-170" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-171" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-172" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-173" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span></span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi>R</mi>
                                        <mo>×</mo>
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>p</mi>
                                                <mi>r</mi>
                                                <mi>o</mi>
                                                <mi>p</mi>
                                            </mrow>
                                        </msub>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-12">R\times d_{prop}</script>
                        </span>
                        (bits)
                        <ul>
                            <li>在 link 中因為傳輸延遲可容納的 bits 數</li>
                        </ul>
                    </li>
                    <li>link 上能容納最大的 bit 數：band-width delay product 與 封包長度 的 最小值</li>
                    <li>
                        在 link 每個 bit 的長度 
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mo>=</mo><mfrac><mrow><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x9577;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5EA6;</mo></mrow></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6700;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5927;</mo></mrow><mi>b</mi><mi>i</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x6578;</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mi>d</mi><mrow><mi>R</mi><mo>&amp;#x00D7;</mo><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mi>d</mi><mrow><mi>R</mi><mo>&amp;#x00D7;</mo><mfrac><mi>d</mi><mi>S</mi></mfrac></mrow></mfrac><mo>=</mo><mfrac><mi>S</mi><mi>R</mi></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-174" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-175" class="mjx-mrow"><span id="MJXc-Node-176" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">m</span></span><span id="MJXc-Node-177" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-178" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 3.056em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 4.322em; top: -1.642em;"><span id="MJXc-Node-179" class="mjx-mrow" style=""><span id="MJXc-Node-180" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">l</span></span><span id="MJXc-Node-181" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-182" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-183" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">k</span></span><span id="MJXc-Node-184" class="mjx-texatom"><span id="MJXc-Node-185" class="mjx-mrow"><span id="MJXc-Node-186" class="mjx-mo"><span class="mjx-char" style="padding-top: 0.556em; padding-bottom: 0.224em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.299em; width: 0.996em;">長</span></span></span></span></span><span id="MJXc-Node-187" class="mjx-texatom"><span id="MJXc-Node-188" class="mjx-mrow"><span id="MJXc-Node-189" class="mjx-mo"><span class="mjx-char" style="padding-top: 0.556em; padding-bottom: 0.224em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.299em; width: 0.996em;">度</span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 4.322em; bottom: -0.934em;"><span id="MJXc-Node-190" class="mjx-mrow" style=""><span id="MJXc-Node-191" class="mjx-texatom"><span id="MJXc-Node-192" class="mjx-mrow"><span id="MJXc-Node-193" class="mjx-mo"><span class="mjx-char" style="padding-top: 0.556em; padding-bottom: 0.224em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.299em; width: 0.996em;">最</span></span></span></span></span><span id="MJXc-Node-194" class="mjx-texatom"><span id="MJXc-Node-195" class="mjx-mrow"><span id="MJXc-Node-196" class="mjx-mo"><span class="mjx-char" style="padding-top: 0.556em; padding-bottom: 0.224em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.299em; width: 0.996em;">大</span></span></span></span></span><span id="MJXc-Node-197" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-199" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-200" class="mjx-texatom"><span id="MJXc-Node-201" class="mjx-mrow"><span id="MJXc-Node-202" class="mjx-mo"><span class="mjx-char" style="padding-top: 0.556em; padding-bottom: 0.224em;"><span class="mjx-charbox MJXc-TeX-unknown-R" style="padding-bottom: 0.299em; width: 0.996em;">數</span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 3.056em;"></span></span><span class="mjx-vsize" style="height: 1.821em; vertical-align: -0.661em;"></span></span><span id="MJXc-Node-203" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-204" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 2.592em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 3.666em; top: -1.346em;"><span id="MJXc-Node-205" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 3.666em; bottom: -0.908em;"><span id="MJXc-Node-206" class="mjx-mrow" style=""><span id="MJXc-Node-207" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-208" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-209" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-210" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-211" class="mjx-texatom" style=""><span id="MJXc-Node-212" class="mjx-mrow"><span id="MJXc-Node-213" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-214" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-215" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-216" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 2.592em;"></span></span><span class="mjx-vsize" style="height: 1.594em; vertical-align: -0.642em;"></span></span><span id="MJXc-Node-217" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-218" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.82em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.575em; top: -1.346em;"><span id="MJXc-Node-219" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.575em; bottom: -1.344em;"><span id="MJXc-Node-220" class="mjx-mrow" style=""><span id="MJXc-Node-221" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-222" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-223" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.598em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.845em; top: -1.374em;"><span id="MJXc-Node-224" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.845em; bottom: -0.69em;"><span id="MJXc-Node-225" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.279em; padding-right: 0.032em;">S</span></span></span><span class="mjx-line" style="border-bottom: 1.1px solid; top: -0.292em; width: 0.598em;"></span></span><span class="mjx-vsize" style="height: 1.46em; vertical-align: -0.488em;"></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 1.82em;"></span></span><span class="mjx-vsize" style="height: 1.902em; vertical-align: -0.95em;"></span></span><span id="MJXc-Node-226" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-227" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.678em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.959em; top: -1.369em;"><span id="MJXc-Node-228" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.279em; padding-right: 0.032em;">S</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.959em; bottom: -0.638em;"><span id="MJXc-Node-229" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.678em;"></span></span><span class="mjx-vsize" style="height: 1.419em; vertical-align: -0.451em;"></span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi>m</mi>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mrow>
                                                <mi>l</mi>
                                                <mi>i</mi>
                                                <mi>n</mi>
                                                <mi>k</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                    <mo>長</mo>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                    <mo>度</mo>
                                                </mrow>
                                            </mrow>
                                            <mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                    <mo>最</mo>
                                                </mrow>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                    <mo>大</mo>
                                                </mrow>
                                                <mi>b</mi>
                                                <mi>i</mi>
                                                <mi>t</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                    <mo>數</mo>
                                                </mrow>
                                            </mrow>
                                        </mfrac>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mi>d</mi>
                                            <mrow>
                                                <mi>R</mi>
                                                <mo>×</mo>
                                                <msub>
                                                    <mi>d</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>p</mi>
                                                        <mi>r</mi>
                                                        <mi>o</mi>
                                                        <mi>p</mi>
                                                    </mrow>
                                                </msub>
                                            </mrow>
                                        </mfrac>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mi>d</mi>
                                            <mrow>
                                                <mi>R</mi>
                                                <mo>×</mo>
                                                <mfrac>
                                                    <mi>d</mi>
                                                    <mi>S</mi>
                                                </mfrac>
                                            </mrow>
                                        </mfrac>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mi>S</mi>
                                            <mi>R</mi>
                                        </mfrac>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-13">m = \frac {link長度}{最大bit數} = \frac{d}{R\times d_{prop}} = \frac{d}{R\times\frac{d}{S}} = \frac {S}{R}</script>
                        </span>
                        (m/bit) (並不會平均分散)
                    </li>
                    <li>
                        如果一個訊息分成 n 個封包(收到 ACK 才會傳下一分割)：
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub><mo>+</mo><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-230" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-231" class="mjx-mrow"><span id="MJXc-Node-232" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-233" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-234" class="mjx-texatom" style=""><span id="MJXc-Node-235" class="mjx-mrow"><span id="MJXc-Node-236" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-237" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-238" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-239" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-240" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">l</span></span></span></span></span></span><span id="MJXc-Node-241" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-242" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-243" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-244" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span><span id="MJXc-Node-245" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-246" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-247" class="mjx-texatom" style=""><span id="MJXc-Node-248" class="mjx-mrow"><span id="MJXc-Node-249" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-250" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-251" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-252" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span></span></span><span id="MJXc-Node-253" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-254" class="mjx-msubsup MJXc-space2"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-255" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-256" class="mjx-texatom" style=""><span id="MJXc-Node-257" class="mjx-mrow"><span id="MJXc-Node-258" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-259" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-260" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-261" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-262" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span></span></span><span id="MJXc-Node-263" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>t</mi>
                                                <mi>o</mi>
                                                <mi>t</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                        <mo>=</mo>
                                        <mi>n</mi>
                                        <mo stretchy="false">(</mo>
                                        <mn>2</mn>
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>p</mi>
                                                <mi>r</mi>
                                                <mi>o</mi>
                                                <mi>p</mi>
                                            </mrow>
                                        </msub>
                                        <mo>+</mo>
                                        <msub>
                                            <mi>d</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>t</mi>
                                                <mi>r</mi>
                                                <mi>a</mi>
                                                <mi>n</mi>
                                                <mi>s</mi>
                                            </mrow>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-14">d_{total} = n(2d_{prop}+d_{trans})</script>
                        </span>
                    </li>
                    <li>
                        Throughput：(bits / sec)，送收端之間的位元吞吐率，有瞬時與平均速率
                        <ul>
                            <li><img src="https://imgur.com/download/Xl72MKl" alt=""></li>
                            <li>R<sub>s</sub> &lt; R<sub>c</sub> <img src="https://i.imgur.com/fFwyQsT.png" alt=""></li>
                            <li>R<sub>s</sub> &gt; R<sub>c</sub> <img src="https://i.imgur.com/nAPiPFf.png" alt=""></li>
                            <li>end-end throughput = min(R<sub>c</sub>, R<sub>s</sub>, R/10) <img src="https://i.imgur.com/d5hD1At.png" alt=""></li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Layer--Protocal"><a class="anchor hidden-xs" href="#Layer--Protocal" title="Layer--Protocal"><span class="octicon octicon-link"></span></a>Layer + Protocal</h3>
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Layer</th>
                            <th>ISO OSI</th>
                            <th>Protocal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>4</td>
                            <td>Application</td>
                            <td>7 Application<br>6 Presentation<br>5 Session</td>
                            <td>HTTP, FTP, SMTP…</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Transport</td>
                            <td>4 Transport</td>
                            <td>TCP, UDP → 程序間的溝通</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Network</td>
                            <td>3 Network</td>
                            <td>Internet protocal → IP → <strong>Router</strong> → host 間的溝通</td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Link</td>
                            <td>2 Data Link<br>1 Physical</td>
                            <td>Ethernet protocal → MAC address → <strong>Switch</strong></td>
                        </tr>
                    </tbody>
                </table>
                <p><img src="https://i.imgur.com/dyTefld.png" alt=""></p>
                <h2 id="Application-Layer"><a class="anchor hidden-xs" href="#Application-Layer" title="Application-Layer"><span class="octicon octicon-link"></span></a>Application Layer</h2>
                <ul>
                    <li>
                        為何需要 port #
                        <ul>
                            <li>因為 client 上會有很多 APP</li>
                            <li>利用 port 來對應要送去給哪個 APP</li>
                        </ul>
                    </li>
                </ul>
                <h3 id="HTTP--HyperText-Transer-Protocal-"><a class="anchor hidden-xs" href="#HTTP--HyperText-Transer-Protocal-" title="HTTP--HyperText-Transer-Protocal-"><span class="octicon octicon-link"></span></a>HTTP ( HyperText Transer Protocal )</h3>
                <h4 id="use-TCP"><a class="anchor hidden-xs" href="#use-TCP" title="use-TCP"><span class="octicon octicon-link"></span></a>use TCP</h4>
                <ul>
                    <li>client 初始化 TCP 和 server 的連線(建立socket)在 port 80</li>
                    <li>server 接受 client 的 TCP 連線</li>
                    <li>HTTP 訊息 (application-layer protocol messages) 在client 和 server 間交換</li>
                    <li>TCP 連線關閉</li>
                    <li>[註]：client → web browser… , server → web server…</li>
                </ul>
                <h4 id="Stateless-"><a class="anchor hidden-xs" href="#Stateless-" title="Stateless-"><span class="octicon octicon-link"></span></a>Stateless :</h4>
                <ul>
                    <li>不會記住同一台腦上次所發出的request，每次都是重新的開始</li>
                    <li>紀錄狀態很難，且server重開會將狀態丟失</li>
                </ul>
                <h4 id="HTTP-Connections-"><a class="anchor hidden-xs" href="#HTTP-Connections-" title="HTTP-Connections-"><span class="octicon octicon-link"></span></a>HTTP Connections :</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Non-Persistent HTTP</th>
                            <th>Persistent HTTP</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1. client 發送建連線<br>2. server 收到並同意連線<br>3. client 發送 request<br>4. server 收到，然後發送response<br>　並關掉連線<br>5. client 處理發現回傳的物件<br>6. 再去建連線抓物件(重複1.~5.)</td>
                            <td>● 連線會在server發送<strong>回應</strong>後持續著<br>● client 就可以一直發送<strong>要求</strong>載物件<br><img src="https://i.imgur.com/TV4FJ98.png" alt=""></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>較耗時，因為每個物件都要算1次<br>response time = <br>2RTT + file transmission time<br></td>
                            <td>較省時<br>較少RTT</td>
                        </tr>
                    </tbody>
                </table>
                <ul>
                    <li>RTT ( Run Trip Time ) : packet 從 client 到 server 再到 client 去回所花時間</li>
                </ul>
                <h4 id="Request-Message"><a class="anchor hidden-xs" href="#Request-Message" title="Request-Message"><span class="octicon octicon-link"></span></a>Request Message</h4>
                <p><img src="https://i.imgur.com/tAPGVeV.png" alt=""></p>
                <ul>
                    <li>General Format<br>
                        <img src="https://i.imgur.com/gb2cOAD.png" alt="" width="440" height="250">
                    </li>
                    <li>
                        Uploading form input (2種做法)
                        <ul>
                            <li>
                                POST :
                                <ul>
                                    <li>網頁自身包括 form input</li>
                                    <li>input 被上傳至 server 的 entity body</li>
                                </ul>
                            </li>
                            <li>URL (用 GET) :<br>
                                input 被上傳在 URL 的 request line 如下<br>
                                <code>www.somesite.com/animalsearch?monkeys&amp;banana</code>
                            </li>
                        </ul>
                    </li>
                    <li>HTTP/0.9：GET，response request 之後立即關閉連接</li>
                    <li>
                        HTTP/1.0：GET, POST
                        <ul>
                            <li>HEAD：要求服務器將 request 的物件置於 out of response</li>
                            <li>增加 response 狀態碼, 標記可能的錯誤原因</li>
                            <li>引入協議版本號、HEADER, 讓HTTP處理請求和響應更靈活</li>
                            <li>傳輸的數據不再僅限於文本</li>
                            <li>但並不是一個"標準",只是記錄已由實踐和模式的一份參考文檔,相當於一個"備忘錄".</li>
                        </ul>
                    </li>
                    <li>
                        HTTP/1.1：GET, POST, HEAD
                        <ul>
                            <li>PUT：將實體主體中的文件上傳到URL字段中指定的路徑</li>
                            <li>DELETE：刪除URL字段中指定的文件</li>
                            <li>增加了緩存管理和控制、明確了連接管理,允許持久連接</li>
                            <li>允許 response 分塊(chunked), 利於傳輸大文件</li>
                            <li>強制 Host header, 讓互聯網主機託管成為可能</li>
                        </ul>
                    </li>
                    <li>
                        HTTP/2
                        <ul>
                            <li>二進制協議, 不再是純文本</li>
                            <li>可發起多個請求, 廢棄1.1中的管道</li>
                            <li>使用專用算法壓縮頭部, 減少數據傳輸量</li>
                            <li>增強安全性,事實上要求加密通信</li>
                            <li>目前HTTP/2的普及率還比較低,主要是因為HTTP/1.1太經典和強勢</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Response-Message"><a class="anchor hidden-xs" href="#Response-Message" title="Response-Message"><span class="octicon octicon-link"></span></a>Response Message</h4>
                <p><img src="https://i.imgur.com/0ImcsHr.png" alt="" width="550" height="300"></p>
                <ul>
                    <li>
                        status code :
                        <ul>
                            <li>200 OK</li>
                            <li>301 Moved Permanently</li>
                            <li>400 Bad Request</li>
                            <li>404 Not Found</li>
                            <li>505 HTTP Version Not Support</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="User-server-State--cookie"><a class="anchor hidden-xs" href="#User-server-State--cookie" title="User-server-State--cookie"><span class="octicon octicon-link"></span></a>User-server State : <strong>cookie</strong></h4>
                <ul>
                    <li>每個人分一個unique ID，在資料庫紀錄這個ID所有的狀態<br>
                        (利用 cookie file 和傳遞的 cookie 來達成叫出狀態、使用、更新)<br>
                        <img src="https://i.imgur.com/RZn9BPG.png" alt="">
                    </li>
                    <li>
                        4 要素 :
                        <ol>
                            <li>cookie header line of HTTP response message</li>
                            <li>cookie header line in next HTTP request message</li>
                            <li>使用者端的 cookie file (由使用者的 browser 來管理)</li>
                            <li>背後連結的資料庫</li>
                        </ol>
                    </li>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-15-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>x</mi><mo>.</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-264" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-265" class="mjx-mrow"><span id="MJXc-Node-266" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-267" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-268" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.335em;">.</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi>E</mi>
                                        <mi>x</mi>
                                        <mo>.</mo>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-15">Ex.</script>
                        </span>
                        針對性行銷、可反查 source IP、購物車、授權
                    </li>
                </ul>
                <h4 id="Web-Caches-proxy-server-代理伺服器-"><a class="anchor hidden-xs" href="#Web-Caches-proxy-server-代理伺服器-" title="Web-Caches-proxy-server-代理伺服器-"><span class="octicon octicon-link"></span></a>Web Caches (proxy server 代理伺服器) :</h4>
                <ul>
                    <li>在不要連到原伺服器的情況下滿足 client 的 request</li>
                    <li>proxy 通常是網路提供者所架設<br>
                        <img src="https://i.imgur.com/P2mSqJZ.png" alt="" width="300" height="200">
                    </li>
                </ul>
                <ol>
                    <li>第一次要求時，先到代理再到原伺服器走正常流程</li>
                    <li>第二次如果有別人要求相同時(且代理的資訊還很新的時候)會直接從代理伺服器拿到資料就回去了</li>
                </ol>
                <ul>
                    <li>
                        優點：
                        <ul>
                            <li>減少 response time</li>
                            <li>減少 link 上的塞車 (省頻寬 → 省錢)</li>
                            <li>使 content provider (Ex. youtube, BBC) 能更有效率傳遞物件/資料</li>
                        </ul>
                    </li>
                    <li>
                        Example 1 (no local web cache) :
                        <ul>
                            <li>
                                assumptions:
                                <ul>
                                    <li>avg object size : 100K bits</li>
                                    <li>avg request rate from browsers to origin servers : 15/sec</li>
                                    <li>avg data rate to browsers : 1.5 Mbps (= 100K * 15 / sec)</li>
                                    <li>RTT from institutional router to any origin server : 2 sec</li>
                                    <li>access link rate (出LAN去外面的傳遞速率) : 1.54 Mbps</li>
                                    <li>1 Gbps LAN</li>
                                </ul>
                            </li>
                            <li>
                                consequences:
                                <ul>
                                    <li><strong>LAN utilization</strong> = 1.5Mbps / 1 Gbps = 0.15%</li>
                                    <li><strong>access link utilization</strong> = 1.5Mbps / 1.54Mbps = 99% <strong>→ 問題所在</strong></li>
                                    <li><strong>total delay</strong> = Internet delay + access delay + LAN delay = 2 sec + mins + usecs <strong>→ 太久</strong></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Example 2 (local web cache) :
                        <ul>
                            <li>
                                assumptions:
                                <ul>
                                    <li>
                                        suppose cache hit rate is 0.4
                                        <ul>
                                            <li>40% requests satisfied at cache</li>
                                            <li>60% requests satisfied at origin</li>
                                        </ul>
                                    </li>
                                    <li>其餘條件與上面相同</li>
                                </ul>
                            </li>
                            <li>
                                consequences:
                                <ul>
                                    <li>
                                        <strong>data rate to browsers</strong> = 0.6 * 1.5 Mbps = 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-16-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.9</mn><mi>M</mi><mi>b</mi><mi>p</mi><mi>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-269" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-270" class="mjx-mrow"><span id="MJXc-Node-271" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.9</span></span><span id="MJXc-Node-272" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.081em;">M</span></span><span id="MJXc-Node-273" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-274" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-275" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mn>0.9</mn>
                                                        <mi>M</mi>
                                                        <mi>b</mi>
                                                        <mi>p</mi>
                                                        <mi>s</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-16">0.9 Mbps</script>
                                        </span>
                                    </li>
                                    <li><strong>LAN utilization</strong> = 1.5Mbps / 1 Gbps = 0.15%</li>
                                    <li>
                                        <strong>access link utilization</strong> = 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0.9</mn><mi>M</mi><mi>b</mi><mi>p</mi><mi>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-276" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-277" class="mjx-mrow"><span id="MJXc-Node-278" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.9</span></span><span id="MJXc-Node-279" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.081em;">M</span></span><span id="MJXc-Node-280" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-281" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-282" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mn>0.9</mn>
                                                        <mi>M</mi>
                                                        <mi>b</mi>
                                                        <mi>p</mi>
                                                        <mi>s</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-17">0.9Mbps</script>
                                        </span>
                                        / 1.54Mbps = 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>54</mn><mi mathvariant=&quot;normal&quot;>&amp;#x0025;</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-283" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-284" class="mjx-mrow"><span id="MJXc-Node-285" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">54</span></span><span id="MJXc-Node-286" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.39em;">%</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mn>54</mn>
                                                        <mi mathvariant="normal">%</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-18">54\%</script>
                                        </span>
                                    </li>
                                    <li>
                                        <strong>total delay</strong> = 0.6 * (delay from origin servers) + 0.4 * (delay when satisfied at cache) = 0.6 * 2.01 + 0.4 (~msecs) = ~ 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1.2</mn><mi>s</mi><mi>e</mi><mi>c</mi><mi>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-287" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-288" class="mjx-mrow"><span id="MJXc-Node-289" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">1.2</span></span><span id="MJXc-Node-290" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-291" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-292" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-293" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mn>1.2</mn>
                                                        <mi>s</mi>
                                                        <mi>e</mi>
                                                        <mi>c</mi>
                                                        <mi>s</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-19">1.2 secs</script>
                                        </span>
                                    </li>
                                </ul>
                            </li>
                            <li>local host 維護成本較低，比增加 access link rate 還省錢，卻不失效果</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Conditional-GET"><a class="anchor hidden-xs" href="#Conditional-GET" title="Conditional-GET"><span class="octicon octicon-link"></span></a>Conditional GET</h4>
                <ul>
                    <li>功能：如果 cache 是最新版就不要寄物件</li>
                    <li>cache : 記錄此cache的出生時間<code>If-modified-since: &lt;date&gt;</code></li>
                    <li>server : 如果此時間符合物件最後改變的時間就回傳 <code>HTTP/1.0 304 Not Modified</code><br>
                        <img src="https://i.imgur.com/1zlW6be.png" alt="">
                    </li>
                    <li>優點：減少延遲、頻寬占比</li>
                </ul>
                <h3 id="Electronic-Email"><a class="anchor hidden-xs" href="#Electronic-Email" title="Electronic-Email"><span class="octicon octicon-link"></span></a>Electronic Email</h3>
                <h4 id="3-major-components"><a class="anchor hidden-xs" href="#3-major-components" title="3-major-components"><span class="octicon octicon-link"></span></a>3 major components:</h4>
                <ul>
                    <li>
                        User Agents
                        <ul>
                            <li>mail reader 可撰寫、編輯、閱讀信件</li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>x</mi><mo>.</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-294" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-295" class="mjx-mrow"><span id="MJXc-Node-296" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-297" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-298" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.335em;">.</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>E</mi>
                                                <mi>x</mi>
                                                <mo>.</mo>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-20">Ex.</script>
                                </span>
                                Outlook, Thunderbird, iPhone mail client
                            </li>
                        </ul>
                    </li>
                    <li>
                        Mail Servers
                        <ul>
                            <li>Mailbox : 存放幫使用者收到的信</li>
                            <li>Message Queue : 要寄出的信的佇列</li>
                            <li><strong>信都存在 server 裡</strong></li>
                            <li>client : sending mail server</li>
                            <li>server : receiving mail server</li>
                        </ul>
                    </li>
                    <li>
                        Simple Mail Transfer Protocol (SMTP)
                        <ul>
                            <li>使用 TCP 通常在 port 25</li>
                            <li>只能發送和接收屬於7-bits ascii的資料<br>
                                → 要發其他檔案就先轉ascii傳出去，收的時候再轉回來
                            </li>
                            <li>mail server的命名大多如左 → <a href="http://smtp.nctu.edu.tw:25" target="_blank" rel="noopener">smtp.nctu.edu.tw:25</a></li>
                            <li>
                                比較：
                                <table>
                                    <thead>
                                        <tr>
                                            <th>HTTP</th>
                                            <th>SMTP</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>pull</td>
                                            <td>push</td>
                                        </tr>
                                        <tr>
                                            <td>ascii</td>
                                            <td>ascii</td>
                                        </tr>
                                        <tr>
                                            <td>一個物件、一個訊息</td>
                                            <td>多個物件在multipart messages裡</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h4 id="過程："><a class="anchor hidden-xs" href="#過程：" title="過程："><span class="octicon octicon-link"></span></a>過程：</h4>
                <p><strong>1.</strong> 用 user agent 寄信 by SMTP<br>
                    <strong>2.</strong> 送到自己的 mail server 或是把自己當作伺服器<br>
                    <strong>3.</strong> server SMTP 開啟 TCP 連線 with 對方的 mail server<br>
                    <strong>4.</strong> 用 TCP 送到對方的 mail server<br>
                    <strong>5.</strong> 對方 server 先幫忙收信 (分到該去的 mail box)，如果serevr剛好沒上線，就會一直幫忙重送<br>
                    <strong>6.</strong> 等對方user上線後，他再用 POP3 / IMAP / HTTP  去她的 mail server 從他的 mail box 收信<br>
                    <img src="https://i.imgur.com/I9S3pfy.png" alt="">
                </p>
                <h4 id="實作-不需要outlook…等等，打指令即可完成"><a class="anchor hidden-xs" href="#實作-不需要outlook…等等，打指令即可完成" title="實作-不需要outlook…等等，打指令即可完成"><span class="octicon octicon-link"></span></a>實作 (不需要outlook…等等，打指令即可完成)</h4>
                <ul>
                    <li>telnet servername 25</li>
                    <li>see 220 reply from server</li>
                    <li>enter HELO, MAIL FROM, RCPT TO, DATA, QUIT commands</li>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>x</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mo>:</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-299" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-300" class="mjx-mrow"><span id="MJXc-Node-301" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-302" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-303" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">m</span></span><span id="MJXc-Node-305" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-306" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">l</span></span><span id="MJXc-Node-307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-308" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">:</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi>E</mi>
                                        <mi>x</mi>
                                        <mi>a</mi>
                                        <mi>m</mi>
                                        <mi>p</mi>
                                        <mi>l</mi>
                                        <mi>e</mi>
                                        <mo>:</mo>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-21">Example :</script>
                        </span>
                        <br>
                        <img src="https://i.imgur.com/OmeJgN3.png" alt="" width="400" height="250">
                    </li>
                    <li>在 message body 裡，to 和 from 是可以隨便寫的，不用符合真正的來源和目的，header 上的才是真的</li>
                </ul>
                <h4 id="接收會用到的3種protocal"><a class="anchor hidden-xs" href="#接收會用到的3種protocal" title="接收會用到的3種protocal"><span class="octicon octicon-link"></span></a>接收會用到的3種protocal</h4>
                <ul>
                    <li>
                        POP3 ( Post Office Protocol ver.3) [RFC 1939] 最普遍<br>
                        <img src="https://i.imgur.com/D2Dfbi4.png" alt="" width="450" height="300">
                        <ul>
                            <li>上述例子運用“download and delete” mode → 如果換client後無法重看</li>
                            <li>“download-and-keep” mode : 會把信件複製到不同的client</li>
                            <li>stateless across sessions</li>
                        </ul>
                    </li>
                    <li>
                        IMAP ( Internet Mail Access Protocol ) [RFC 1730] 現在很少再用
                        <ul>
                            <li>全部的訊息都存在 server</li>
                            <li>允許使用者管理資料夾的信件</li>
                            <li>利用資料夾名、使用者ID的對應來存使用者狀態</li>
                        </ul>
                    </li>
                    <li>HTTP：網路上的郵箱 Ex. Google、YaHoo!..</li>
                </ul>
                <h3 id="DNS-Domain-Name-System"><a class="anchor hidden-xs" href="#DNS-Domain-Name-System" title="DNS-Domain-Name-System"><span class="octicon octicon-link"></span></a>DNS (Domain Name System)</h3>
                <h4 id="功能"><a class="anchor hidden-xs" href="#功能" title="功能"><span class="octicon octicon-link"></span></a>功能</h4>
                <ul>
                    <li>name &amp; IP address 相互的轉換</li>
                    <li>host aliasing 取綽號：host本身的名字但可能是同一個 domain 的機器，所以幫他取一個別名為 domain</li>
                    <li>load Distribution : 例如google每次轉到的IP可能不一樣(有超過一台的server, 一台電腦可有多張網卡多個IP)，由DNS幫他做這件事情 <strong>(如果收到別名，會去找別名的紀錄，再拿查到的真實名字，去找他真正的IP)</strong></li>
                </ul>
                <h4 id="Hierarchy-階層性"><a class="anchor hidden-xs" href="#Hierarchy-階層性" title="Hierarchy-階層性"><span class="octicon octicon-link"></span></a>Hierarchy 階層性</h4>
                <p><img src="https://i.imgur.com/WM76kqC.png" alt="" width="550" height="180"></p>
                <ul>
                    <li>階層從後到前 <a href="http://www.cs.nctu.edu.tw" target="_blank" rel="noopener">www.cs.nctu.edu.tw</a> → local → root → tw → edu → nctu → cs</li>
                    <li>而 root DNS 分布在世界各地共13個，由無法解決的 local DNS 來聯絡</li>
                    <li>從最近的 local DNS 開始問，他如果不知道就問 root</li>
                    <li>root 再按照階層來指示他要去哪裡找</li>
                    <li>www 只是個機器名字，上面跑網頁伺服器，也可以是 ftp、隨便取…等等</li>
                </ul>
                <h4 id="Name-Severs"><a class="anchor hidden-xs" href="#Name-Severs" title="Name-Severs"><span class="octicon octicon-link"></span></a>Name Severs</h4>
                <ul>
                    <li>
                        top-level domain (TLD) servers<br>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>x</mi><mo>.</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-309" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-310" class="mjx-mrow"><span id="MJXc-Node-311" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-312" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-313" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.335em;">.</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi>E</mi>
                                        <mi>x</mi>
                                        <mo>.</mo>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-22">Ex.</script>
                        </span>
                        com, org, net, edu, aero, jobs, museums, country domains : uk, fr, ca, jp
                    </li>
                    <li>
                        authoritative DNS servers (授權 DNS) → 普通的 DNS
                        <ul>
                            <li>某組織自己的 DNS，用於對內部 IP 與 domain 的翻譯</li>
                            <li>通常會由組織自己 or 服務提供者所設定</li>
                            <li>Ex. 系計中也有自己的 DNS</li>
                        </ul>
                    </li>
                    <li>
                        Local DNS name server
                        <ul>
                            <li>平常電腦 sent query 先去的DNS，通常會往近一點問</li>
                            <li>不直接屬於 hierarchy、有存 cache</li>
                            <li>
                                ISP 都有一個
                                <ul>
                                    <li>
                                        Internet Service Provider 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>x</mi><mo>.</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-314" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-315" class="mjx-mrow"><span id="MJXc-Node-316" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-317" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-318" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.335em;">.</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi>E</mi>
                                                        <mi>x</mi>
                                                        <mo>.</mo>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-23">Ex.</script>
                                        </span>
                                        住宅 ISP, 公司, 大學…等等
                                    </li>
                                    <li>又稱為 “default name server”</li>
                                </ul>
                            </li>
                            <li>作用像是詢問 hierarchy 的 proxy</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="過程"><a class="anchor hidden-xs" href="#過程" title="過程"><span class="octicon octicon-link"></span></a>過程</h4>
                <ul>
                    <li>2 種 query 的運作：<br>
                        <img src="https://i.imgur.com/NTvMfpE.png" alt="" width="540" height="320">
                    </li>
                    <li>可以用cache記住，減少重複問的時間，只是cache還是要有time out以保持資訊更新</li>
                    <li>TLD通常也會cache著，因為個數不多，變動性低</li>
                </ul>
                <h4 id="DNS-Records-amp-msg"><a class="anchor hidden-xs" href="#DNS-Records-amp-msg" title="DNS-Records-amp-msg"><span class="octicon octicon-link"></span></a>DNS Records &amp; msg</h4>
                <ul>
                    <li>RR (resourse records) 包括 <code>(name, value, type, ttl)</code></li>
                    <li>type=A (最下層)→ <code>name = hostname, value = IP</code></li>
                    <li>type=NS (對於DNS的)→ <code>name = domain, value = 此 domain 之權威 DNS 的 hostname</code></li>
                    <li>type=CNAME (對於別名的)→ <code>name = alias name, value = canonical (real) name</code></li>
                    <li>type=MX (對於 mail server 的)→ <code>value = name of mailserver associated with name</code></li>
                    <li>Message format<br>
                        <img src="https://i.imgur.com/VQEvmH3.png" alt="" width="430" height="250">
                    </li>
                    <li>Identification : 16 bit # for query, reply to query uses same #</li>
                    <li>Flags :　● query or reply 　 　 　 　● recursion desired<br>
                        　 　 　 ● recursion available　　　● reply is authoritative
                    </li>
                </ul>
                <h4 id="建立新的-DNS-伺服器"><a class="anchor hidden-xs" href="#建立新的-DNS-伺服器" title="建立新的-DNS-伺服器"><span class="octicon octicon-link"></span></a>建立新的 DNS 伺服器</h4>
                <ul>
                    <li>
                        在 DNS registrar 
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>x</mi><mo>.</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-319" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-320" class="mjx-mrow"><span id="MJXc-Node-321" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-322" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-323" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.335em;">.</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi>E</mi>
                                        <mi>x</mi>
                                        <mo>.</mo>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-24">Ex.</script>
                        </span>
                        Network Solutions 註冊名字
                        <ul>
                            <li>
                                須提供 names, IP addresses of 授權 DNS
                                <ul>
                                    <li>primary and secondary 通常都會用兩台，怕意外掛掉等等</li>
                                </ul>
                            </li>
                            <li>
                                需放2個 RRs 在 <strong>.com TLD</strong> 裡
                                <ul>
                                    <li><code>(networkutopia.com, dns1.networkutopia.com, NS)</code></li>
                                    <li><code>(dns1.networkutopia.com, 212.212.212.1, A)</code></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>create authoritative server type A record for <a href="http://www.networkuptopia.com" target="_blank" rel="noopener">www.networkuptopia.com</a></li>
                    <li>type MX record for <a href="http://networkutopia.com" target="_blank" rel="noopener">networkutopia.com</a></li>
                    <li>
                        <strong>通常開公司必備3伺服器：Web, DNS, Mail servers</strong>
                        <ul>
                            <li>domain name 很重要，此三伺服器，現今大多想得出來的都被註冊過了</li>
                            <li>Web：為公司向外的門面</li>
                            <li>DNS：管理公司內部的IP們</li>
                            <li>Mail Server：對外部聯絡時所用的正式公司專門郵件帳號們</li>
                            <li>也可以把三種機器跑在同一台，用alias取三個名字即可</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Attack-DNS"><a class="anchor hidden-xs" href="#Attack-DNS" title="Attack-DNS"><span class="octicon octicon-link"></span></a>Attack DNS</h4>
                <ul>
                    <li>
                        DDoS attacks
                        <ul>
                            <li>
                                bombard root servers with traffic
                                <ul>
                                    <li>not successful to date</li>
                                    <li>traffic filtering</li>
                                    <li>local DNS servers cache IPs of TLD servers, allowing root server bypass</li>
                                </ul>
                            </li>
                            <li>
                                bombard TLD servers
                                <ul>
                                    <li>potentially more dangerous</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        redirect attacks
                        <ul>
                            <li>man-in-middle：Intercept queries</li>
                        </ul>
                    </li>
                    <li>
                        DNS poisoning
                        <ul>
                            <li>Send bogus relies to DNS server, which caches</li>
                        </ul>
                    </li>
                    <li>
                        exploit DNS for DDoS
                        <ul>
                            <li>send queries with spoofed source address: target IP</li>
                            <li>requires amplification</li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Video-Streaming-and-Content-Distribution-Networks"><a class="anchor hidden-xs" href="#Video-Streaming-and-Content-Distribution-Networks" title="Video-Streaming-and-Content-Distribution-Networks"><span class="octicon octicon-link"></span></a>Video Streaming and Content Distribution Networks</h3>
                <h4 id="Multimedia--video"><a class="anchor hidden-xs" href="#Multimedia--video" title="Multimedia--video"><span class="octicon octicon-link"></span></a>Multimedia : video</h4>
                <ul>
                    <li>
                        coding: use redundancy withinand betweenimages to decrease # bits used to encode image
                        <ul>
                            <li>spatial (within image)：記得顏色的值、他出現過的地方</li>
                            <li>temporal (from one image to next)：記得跟上一張比，不一樣的地方</li>
                        </ul>
                    </li>
                    <li>CBR (constant bit rate)：固定速度</li>
                    <li>
                        VBR (variable bit rate)：
                        <ul>
                            <li>能壓就盡量壓，塞車時壓少、否則壓多</li>
                            <li>但 bandwith 比較難處哩，忽大忽小</li>
                        </ul>
                    </li>
                    <li>
                        Streaming stored video
                        <ul>
                            <li>MOD (Media On Demand) : 要看再看就好，不像平常有線電視播完就看不到了</li>
                            <li>Youtube : 收到資料收集到可以撐一下 (pre-bubble) 才會開始播放，然後邊播邊收 → 用TCP也行，有時間把塞車延後的洞補起來 (但比較適合非直播，delay的話不是那麼嚴重 - buffer starvation)</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Streaming-multimedia--DASH-Dynamic-Adaptive-Streaming-over-HTTP"><a class="anchor hidden-xs" href="#Streaming-multimedia--DASH-Dynamic-Adaptive-Streaming-over-HTTP" title="Streaming-multimedia--DASH-Dynamic-Adaptive-Streaming-over-HTTP"><span class="octicon octicon-link"></span></a>Streaming multimedia : DASH (Dynamic, Adaptive Streaming over HTTP)</h4>
                <ul>
                    <li>
                        Server :
                        <ul>
                            <li>把檔案分成多個chunks(對應播放時間，例如十秒)</li>
                            <li>然後用不同的方法儲存、encode於不同的rate</li>
                        </ul>
                    </li>
                    <li>
                        Client :
                        <ul>
                            <li>一直偵測可用頻寬的大小</li>
                            <li>如果網路頻寬變多了，就要求較高的畫質，否則相反</li>
                            <li>如果快要buffer starvation時就趕快降低畫質…等</li>
                        </ul>
                    </li>
                    <li>
                        不需要交換器路由器的幫忙來完成這些事情 → End Host 的智慧
                        <ul>
                            <li>儲存地點分布各地 → 找一個較近的 or 交通順暢的路線</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Content-Distribution-Networks-CDNs"><a class="anchor hidden-xs" href="#Content-Distribution-Networks-CDNs" title="Content-Distribution-Networks-CDNs"><span class="octicon octicon-link"></span></a>Content Distribution Networks (CDNs)</h4>
                <ul>
                    <li>可以加強使用者體驗 (需額外花錢)</li>
                </ul>
                <ol>
                    <li>
                        建立 mega-server
                        <ul>
                            <li>把東西都存在這裡，要拿都來這裡拿</li>
                            <li>連接他的網路線會特別擠</li>
                            <li>如果他壞了就都不能用了(沒有意外的替代) singal point…</li>
                        </ul>
                    </li>
                    <li>
                        建立 CDN
                        <ul>
                            <li>在地理上相距有距離的地方都設一個server</li>
                            <li>裡面存一些內容的copy</li>
                            <li>然後叫client去離他比較近 or 路上交通不壅擠的倉庫裡拿檔案</li>
                            <li>有可根據地域的文化來決定要儲存什麼風格的內容</li>
                            <li>有名公司：Limelight</li>
                        </ul>
                    </li>
                </ol>
                <ul>
                    <li>
                        OTT (Over The Top) challenges
                        <ul>
                            <li>from which CDN node to retrieve content?</li>
                            <li>viewer behavior in presence of congestion?</li>
                            <li>what content to place in which CDN node?</li>
                        </ul>
                    </li>
                    <li>過程：<img src="https://i.imgur.com/FuErQzE.png" alt=""></li>
                    <li>舉例：Netflix<br>
                        <img src="https://imgur.com/download/ji0qAaY" alt="">
                    </li>
                </ul>
                <h3 id="Socket-Programming"><a class="anchor hidden-xs" href="#Socket-Programming" title="Socket-Programming"><span class="octicon octicon-link"></span></a>Socket Programming</h3>
                <ul>
                    <li>為 application 和 end to end transport protocal 的溝通介面</li>
                    <li>
                        主要兩種
                        <ul>
                            <li>
                                UDP :
                                <ul>
                                    <li>沒有連線概念、送東西前不需要先建連線</li>
                                    <li><strong>datagram</strong> : 是一塊一塊傳送的</li>
                                    <li><img src="https://i.imgur.com/Tq9zm5s.png" alt=""></li>
                                </ul>
                            </li>
                            <li>
                                TCP :
                                <ul>
                                    <li>每個連線建起來就會創造一個新的socket(用完舊的不會關掉)</li>
                                    <li>所以一個伺服器可以一次對多個client</li>
                                    <li>如果封包沒送好會幫忙重送</li>
                                    <li><strong>in-order byte stream</strong> (pipe) : 如果一塊一塊接收到，還是會把它看成一串byte(他看不出來是一塊一塊的)</li>
                                    <li>只判斷封包是否沒有少byte，順序對不對，有問題就會重送</li>
                                    <li><img src="https://i.imgur.com/QVlhSAI.png" alt=""></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="important-themes"><a class="anchor hidden-xs" href="#important-themes" title="important-themes"><span class="octicon octicon-link"></span></a>important themes:</h3>
                <ul>
                    <li>
                        control vs. messages
                        <ul>
                            <li>in-band : 乖乖排隊</li>
                            <li>out-of-band : 加速處理(插隊) → 如果msg跟控制相關(就有時效性)</li>
                        </ul>
                    </li>
                    <li>centralized vs. decentralized<br>
                        <br>
                    </li>
                    <li>stateless vs. stateful<br>
                        <br>
                    </li>
                    <li>reliable vs. unreliable message transfer<br>
                        <br>
                    </li>
                    <li>
                        “complexity at network edge”
                        <ul>
                            <li>把複雜的處理搬到 end host 上做</li>
                            <li>讓 network core 越簡單越好 (所以如今就可以把路由器等越做越快)</li>
                        </ul>
                    </li>
                </ul>
                <h2 id="Transport-Layer"><a class="anchor hidden-xs" href="#Transport-Layer" title="Transport-Layer"><span class="octicon octicon-link"></span></a>Transport Layer</h2>
                <h3 id="Transport-Service"><a class="anchor hidden-xs" href="#Transport-Service" title="Transport-Service"><span class="octicon octicon-link"></span></a>Transport Service</h3>
                <ul>
                    <li>提供app process間邏輯上的連線(end to end transport) → 當作是有完整的把L3做好一定聯的到現實要考慮的事物</li>
                    <li>network layer : logical communication between hosts</li>
                    <li>
                        transport layer : logical communication between processes
                        <ul>
                            <li>relies on, enhances, network layer services</li>
                        </ul>
                    </li>
                    <li>不用在乎實體上的連線，與中間如何連線 → L3</li>
                </ul>
                <h3 id="TCP"><a class="anchor hidden-xs" href="#TCP" title="TCP"><span class="octicon octicon-link"></span></a>TCP</h3>
                <ul>
                    <li>可靠的傳輸</li>
                    <li>
                        如今TCP的control已經做到非常公平，不只能降，還可降到大家差不多多
                        <ul>
                            <li>沒成功就一直重送，直到收到確認收晚整成功的訊息</li>
                            <li>in-order delivery (error control)<br>
                                <br>
                            </li>
                            <li>
                                congestion control
                                <ul>
                                    <li>交通壅塞時，queue裡東西太多賽不進去所以掉封包了</li>
                                    <li>
                                        解決：
                                        <ul>
                                            <li>自私版：直接每次都多送，掉了還有替代的 (但很有效，會造成更壅塞)</li>
                                            <li>合作版：大家都降速，都送少一點，一直降到封包不掉為止，車少了交通自然較通順</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                flow control
                                <ul>
                                    <li>送東西時要考慮兩端的處理速度</li>
                                    <li>送太快的話，到收端時來不及處理就掉光光</li>
                                    <li>並非交通壅塞導致</li>
                                    <li>解決：收到要回覆是否有收到，知道收到在送下一個</li>
                                </ul>
                            </li>
                            <li>connection-oriented：要達成三大目標必須先建連線(要先hand shaking)</li>
                        </ul>
                    </li>
                </ul>
                <h3 id="UDP-User-Datagram-Protocal-RFC-768"><a class="anchor hidden-xs" href="#UDP-User-Datagram-Protocal-RFC-768" title="UDP-User-Datagram-Protocal-RFC-768"><span class="octicon octicon-link"></span></a>UDP (User Datagram Protocal) [RFC 768]</h3>
                <ul>
                    <li>
                        <p>特性、用途：</p>
                        <ul>
                            <li>不可靠的傳輸，沒有三大 control (congestion / flow / error control)</li>
                            <li>best effort IP(底下的網路就是best effort), with no garantee</li>
                            <li>connectionless 不需要先建連線 (減少delay)</li>
                            <li>DNS、SMTP、streaming multimedia</li>
                            <li>用於中間掉資料不會影響大局的事情</li>
                        </ul>
                    </li>
                    <li>
                        <p>segment header</p>
                        <ul>
                            <li><img src="https://i.imgur.com/GT795Ls.png" alt="" width="300" height="200"></li>
                            <li>單純 : 不需要記錄一些狀態來達成三大控制 → header 大小較小</li>
                            <li>no congestion control : UDP可以根據需要快速消除</li>
                        </ul>
                    </li>
                    <li>
                        <p>checksum</p>
                        <ul>
                            <li>用來判斷錯誤</li>
                            <li><img src="https://i.imgur.com/cOXftUI.png" alt=""></li>
                            <li>check 之後不一定一定是無 error 的</li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>x</mi><mo>.</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-324" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-325" class="mjx-mrow"><span id="MJXc-Node-326" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-327" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-328" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.335em;">.</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>E</mi>
                                                <mi>x</mi>
                                                <mo>.</mo>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-25">Ex.</script>
                                </span>
                                兩個同時翻轉了就偵測不到，但同時翻轉的機率蠻低的
                            </li>
                            <li>把所有msg切成16bits一組全部加起來，overflow的要往後加</li>
                            <li>最後的何在全部翻過就是checksum  <code>sum &amp; checksum = 0</code></li>
                            <li>checksum 位數越多，偵測的精準度越高</li>
                            <li>但第二層也有 checksum (CRC 32 bits) 成功率 99.99% (其實多層把關)</li>
                        </ul>
                    </li>
                    <li>
                        <p>FM vs. AM</p>
                        <ul>
                            <li>FM : 用訊號的頻率來判斷 0 or 1，較不被雜訊影響</li>
                            <li>AM : 用震幅來判斷 0 or 1，聽起來糊糊的</li>
                        </ul>
                    </li>
                    <li>
                        <p>TCP、UDP 都沒有的服務</p>
                        <ul>
                            <li>
                                delay guarantee、bandwidth guarantee
                                <ul>
                                    <li>但其實不是這層的範疇，是下層網路層的較物理的問題所致</li>
                                </ul>
                            </li>
                            <li>
                                安全性，傳輸的訊息不加密
                                <ul>
                                    <li>SSL：加密的 TCP，提供數據完整性、端點認證</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Multiplexingdemultiplexing"><a class="anchor hidden-xs" href="#Multiplexingdemultiplexing" title="Multiplexingdemultiplexing"><span class="octicon octicon-link"></span></a>Multiplexing/demultiplexing</h3>
                <ul>
                    <li>Multiplexing：處理來自 multiple sockets 的訊息，加上 transport header (為了之後 demultiplexing)</li>
                    <li>
                        Demultiplexing：利用 header info 決定要分給哪個 socket
                        <ul>
                            <li><img src="https://i.imgur.com/VrLB0UB.png" alt="" width="200" height="200"></li>
                            <li>接收時看port來決定要指派到哪個socket(socket對應bind某port)</li>
                            <li>
                                UDP接收的時候只用一個socket
                                <ul>
                                    <li>checks destination port # in segment</li>
                                    <li>directs UDP segment to socket with that port #</li>
                                    <li>IP datagrams with same dest. port #, 但有不同 source IP 或 source port # 會被導向同一個 socket at dest</li>
                                </ul>
                            </li>
                            <li>
                                TCP接收時是一對一來源，多個來源，多個socket，且同一個APP可以在同來源目的下建立多個socket
                                <ul>
                                    <li>
                                        封包內容包括4個
                                        <ul>
                                            <li>src IP, port</li>
                                            <li>dst IP, port</li>
                                        </ul>
                                    </li>
                                    <li><img src="https://i.imgur.com/JCeW3oD.png" alt=""></li>
                                    <li>EX. FTP 會建一個來傳遞 FTP 的命令，當打完指令要下載檔案時，再開一個來專門傳送檔案的 socket</li>
                                    <li>如果不同的 socket 都綁在同個 port 上</li>
                                    <li>為了區分就辨識就四個內容一起看就可以完整分辨要分去哪個 socket</li>
                                    <li>thread server : 用這個可以管理同個 port 上的多個 socket</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>dst port &amp; src port的填空</li>
                </ul>
                <h3 id="Principles-of-reliable-data-transfer"><a class="anchor hidden-xs" href="#Principles-of-reliable-data-transfer" title="Principles-of-reliable-data-transfer"><span class="octicon octicon-link"></span></a>Principles of reliable data transfer</h3>
                <ul>
                    <li>
                        所謂可靠的傳輸：資料不能掉、順序不能錯、位元不會翻
                        <ul>
                            <li>因為底層無法做到，所以上層才需要去做</li>
                            <li><img src="https://i.imgur.com/eYQnCw6.png" alt=""></li>
                            <li>r / udt (reliable / unreliable data transfer)</li>
                        </ul>
                    </li>
                    <li>
                        先假設只有單向，需要傳 control packet (
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>E</mi><mi>x</mi><mo>.</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-329" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-330" class="mjx-mrow"><span id="MJXc-Node-331" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-332" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-333" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.163em; padding-bottom: 0.335em;">.</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi>E</mi>
                                        <mi>x</mi>
                                        <mo>.</mo>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-26">Ex.</script>
                        </span>
                        ack packet)、data packet
                    </li>
                    <li>用 state machine 去決定他的狀態</li>
                    <li>
                        rdt1.0：有一個 reliable channel 的情況下
                        <ul>
                            <li>rdt_send()：等上層呼叫，就幫他傳出去</li>
                            <li>rdt_rcv()：等下層呼叫，就把 data 收進來</li>
                            <li><img src="https://i.imgur.com/gcVu4vb.png" alt="" width="450" height="100"></li>
                        </ul>
                    </li>
                    <li>
                        rdt2.0：會有 bit errors
                        <ul>
                            <li>可以把一群bits看成二維陣列，每行每列都做 parity bit，就可以直接看出哪個bits錯，收端看到自己改過來就好 (但TCP用 error detection，偵測到錯就重送)</li>
                            <li>acknowledgements (ACKs)：回復送端自己到無誤的封包</li>
                            <li>negative acknowledgements (NAKs)：告訴送端他傳的封包有誤</li>
                            <li>這兩種封包為 control packet，但如果她們也出錯，送端就看不出來她到底傳 ACK 還是 NAK</li>
                            <li>所以悲觀一點，沒有收到 ACK 就重送 (但會有收端收到多份的問題 → 見 rdt2.1)</li>
                            <li>stop and wait：等到確定收到 ACK 才會繼續傳到下一個 (效能較差)</li>
                            <li><img src="https://i.imgur.com/ycURyqq.png" alt="" width="430" height="220"></li>
                        </ul>
                    </li>
                    <li>
                        rdt2.1：封包送出時給編號
                        <ul>
                            <li>用 sequence num 來判斷有沒有收到重複的 (只有 0 和 1，這樣夠用是因為它使用 stop and wait 而且一次一封包)</li>
                            <li>0th → 0, 1st → 1, 2nd → 0 (10 overflow), 3nd → 1…etc</li>
                            <li>但編號最好永遠不要繞回來，不然判斷可能會出錯</li>
                            <li>兩倍的 state 量，因為要記得現在是 0 還是 1</li>
                            <li>如果收端收到兩個一樣數字的封包就認定他為重複的就丟掉</li>
                            <li><img src="https://i.imgur.com/ppZRhje.png" alt=""></li>
                            <li><img src="https://i.imgur.com/YderZda.png" alt=""></li>
                        </ul>
                    </li>
                    <li>
                        rdt2.2：單純化，只傳 ACK，不傳 NAK
                        <ul>
                            <li>送回去的 ACK 裡要包括目前收到成功且最新的封包的 sequence num</li>
                            <li>如果收到的號碼跟上一個 ACK 的號碼一樣就把最後傳送過的封包重送</li>
                            <li><img src="https://i.imgur.com/w1dEsWV.png" alt=""></li>
                        </ul>
                    </li>
                    <li>
                        rdt3.0：有 error 和 loss
                        <ul>
                            <li>送出去時開始計時，時間之內如果沒收到 ACK 就重送，重新計時</li>
                            <li>Timeout 的設定要很有學問，不能太短太長</li>
                            <li><img src="https://i.imgur.com/qxF57MO.png" alt=""></li>
                            <li><img src="https://i.imgur.com/IFI1gAt.png" alt=""></li>
                            <li><img src="https://i.imgur.com/qX7wtEf.png" alt=""></li>
                            <li>
                                1 Gbps link, 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>o</mi><mi>p</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-334" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-335" class="mjx-mrow"><span id="MJXc-Node-336" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.003em;"><span id="MJXc-Node-337" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-338" class="mjx-texatom" style=""><span id="MJXc-Node-339" class="mjx-mrow"><span id="MJXc-Node-340" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span><span id="MJXc-Node-341" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-342" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-343" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.445em;">p</span></span></span></span></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msub>
                                                    <mi>d</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>p</mi>
                                                        <mi>r</mi>
                                                        <mi>o</mi>
                                                        <mi>p</mi>
                                                    </mrow>
                                                </msub>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-27">d_{prop}</script>
                                </span>
                                = 15 ms, 8000 bit packet:
                                <ul>
                                    <li>
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mo>=</mo><mfrac><mi>L</mi><mi>R</mi></mfrac><mo>=</mo><mfrac><mrow><mn>8000</mn><mi>b</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow><mrow><msup><mn>10</mn><mn>9</mn></msup><mi>b</mi><mi>i</mi><mi>t</mi><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>s</mi><mi>e</mi><mi>c</mi></mrow></mfrac><mo>=</mo><mn>0.008</mn><mi>s</mi><mi>e</mi><mi>c</mi><mo>=</mo><mn>8</mn><mi>m</mi><mi>i</mi><mi>c</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>e</mi><mi>c</mi><mi>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-344" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-345" class="mjx-mrow"><span id="MJXc-Node-346" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-347" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-348" class="mjx-texatom" style=""><span id="MJXc-Node-349" class="mjx-mrow"><span id="MJXc-Node-350" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-351" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-352" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-353" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-354" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span></span></span><span id="MJXc-Node-355" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-356" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.678em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.959em; top: -1.325em;"><span id="MJXc-Node-357" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">L</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.959em; bottom: -0.638em;"><span id="MJXc-Node-358" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.678em;"></span></span><span class="mjx-vsize" style="height: 1.388em; vertical-align: -0.451em;"></span></span><span id="MJXc-Node-359" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-360" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 3.579em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 5.061em; top: -1.358em;"><span id="MJXc-Node-361" class="mjx-mrow" style=""><span id="MJXc-Node-362" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">8000</span></span><span id="MJXc-Node-363" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-364" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-365" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-366" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 5.061em; bottom: -1.066em;"><span id="MJXc-Node-367" class="mjx-mrow" style=""><span id="MJXc-Node-368" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-369" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">10</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-370" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">9</span></span></span></span><span id="MJXc-Node-371" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-372" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-373" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-374" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-375" class="mjx-texatom"><span id="MJXc-Node-376" class="mjx-mrow"><span id="MJXc-Node-377" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">/</span></span></span></span><span id="MJXc-Node-378" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-379" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-380" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 3.579em;"></span></span><span class="mjx-vsize" style="height: 1.714em; vertical-align: -0.754em;"></span></span><span id="MJXc-Node-381" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-382" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.008</span></span><span id="MJXc-Node-383" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-384" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-385" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-386" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-387" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">8</span></span><span id="MJXc-Node-388" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">m</span></span><span id="MJXc-Node-389" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-390" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-391" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-392" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-393" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-394" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-395" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-396" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <msub>
                                                            <mi>D</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                                <mi>t</mi>
                                                                <mi>r</mi>
                                                                <mi>a</mi>
                                                                <mi>n</mi>
                                                                <mi>s</mi>
                                                            </mrow>
                                                        </msub>
                                                        <mo>=</mo>
                                                        <mfrac>
                                                            <mi>L</mi>
                                                            <mi>R</mi>
                                                        </mfrac>
                                                        <mo>=</mo>
                                                        <mfrac>
                                                            <mrow>
                                                                <mn>8000</mn>
                                                                <mi>b</mi>
                                                                <mi>i</mi>
                                                                <mi>t</mi>
                                                                <mi>s</mi>
                                                            </mrow>
                                                            <mrow>
                                                                <msup>
                                                                    <mn>10</mn>
                                                                    <mn>9</mn>
                                                                </msup>
                                                                <mi>b</mi>
                                                                <mi>i</mi>
                                                                <mi>t</mi>
                                                                <mi>s</mi>
                                                                <mrow class="MJX-TeXAtom-ORD">
                                                                    <mo>/</mo>
                                                                </mrow>
                                                                <mi>s</mi>
                                                                <mi>e</mi>
                                                                <mi>c</mi>
                                                            </mrow>
                                                        </mfrac>
                                                        <mo>=</mo>
                                                        <mn>0.008</mn>
                                                        <mi>s</mi>
                                                        <mi>e</mi>
                                                        <mi>c</mi>
                                                        <mo>=</mo>
                                                        <mn>8</mn>
                                                        <mi>m</mi>
                                                        <mi>i</mi>
                                                        <mi>c</mi>
                                                        <mi>r</mi>
                                                        <mi>o</mi>
                                                        <mi>s</mi>
                                                        <mi>e</mi>
                                                        <mi>c</mi>
                                                        <mi>s</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-28">D_{trans} = \frac{L}{R} = \frac{8000 bits}{10^9 bits/sec} = 0.008 sec = 8 microsecs</script>
                                        </span>
                                    </li>
                                    <li>
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-397" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-398" class="mjx-mrow"><span id="MJXc-Node-399" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-400" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-401" class="mjx-texatom" style=""><span id="MJXc-Node-402" class="mjx-mrow"><span id="MJXc-Node-403" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-404" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-405" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-406" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-407" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-408" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span></span></span></span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <msub>
                                                            <mi>U</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                                <mi>s</mi>
                                                                <mi>e</mi>
                                                                <mi>n</mi>
                                                                <mi>d</mi>
                                                                <mi>e</mi>
                                                                <mi>r</mi>
                                                            </mrow>
                                                        </msub>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-29">U_{sender}</script>
                                        </span>
                                        (頻寬使用率) 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>=</mo><mfrac><mrow><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>R</mi></mrow><mrow><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>R</mi></mrow></mfrac><mo>=</mo><mfrac><mn>.008</mn><mn>30.008</mn></mfrac><mo>=</mo><mn>0.00027</mn></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-409" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-410" class="mjx-mrow"><span id="MJXc-Node-411" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-412" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 3.596em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 5.085em; top: -1.642em;"><span id="MJXc-Node-413" class="mjx-mrow" style=""><span id="MJXc-Node-414" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">L</span></span><span id="MJXc-Node-415" class="mjx-texatom"><span id="MJXc-Node-416" class="mjx-mrow"><span id="MJXc-Node-417" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">/</span></span></span></span><span id="MJXc-Node-418" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 5.085em; bottom: -0.934em;"><span id="MJXc-Node-419" class="mjx-mrow" style=""><span id="MJXc-Node-420" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-421" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-422" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.12em;">T</span></span><span id="MJXc-Node-423" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">+</span></span><span id="MJXc-Node-424" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">L</span></span><span id="MJXc-Node-425" class="mjx-texatom"><span id="MJXc-Node-426" class="mjx-mrow"><span id="MJXc-Node-427" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">/</span></span></span></span><span id="MJXc-Node-428" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">R</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 3.596em;"></span></span><span class="mjx-vsize" style="height: 1.821em; vertical-align: -0.661em;"></span></span><span id="MJXc-Node-429" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-430" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 2.106em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.978em; top: -1.33em;"><span id="MJXc-Node-431" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">.008</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.978em; bottom: -0.622em;"><span id="MJXc-Node-432" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">30.008</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 2.106em;"></span></span><span class="mjx-vsize" style="height: 1.38em; vertical-align: -0.44em;"></span></span><span id="MJXc-Node-433" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-434" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.39em;">0.00027</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mo>=</mo>
                                                        <mfrac>
                                                            <mrow>
                                                                <mi>L</mi>
                                                                <mrow class="MJX-TeXAtom-ORD">
                                                                    <mo>/</mo>
                                                                </mrow>
                                                                <mi>R</mi>
                                                            </mrow>
                                                            <mrow>
                                                                <mi>R</mi>
                                                                <mi>T</mi>
                                                                <mi>T</mi>
                                                                <mo>+</mo>
                                                                <mi>L</mi>
                                                                <mrow class="MJX-TeXAtom-ORD">
                                                                    <mo>/</mo>
                                                                </mrow>
                                                                <mi>R</mi>
                                                            </mrow>
                                                        </mfrac>
                                                        <mo>=</mo>
                                                        <mfrac>
                                                            <mn>.008</mn>
                                                            <mn>30.008</mn>
                                                        </mfrac>
                                                        <mo>=</mo>
                                                        <mn>0.00027</mn>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-30">=\frac{L / R}{RTT + L / R} = \frac{.008}{30.008}= 0.00027</script>
                                        </span>
                                    </li>
                                    <li>RTT = 30 ms, 1KB pkt every 30 ms : 33kB/sec thruput over 1 Gbps link</li>
                                    <li>頻寬大也無用，protocal 限制了實體</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Pipelined-Protocal："><a class="anchor hidden-xs" href="#Pipelined-Protocal：" title="Pipelined-Protocal："><span class="octicon octicon-link"></span></a>Pipelined Protocal：</h4>
                <ul>
                    <li>
                        一次送 n 個封包，
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>U</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-435" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-436" class="mjx-mrow"><span id="MJXc-Node-437" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.084em;"><span id="MJXc-Node-438" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.084em;">U</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-439" class="mjx-texatom" style=""><span id="MJXc-Node-440" class="mjx-mrow"><span id="MJXc-Node-441" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-443" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-444" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-445" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-446" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span></span></span></span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <msub>
                                            <mi>U</mi>
                                            <mrow class="MJX-TeXAtom-ORD">
                                                <mi>s</mi>
                                                <mi>e</mi>
                                                <mi>n</mi>
                                                <mi>d</mi>
                                                <mi>e</mi>
                                                <mi>r</mi>
                                            </mrow>
                                        </msub>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-31">U_{sender}</script>
                        </span>
                        會變成 n 倍
                    </li>
                </ul>
                <h5 id="Go-back-N-GBN："><a class="anchor hidden-xs" href="#Go-back-N-GBN：" title="Go-back-N-GBN："><span class="octicon octicon-link"></span></a>Go-back-N (GBN)：</h5>
                <ul>
                    <li><img src="https://i.imgur.com/t1yHNCj.png" alt=""></li>
                    <li>n 的選擇：在RRT時間內可以在線上的最大封包數</li>
                    <li>
                        送端：<img src="https://i.imgur.com/C5xH0ha.png" alt="">
                        <ul>
                            <li>可以連續送 n 個 unacked 封包 (不等 ACK 的)</li>
                            <li>要送第 n + 1 個封包時要等包括第 1 個封包的 ACK 回來 (nextseqnum 超過窗戶就不送)→ window-based</li>
                            <li>開始送封包就開 timer，收到 cumulative ACK就把他 +1 當 send_base，把窗戶右移，然後關掉原本的計時器</li>
                            <li>如果 timeout 就把全部的 unacked 封包 (從 send_base 到 nextseqnum - 1 的封包) 重傳，timer 重設</li>
                        </ul>
                    </li>
                    <li>
                        收端：<img src="https://i.imgur.com/tQhqtkP.png" alt="">
                        <ul>
                            <li>cumulative ack (TCP 使用)，送的 ACK seqnum 意思為她和她之前的都收到了</li>
                            <li>收到未連續的封包們時(或其他奇怪的事情)，就回 ACK，包括的是此序列第一個缺少的 seqnum - 1，然後把封包直接丟掉</li>
                            <li>是否照順序要比對 expectseqnum</li>
                        </ul>
                    </li>
                    <li>缺點：只要中間有洞，後面全丟掉 (但接收端運作較簡單)</li>
                    <li>Action<img src="https://i.imgur.com/nVMqWRx.png" alt=""></li>
                </ul>
                <h5 id="Selective-Repeat"><a class="anchor hidden-xs" href="#Selective-Repeat" title="Selective-Repeat"><span class="octicon octicon-link"></span></a>Selective Repeat:</h5>
                <ul>
                    <li><img src="https://i.imgur.com/QpEON0z.png" alt=""></li>
                    <li>window size N，也是一次可以送 N 個 unacked 封包</li>
                    <li>
                        送端：
                        <ul>
                            <li>nextseqnum 超過窗戶就不送</li>
                            <li>每個封包有自己的 timer，如果 timeout(n) 就把 n<sup>th</sup> 單獨重送，重開計時器</li>
                            <li>
                                ACK(n) in [sendbase, sendbase + N] :
                                <ul>
                                    <li>標示 n<sup>th</sup> 封包已被收到，把計時器關掉</li>
                                    <li>send_base == ACKseqnum：把窗戶右移，並把資料送給應用</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        收端：
                        <ul>
                            <li>ACK(n) 是個別的 (individual)</li>
                            <li>
                                pktn in [rcvbase, rcvbase + N - 1]
                                <ul>
                                    <li>傳送 ACK(n)</li>
                                    <li>out-of-order: 暫存在 buffer 裡</li>
                                    <li>in-order: 把他到下一個洞之前的封包都給應用</li>
                                </ul>
                            </li>
                            <li>pktn in [rcvbase-N, rcvbase-1]：傳送 ACK(n)</li>
                            <li>else：忽略</li>
                            <li>收到窗戶之外的封包就拒收丟掉</li>
                        </ul>
                    </li>
                    <li>Action<img src="https://i.imgur.com/KYCda9K.png" alt=""></li>
                    <li>
                        問題：<img src="https://i.imgur.com/v0Vbzxr.png" alt="">
                        <ul>
                            <li>如果 ack 丟失，剛好接到對的 expectseqnum，就會收到兩份一樣的</li>
                            <li>解決：seq_size &gt; window_size 的兩倍，讓他沒機會重疊</li>
                        </ul>
                    </li>
                </ul>
                <h3 id="TCP1"><a class="anchor hidden-xs" href="#TCP1" title="TCP1"><span class="octicon octicon-link"></span></a>TCP</h3>
                <ul>
                    <li>
                        特徵：
                        <ul>
                            <li>point-to-point：一送端，一收端</li>
                            <li>reliable, in-order byte steam：沒有 “message boundaries” → 流</li>
                            <li>pipelined：TCP congestion and flow control <strong>set window size</strong></li>
                            <li>
                                full duplex data:
                                <ul>
                                    <li>雙向的資料流 (data flow) 於同一個連線裡</li>
                                    <li>
                                        MSS：maximum segment size → 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn mathvariant=&quot;monospace&quot;>1500</mn><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>(</mo><mi mathvariant=&quot;monospace&quot;>M</mi><mi mathvariant=&quot;monospace&quot;>T</mi><mi mathvariant=&quot;monospace&quot;>U</mi><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>)</mo><mo mathvariant=&quot;monospace&quot;>&amp;#x2212;</mo><mn mathvariant=&quot;monospace&quot;>40</mn><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>(</mo><mi mathvariant=&quot;monospace&quot;>H</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>d</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>)</mo><mo mathvariant=&quot;monospace&quot;>=</mo><mn mathvariant=&quot;monospace&quot;>1460</mn><mi mathvariant=&quot;monospace&quot;>b</mi><mi mathvariant=&quot;monospace&quot;>y</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-447" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-448" class="mjx-mrow"><span id="MJXc-Node-449" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1500</span></span><span id="MJXc-Node-450" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">(</span></span><span id="MJXc-Node-451" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">M</span></span><span id="MJXc-Node-452" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-453" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em; padding-right: 0.003em;">U</span></span><span id="MJXc-Node-454" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">)</span></span><span id="MJXc-Node-455" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-456" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.445em; padding-bottom: 0.279em;">40</span></span><span id="MJXc-Node-457" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">(</span></span><span id="MJXc-Node-458" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">H</span></span><span id="MJXc-Node-459" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-460" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-461" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span><span id="MJXc-Node-462" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-463" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-464" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">)</span></span><span id="MJXc-Node-465" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-466" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.445em; padding-bottom: 0.279em;">1460</span></span><span id="MJXc-Node-467" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-468" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">y</span></span><span id="MJXc-Node-469" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-470" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-471" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mn mathvariant="monospace">1500</mn>
                                                        <mo mathvariant="monospace" stretchy="false">(</mo>
                                                        <mi mathvariant="monospace">M</mi>
                                                        <mi mathvariant="monospace">T</mi>
                                                        <mi mathvariant="monospace">U</mi>
                                                        <mo mathvariant="monospace" stretchy="false">)</mo>
                                                        <mo mathvariant="monospace">−</mo>
                                                        <mn mathvariant="monospace">40</mn>
                                                        <mo mathvariant="monospace" stretchy="false">(</mo>
                                                        <mi mathvariant="monospace">H</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">a</mi>
                                                        <mi mathvariant="monospace">d</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">r</mi>
                                                        <mo mathvariant="monospace" stretchy="false">)</mo>
                                                        <mo mathvariant="monospace">=</mo>
                                                        <mn mathvariant="monospace">1460</mn>
                                                        <mi mathvariant="monospace">b</mi>
                                                        <mi mathvariant="monospace">y</mi>
                                                        <mi mathvariant="monospace">t</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">s</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-32">\tt 1500(MTU) - 40(Header) = 1460 bytes</script>
                                        </span>
                                    </li>
                                    <li>
                                        MTU：maximum transmit unit 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn mathvariant=&quot;monospace&quot;>1500</mn><mi mathvariant=&quot;monospace&quot;>b</mi><mi mathvariant=&quot;monospace&quot;>y</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>e</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-472" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-473" class="mjx-mrow"><span id="MJXc-Node-474" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1500</span></span><span id="MJXc-Node-475" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-476" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">y</span></span><span id="MJXc-Node-477" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-478" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mn mathvariant="monospace">1500</mn>
                                                        <mi mathvariant="monospace">b</mi>
                                                        <mi mathvariant="monospace">y</mi>
                                                        <mi mathvariant="monospace">t</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-33">\tt 1500 byte</script>
                                        </span>
                                    </li>
                                </ul>
                            </li>
                            <li>connection-oriented：在互相傳送資料前要 handshaking (交換 control msgs)</li>
                            <li>flow controlled：sender will not overwhelm receiver</li>
                        </ul>
                    </li>
                    <li>
                        Header <img src="https://i.imgur.com/5D2cm7F.png" alt="">
                        <ul>
                            <li>可以同時扮演 DATA 和 ACK 和一些其他的空置封包角色！！！</li>
                        </ul>
                    </li>
                    <li>
                        傳送細節
                        <ul>
                            <li>
                                sequence numbers：
                                <ul>
                                    <li>編號在 byte 上而不是在 pkt 上，以封包的 1st byte 的編號當作此封包的編號</li>
                                    <li>送的時候封包的大小可能不一樣 (不湊滿 1460 byte 也要送)</li>
                                    <li>共 32 bits，建完連線開頭選一個隨機值，不從 0 開始(經 queue delay 後可能誤收)</li>
                                </ul>
                            </li>
                            <li>
                                acknowledgements：
                                <ul>
                                    <li>cumulative ACK (像 Go-Back-N)</li>
                                    <li>會把 out-of-order 的封包收起來 (像 selective repeat)</li>
                                    <li>收端回的 ACK 編號是最後一個 byte 的編號的下一號(收端回傳她期待收到的編號)</li>
                                </ul>
                            </li>
                            <li><img src="https://i.imgur.com/60SEPcz.png" alt="" width="300" height="400"></li>
                            <li>Q：how receiver handles out-of-order segments<br>
                                A：TCP spec doesn’t say, up to implementor
                            </li>
                            <li>可以一次扮演兩個角色(收端和送端)，同一封包送 data 和 ACK</li>
                            <li>EX <img src="https://i.imgur.com/Gyvh3pl.png" alt=""></li>
                        </ul>
                    </li>
                    <li>
                        TCP round trip time, timeout
                        <ul>
                            <li>
                                TCP timeout
                                <ul>
                                    <li>longer than RTT,but RTT varies</li>
                                    <li>too short：會多出一些不必要的重送</li>
                                    <li>too long：對掉封包的反應太慢，浪費時間</li>
                                </ul>
                            </li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>S</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>m</mi><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>l</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>R</mi><mi mathvariant=&quot;monospace&quot;>T</mi><mi mathvariant=&quot;monospace&quot;>T</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-479" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-480" class="mjx-mrow"><span id="MJXc-Node-481" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">S</span></span><span id="MJXc-Node-482" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-483" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em; padding-right: 0.011em;">m</span></span><span id="MJXc-Node-484" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-485" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">l</span></span><span id="MJXc-Node-486" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-487" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-488" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-489" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">S</mi>
                                                <mi mathvariant="monospace">a</mi>
                                                <mi mathvariant="monospace">m</mi>
                                                <mi mathvariant="monospace">p</mi>
                                                <mi mathvariant="monospace">l</mi>
                                                <mi mathvariant="monospace">e</mi>
                                                <mi mathvariant="monospace">R</mi>
                                                <mi mathvariant="monospace">T</mi>
                                                <mi mathvariant="monospace">T</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-34">\tt SampleRTT</script>
                                </span>
                                取得方法：
                                <ul>
                                    <li>送出去的時候開始計時，收到回來的時候停止</li>
                                    <li>把傳出去的時間放在封包裡，傳回來的時候在對應現在時間的 RTT(可以一次拿多個樣本，較佳) → 用 TCP 封包裡的 option 之 time stamp 來記錄</li>
                                    <li>RTT包括 queue delay，會變動，測很多RTT來取平均</li>
                                </ul>
                            </li>
                            <li>
                                <code>EstimatedRTT = (1 - α) * EstimatedRTT + α * SampleRTT</code> 通常 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mn mathvariant=&quot;monospace&quot;>0.125</mn></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-490" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-491" class="mjx-mrow"><span id="MJXc-Node-492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">α</span></span><span id="MJXc-Node-493" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-494" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">0.125</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>α</mi>
                                                <mo mathvariant="monospace">=</mo>
                                                <mn mathvariant="monospace">0.125</mn>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-35">\tt \alpha = 0.125</script>
                                </span>
                            </li>
                            <li>
                                <code>DevRTT = (1 - β) * DevRTT + β * |SampleRTT - EstimatedRTT|</code> 通常 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mn mathvariant=&quot;monospace&quot;>0.25</mn></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-495" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-496" class="mjx-mrow"><span id="MJXc-Node-497" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.445em; padding-right: 0.007em;">β</span></span><span id="MJXc-Node-498" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-499" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">0.25</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>β</mi>
                                                <mo mathvariant="monospace">=</mo>
                                                <mn mathvariant="monospace">0.25</mn>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-36">\tt \beta = 0.25</script>
                                </span>
                                → safety margin 安全區間
                            </li>
                            <li><code>TimeoutInterval = EstimatedRTT + 4 * DevRTT</code></li>
                            <li>算出來的是 exponential weighted moving average</li>
                        </ul>
                    </li>
                    <li>
                        送端：<img src="https://i.imgur.com/htedJVg.png" alt="">
                        <ul>
                            <li>
                                data rcvd from app：
                                <ul>
                                    <li>create segment with seq #</li>
                                    <li>seq # 是 data 裡的 第一 byte 在原資料裡是第？個 byte</li>
                                    <li>
                                        如果沒再計時的話就 start timer
                                        <ul>
                                            <li>think of timer as for oldest unacked segment</li>
                                            <li>expiration interval: TimeOutInterval</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li>timeout：重送那個導致 timeout 的封包(最左邊沒 ACK 過的那一個封包)，重新計時</li>
                            <li>ack rcvd：更新 ACKed 的編號，如果還有 unacked 的片段就再計時</li>
                        </ul>
                    </li>
                    <li>EX： <img src="https://i.imgur.com/3zgWGrh.png" alt=""></li>
                    <li>
                        其他處理<img src="https://i.imgur.com/YPV0n7Q.png" alt="">
                        <ul>
                            <li>如果目前沒缺 → delayed ACK (等一下看有沒有下個封包再送)</li>
                            <li>收到正常順序的封包 → 每收兩個封包再回一個 ACK</li>
                            <li>收到順序不對的封包 → 馬上發送 duplicate ACK (ACK 編號跟上次一樣的封包)</li>
                            <li>收到把缺的補齊的封包 → 馬上發正確的 ACK</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="TCP-fast-retransmit"><a class="anchor hidden-xs" href="#TCP-fast-retransmit" title="TCP-fast-retransmit"><span class="octicon octicon-link"></span></a>TCP fast retransmit</h4>
                <ul>
                    <li>利用 cumulative ACK 的特性，有缺口時 ACK 的編號會重複送</li>
                    <li>如果收到三個一樣的ACK編號，就直接重送，不要等超時 → 快很多</li>
                    <li>適合連續送的資料(太少資料及不到三個也沒用)</li>
                    <li>
                        三個的選擇
                        <ul>
                            <li>太小：順序錯但都沒掉</li>
                            <li>太大：跟等超時差不多</li>
                        </ul>
                    </li>
                    <li><img src="https://i.imgur.com/ZL1ZOvN.png" alt="" width="280" height="400"></li>
                </ul>
                <h4 id="Flow-Control"><a class="anchor hidden-xs" href="#Flow-Control" title="Flow-Control"><span class="octicon octicon-link"></span></a>Flow Control</h4>
                <ul>
                    <li>
                        每個 socket 有兩個 buffers
                        <ul>
                            <li>send buffer：拿來儲存要送出去的封包</li>
                            <li>recieve buffer：收到封包後先存在這裡，應用要用的時候再呼叫 system code 來 buffer 裡取</li>
                        </ul>
                    </li>
                    <li>可見收的時候是有限空間，太多擠不進 buffer 的時候就被丟掉了</li>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>R</mi><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>v</mi><mi mathvariant=&quot;monospace&quot;>B</mi><mi mathvariant=&quot;monospace&quot;>u</mi><mi mathvariant=&quot;monospace&quot;>f</mi><mi mathvariant=&quot;monospace&quot;>f</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>r</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-500" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-501" class="mjx-mrow"><span id="MJXc-Node-502" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-503" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-504" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">v</span></span><span id="MJXc-Node-505" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">B</span></span><span id="MJXc-Node-506" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-507" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">f</span></span><span id="MJXc-Node-508" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">f</span></span><span id="MJXc-Node-509" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-510" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi mathvariant="monospace">R</mi>
                                        <mi mathvariant="monospace">c</mi>
                                        <mi mathvariant="monospace">v</mi>
                                        <mi mathvariant="monospace">B</mi>
                                        <mi mathvariant="monospace">u</mi>
                                        <mi mathvariant="monospace">f</mi>
                                        <mi mathvariant="monospace">f</mi>
                                        <mi mathvariant="monospace">e</mi>
                                        <mi mathvariant="monospace">r</mi>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-37">\tt RcvBuffer</script>
                        </span>
                        size set via socket options (預設 4096 bytes)
                    </li>
                    <li>
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-38-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>w</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>d</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-511" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-512" class="mjx-mrow"><span id="MJXc-Node-513" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-514" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span><span id="MJXc-Node-515" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-516" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi mathvariant="monospace">r</mi>
                                        <mi mathvariant="monospace">w</mi>
                                        <mi mathvariant="monospace">n</mi>
                                        <mi mathvariant="monospace">d</mi>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-38">\tt rwnd</script>
                        </span>
                        value：buffer 中剩下的可用空間，放在 ACK 裡送回送端 (recieve window)
                    </li>
                    <li>
                        <strong>
                            送端藉由把 window size 改成跟 
                            <span class="mathjax">
                                <span class="MathJax_Preview" style="color: inherit;"></span>
                                <span id="MathJax-Element-39-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>w</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>d</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                    <span id="MJXc-Node-517" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-518" class="mjx-mrow"><span id="MJXc-Node-519" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-520" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span><span id="MJXc-Node-521" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-522" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span></span></span>
                                    <span class="MJX_Assistive_MathML" role="presentation">
                                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                                            <mi mathvariant="monospace">r</mi>
                                            <mi mathvariant="monospace">w</mi>
                                            <mi mathvariant="monospace">n</mi>
                                            <mi mathvariant="monospace">d</mi>
                                        </math>
                                    </span>
                                </span>
                                <script type="math/tex" id="MathJax-Element-39">\tt rwnd</script>
                            </span>
                            一樣來達成
                        </strong>
                    </li>
                    <li>所以其實 window size 跟 RTT &amp; rwnd 都有關</li>
                </ul>
                <h4 id="Connection-Management"><a class="anchor hidden-xs" href="#Connection-Management" title="Connection-Management"><span class="octicon octicon-link"></span></a>Connection Management</h4>
                <ul>
                    <li>
                        2-way handshake 失敗例子： <img src="https://i.imgur.com/s9Ixc8A.png" alt="">
                        <ul>
                            <li>形成單方面的建連線、造成不必要的重送和重複收</li>
                        </ul>
                    </li>
                    <li>
                        TCP 3-way handshake (FSM) <img src="https://i.imgur.com/IVrcDmx.png" alt="">
                        <ul>
                            <li>SYNbit 和 ACKbit 設為 1 來帶有對於 SYN 的 ACK 的作用</li>
                            <li>SYN flood 攻擊：送端故意送一個而不送兩個(不完成第三步握手)，讓伺服器挖出一個空間讓你等不到，然後送很多份讓你爆掉，癱瘓你原本該做的事情</li>
                            <li>流程：<img src="https://i.imgur.com/5jOY5Ug.png" alt=""></li>
                        </ul>
                    </li>
                    <li>
                        關連線 → 需 4-way
                        <ul>
                            <li>關可以單邊關，兩邊都關才是全關</li>
                            <li>運用 FINbit 來達成</li>
                            <li>過程 <img src="https://i.imgur.com/rPn0Qwf.png" alt=""></li>
                            <li>
                                為何要在 TIMED_WAIT 再等一段時間？
                                <ul>
                                    <li>如果過去的 ACK 掉了，對面會再發一次，這樣才有機會再重送</li>
                                    <li>如果不等而太快關掉，然後又太快建起來，就有可能誤收，所以在等的時候霸佔那個 port 就不會發生這樣的事情</li>
                                </ul>
                            </li>
                            <li>
                                為何是兩倍？
                                <ul>
                                    <li>因為兩倍已經很多了，關於 IP 層的 TTL</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Congestion-Control"><a class="anchor hidden-xs" href="#Congestion-Control" title="Congestion-Control"><span class="octicon octicon-link"></span></a>Congestion Control</h4>
                <ul>
                    <li>(1)：<img src="https://i.imgur.com/YEBhij2.png" alt=""></li>
                    <li>
                        (2)：
                        <ul>
                            <li>1 router, finite buffers</li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo>=</mo><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-523" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-524" class="mjx-mrow"><span id="MJXc-Node-525" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-526" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-527" class="mjx-texatom" style=""><span id="MJXc-Node-528" class="mjx-mrow"><span id="MJXc-Node-529" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-530" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span></span></span></span><span id="MJXc-Node-531" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.058em; padding-bottom: 0.335em;">=</span></span><span id="MJXc-Node-532" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-533" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-534" class="mjx-texatom" style=""><span id="MJXc-Node-535" class="mjx-mrow"><span id="MJXc-Node-536" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-537" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-538" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.39em; padding-bottom: 0.279em;">t</span></span></span></span></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msub>
                                                    <mi>λ</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>i</mi>
                                                        <mi>n</mi>
                                                    </mrow>
                                                </msub>
                                                <mo>=</mo>
                                                <msub>
                                                    <mi>λ</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>o</mi>
                                                        <mi>u</mi>
                                                        <mi>t</mi>
                                                    </mrow>
                                                </msub>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-40">\lambda _{in} = \lambda _{out}</script>
                                </span>
                                for application-layer
                            </li>
                            <li>
                                transport-layer input includes retransmissions 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></mrow><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2265;</mo><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-539" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-540" class="mjx-mrow"><span id="MJXc-Node-541" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-542" class="mjx-texatom"><span id="MJXc-Node-543" class="mjx-mrow"><span id="MJXc-Node-544" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-545" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-546" class="mjx-texatom" style=""><span id="MJXc-Node-547" class="mjx-mrow"><span id="MJXc-Node-548" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-549" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span></span></span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.631em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-550" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.335em;">′</span></span></span></span><span id="MJXc-Node-551" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.335em; padding-bottom: 0.501em;">≥</span></span><span id="MJXc-Node-552" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-553" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-554" class="mjx-texatom" style=""><span id="MJXc-Node-555" class="mjx-mrow"><span id="MJXc-Node-556" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-557" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span></span></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msup>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <msub>
                                                            <mi>λ</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                                <mi>i</mi>
                                                                <mi>n</mi>
                                                            </mrow>
                                                        </msub>
                                                    </mrow>
                                                    <mo>′</mo>
                                                </msup>
                                                <mo>≥</mo>
                                                <msub>
                                                    <mi>λ</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>i</mi>
                                                        <mi>n</mi>
                                                    </mrow>
                                                </msub>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-41">{\lambda _{in}}' \ge \lambda _{in}</script>
                                </span>
                            </li>
                            <li>
                                理想狀態：
                                <ul>
                                    <li>perfect knowledge：只在 buffer 有空時才送封包</li>
                                    <li>known loss：buffer 滿了就會把再來的封包丟掉 → sender 只重送被丟掉的封包</li>
                                </ul>
                            </li>
                            <li>
                                現實上duplicates
                                <ul>
                                    <li>packets can be lost, dropped at router due to full buffers</li>
                                    <li>太早超時，造成發送兩份都被收到，浪費頻寬</li>
                                </ul>
                            </li>
                            <li>
                                代價 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>g</mi><mi mathvariant=&quot;monospace&quot;>o</mi><mi mathvariant=&quot;monospace&quot;>o</mi><mi mathvariant=&quot;monospace&quot;>d</mi><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>u</mi><mi mathvariant=&quot;monospace&quot;>t</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-558" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-559" class="mjx-mrow"><span id="MJXc-Node-560" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">g</span></span><span id="MJXc-Node-561" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-562" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-563" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span><span id="MJXc-Node-564" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-565" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-566" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">g</mi>
                                                <mi mathvariant="monospace">o</mi>
                                                <mi mathvariant="monospace">o</mi>
                                                <mi mathvariant="monospace">d</mi>
                                                <mi mathvariant="monospace">p</mi>
                                                <mi mathvariant="monospace">u</mi>
                                                <mi mathvariant="monospace">t</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-42">\tt goodput</script>
                                </span>
                                (每單位時間接收到的"有用"資料)：<img src="https://i.imgur.com/Bz9EE83.png" alt="">
                                <ul>
                                    <li>
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>u</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>d</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>d</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-567" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-568" class="mjx-mrow"><span id="MJXc-Node-569" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-570" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-571" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-572" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-573" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-574" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span><span id="MJXc-Node-575" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-576" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi mathvariant="monospace">u</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">d</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">d</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-43">\tt unneeded</script>
                                        </span>
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>m</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>o</mi><mi mathvariant=&quot;monospace&quot;>n</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-577" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-578" class="mjx-mrow"><span id="MJXc-Node-579" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-580" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-581" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-582" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-583" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-584" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-585" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-586" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em; padding-right: 0.011em;">m</span></span><span id="MJXc-Node-587" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-588" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-589" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-590" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-591" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-592" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi mathvariant="monospace">r</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">t</mi>
                                                        <mi mathvariant="monospace">r</mi>
                                                        <mi mathvariant="monospace">a</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                        <mi mathvariant="monospace">s</mi>
                                                        <mi mathvariant="monospace">m</mi>
                                                        <mi mathvariant="monospace">i</mi>
                                                        <mi mathvariant="monospace">s</mi>
                                                        <mi mathvariant="monospace">s</mi>
                                                        <mi mathvariant="monospace">i</mi>
                                                        <mi mathvariant="monospace">o</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-44">\tt retransmission</script>
                                        </span>
                                        (重送一些不須重送的)
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        (3)：<img src="https://i.imgur.com/jb9IfDI.png" alt="">
                        <ul>
                            <li>4 senders、multihop paths、timeout/retransmit</li>
                            <li>中間經過別的地方時，某些路段可能有其他人在競爭</li>
                            <li>另一代價：浪費前面的頻寬，然後在後面的 router 太擠被丟掉，不如來送其他的封包</li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-593" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-594" class="mjx-mrow"><span id="MJXc-Node-595" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.445em;">Q</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>Q</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-45">Q</script>
                                </span>
                                ：當 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-46-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-596" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-597" class="mjx-mrow"><span id="MJXc-Node-598" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-599" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-600" class="mjx-texatom" style=""><span id="MJXc-Node-601" class="mjx-mrow"><span id="MJXc-Node-602" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-603" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span></span></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msub>
                                                    <mi>λ</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>i</mi>
                                                        <mi>n</mi>
                                                    </mrow>
                                                </msub>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-46">\lambda _{in}</script>
                                </span>
                                和 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-604" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-605" class="mjx-mrow"><span id="MJXc-Node-606" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-607" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-608" class="mjx-texatom" style=""><span id="MJXc-Node-609" class="mjx-mrow"><span id="MJXc-Node-610" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-611" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span></span></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msub>
                                                    <mi>λ</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>i</mi>
                                                        <mi>n</mi>
                                                    </mrow>
                                                </msub>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-47">\lambda _{in}</script>
                                </span>
                                ’ 增加時會發生甚麼？
                            </li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-612" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-613" class="mjx-mrow"><span id="MJXc-Node-614" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.279em;">A</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>A</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-48">A</script>
                                </span>
                                ：當紅的 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-49-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03BB;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-615" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-616" class="mjx-mrow"><span id="MJXc-Node-617" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-618" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">λ</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-619" class="mjx-texatom" style=""><span id="MJXc-Node-620" class="mjx-mrow"><span id="MJXc-Node-621" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-622" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span></span></span></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <msub>
                                                    <mi>λ</mi>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi>i</mi>
                                                        <mi>n</mi>
                                                    </mrow>
                                                </msub>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-49">\lambda _{in}</script>
                                </span>
                                ’ 增加時，所有藍色要到達的封包都被丟了(因為被占滿了)，blue throughput → 0
                            </li>
                        </ul>
                    </li>
                    <li>
                        由此可知，壅塞是很嚴重的問題，付出許多代價
                        <ul>
                            <li>重送的浪費頻寬</li>
                            <li>被丟掉時，此封包曾經過的上游的頻寬就功虧一簣浪費了</li>
                            <li>所以應該要共體時艱，一起降速，不要 retransmission</li>
                        </ul>
                    </li>
                    <li>
                        AIMD 方法 (additive increase multiplicative decrease)：<br>
                        送端增加傳輸速率 (window size) 來偵測可用頻寬，直到丟失發生
                        <ul>
                            <li>
                                additive increase：一包一包的增加傳輸速率 (
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-50-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>w</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>d</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-623" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-624" class="mjx-mrow"><span id="MJXc-Node-625" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-626" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span><span id="MJXc-Node-627" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-628" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">c</mi>
                                                <mi mathvariant="monospace">w</mi>
                                                <mi mathvariant="monospace">n</mi>
                                                <mi mathvariant="monospace">d</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-50">\tt cwnd</script>
                                </span>
                                ) 直到封包掉了就砍半，如果都沒掉就認為他還有頻寬可以送
                            </li>
                            <li>
                                multiplicative decrease：封包掉了後就 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-51-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>w</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>d</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-629" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-630" class="mjx-mrow"><span id="MJXc-Node-631" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-632" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span><span id="MJXc-Node-633" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-634" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">c</mi>
                                                <mi mathvariant="monospace">w</mi>
                                                <mi mathvariant="monospace">n</mi>
                                                <mi mathvariant="monospace">d</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-51">\tt cwnd</script>
                                </span>
                                砍半(為了緊急舒緩網路塞車)
                            </li>
                            <li>這方法是 fast trasmission 有發揮作用的狀況下有用</li>
                            <li>TCP 天生就是設計來被掉封包的 <img src="https://i.imgur.com/gb5sTCc.png" alt="" width="430" height="200"></li>
                        </ul>
                    </li>
                    <li>
                        TCP Slow Start (其實是快速開始)
                        <ul>
                            <li>一開始 cwnd = 1 MSS</li>
                            <li>之後每個 ACK 回來就把 cwnd * 2，指數成長，直到第一次丟封包</li>
                        </ul>
                    </li>
                    <li>
                        TCP 自身實作
                        <ul>
                            <li>
                                sender limits transmission：
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-52-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>L</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>B</mi><mi mathvariant=&quot;monospace&quot;>y</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>S</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mo mathvariant=&quot;monospace&quot;>&amp;#x2212;</mo><mi mathvariant=&quot;monospace&quot;>L</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>B</mi><mi mathvariant=&quot;monospace&quot;>y</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>A</mi><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>k</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>d</mi><mo mathvariant=&quot;monospace&quot;>&amp;lt;</mo><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>w</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>d</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-635" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-636" class="mjx-mrow"><span id="MJXc-Node-637" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">L</span></span><span id="MJXc-Node-638" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-639" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-640" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-641" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">B</span></span><span id="MJXc-Node-642" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">y</span></span><span id="MJXc-Node-643" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-644" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-645" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">S</span></span><span id="MJXc-Node-646" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-647" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-648" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-649" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-650" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">L</span></span><span id="MJXc-Node-651" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-652" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-653" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-654" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">B</span></span><span id="MJXc-Node-655" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">y</span></span><span id="MJXc-Node-656" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-657" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-658" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.445em; padding-bottom: 0.279em;">A</span></span><span id="MJXc-Node-659" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-660" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">k</span></span><span id="MJXc-Node-661" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-662" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span><span id="MJXc-Node-663" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.224em;">&lt;</span></span><span id="MJXc-Node-664" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-665" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span><span id="MJXc-Node-666" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-667" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">L</mi>
                                                <mi mathvariant="monospace">a</mi>
                                                <mi mathvariant="monospace">s</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mi mathvariant="monospace">B</mi>
                                                <mi mathvariant="monospace">y</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mi mathvariant="monospace">e</mi>
                                                <mi mathvariant="monospace">S</mi>
                                                <mi mathvariant="monospace">e</mi>
                                                <mi mathvariant="monospace">n</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mo mathvariant="monospace">−</mo>
                                                <mi mathvariant="monospace">L</mi>
                                                <mi mathvariant="monospace">a</mi>
                                                <mi mathvariant="monospace">s</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mi mathvariant="monospace">B</mi>
                                                <mi mathvariant="monospace">y</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mi mathvariant="monospace">e</mi>
                                                <mi mathvariant="monospace">A</mi>
                                                <mi mathvariant="monospace">c</mi>
                                                <mi mathvariant="monospace">k</mi>
                                                <mi mathvariant="monospace">e</mi>
                                                <mi mathvariant="monospace">d</mi>
                                                <mo mathvariant="monospace">&lt;</mo>
                                                <mi mathvariant="monospace">c</mi>
                                                <mi mathvariant="monospace">w</mi>
                                                <mi mathvariant="monospace">n</mi>
                                                <mi mathvariant="monospace">d</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-52">\tt LastByteSent-LastByteAcked<cwnd</script>
                                </span>
                            </li>
                            <li>
                                粗估 TCP 傳送速率 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-53-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mfrac><mrow><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>w</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>d</mi></mrow><mrow><mi mathvariant=&quot;monospace&quot;>R</mi><mi mathvariant=&quot;monospace&quot;>T</mi><mi mathvariant=&quot;monospace&quot;>T</mi></mrow></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-668" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-669" class="mjx-mrow"><span id="MJXc-Node-670" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-671" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-672" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-673" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-674" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-675" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.626em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.3em; top: -1.259em;"><span id="MJXc-Node-676" class="mjx-mrow" style=""><span id="MJXc-Node-677" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-678" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span><span id="MJXc-Node-679" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-680" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.3em; bottom: -0.556em;"><span id="MJXc-Node-681" class="mjx-mrow" style=""><span id="MJXc-Node-682" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-683" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-684" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 1.626em;"></span></span><span class="mjx-vsize" style="height: 1.283em; vertical-align: -0.393em;"></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">r</mi>
                                                <mi mathvariant="monospace">a</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mi mathvariant="monospace">e</mi>
                                                <mo mathvariant="monospace">=</mo>
                                                <mfrac>
                                                    <mrow>
                                                        <mi mathvariant="monospace">c</mi>
                                                        <mi mathvariant="monospace">w</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                        <mi mathvariant="monospace">d</mi>
                                                    </mrow>
                                                    <mrow>
                                                        <mi mathvariant="monospace">R</mi>
                                                        <mi mathvariant="monospace">T</mi>
                                                        <mi mathvariant="monospace">T</mi>
                                                    </mrow>
                                                </mfrac>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-53">\tt rate=\frac{cwnd}{RTT}</script>
                                </span>
                                bytes/sec
                            </li>
                            <li>
                                timeout 表示的丟失:
                                <ul>
                                    <li>一開始 cwnd = 1 MSS</li>
                                    <li>先用 slow start，直到<strong>門檻值 (threshold)</strong> 再用 linearly (AIMD)</li>
                                </ul>
                            </li>
                            <li>
                                3 個重複的 ACKs 表示的丟失：TCP RENO
                                <ul>
                                    <li>dup ACKs 表示網路可以傳送東西</li>
                                    <li>cwnd 切一半然後用線性成長</li>
                                </ul>
                            </li>
                            <li>TCP Tahoe 則是掉包設 cwnd = 1 (兩種情況都如此)</li>
                            <li>
                                switching from slow start to CA (<strong>C</strong>ongestion <strong>A</strong>voidence)   <img src="https://i.imgur.com/94bZKYo.png" alt="" width="430" height="260">
                                <ul>
                                    <li>
                                        掉封包時，
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-54-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>h</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>h</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-685" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-686" class="mjx-mrow"><span id="MJXc-Node-687" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-688" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-689" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-690" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">h</span></span><span id="MJXc-Node-691" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-692" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-693" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-694" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">h</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi mathvariant="monospace">s</mi>
                                                        <mi mathvariant="monospace">s</mi>
                                                        <mi mathvariant="monospace">t</mi>
                                                        <mi mathvariant="monospace">h</mi>
                                                        <mi mathvariant="monospace">r</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">s</mi>
                                                        <mi mathvariant="monospace">h</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-54">\tt ssthresh</script>
                                        </span>
                                        (緩啟動門檻值) 設為 1/2 * 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-55-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>w</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>d</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-695" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-696" class="mjx-mrow"><span id="MJXc-Node-697" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-698" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">w</span></span><span id="MJXc-Node-699" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-700" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">d</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi mathvariant="monospace">c</mi>
                                                        <mi mathvariant="monospace">w</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                        <mi mathvariant="monospace">d</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-55">\tt cwnd</script>
                                        </span>
                                        ，且 cwnd 再從 1 開始
                                    </li>
                                    <li>在門檻值之前用 slow start，超過後用 AIMD</li>
                                </ul>
                            </li>
                            <li>state diagram<img src="https://i.imgur.com/SPI9Cyx.png" alt=""></li>
                            <li>
                                TCP 只要封包掉了就假設他塞車，如果沒有就加速充分利用
                                <ul>
                                    <li>但丟封包不一定是塞車，如果在無線網路有可能是訊號差…等問題</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        TCP throughput
                        <ul>
                            <li>忽略 slow start，假設一直有資料可送</li>
                            <li>
                                W = 丟失時的 window size (bytes)，跟底下可用頻寬有關(正相關) (人多的時候就較小)
                                <ul>
                                    <li>avg. window size (# in-flight bytes) is ¾ W</li>
                                    <li>avg. thruput is 3/4W per RTT</li>
                                </ul>
                            </li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-56-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>v</mi><mi mathvariant=&quot;monospace&quot;>g</mi><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mi mathvariant=&quot;monospace&quot;>T</mi><mi mathvariant=&quot;monospace&quot;>C</mi><mi mathvariant=&quot;monospace&quot;>P</mi><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>h</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>u</mi><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>u</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mfrac><mn mathvariant=&quot;monospace&quot;>3</mn><mn mathvariant=&quot;monospace&quot;>4</mn></mfrac><mfrac><mi mathvariant=&quot;monospace&quot;>W</mi><mrow><mi mathvariant=&quot;monospace&quot;>R</mi><mi mathvariant=&quot;monospace&quot;>T</mi><mi mathvariant=&quot;monospace&quot;>T</mi></mrow></mfrac><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mi mathvariant=&quot;monospace&quot;>b</mi><mi mathvariant=&quot;monospace&quot;>y</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo mathvariant=&quot;monospace&quot;>/</mo></mrow><mi mathvariant=&quot;monospace&quot;>s</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>c</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-701" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-702" class="mjx-mrow"><span id="MJXc-Node-703" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-704" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">v</span></span><span id="MJXc-Node-705" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">g</span></span><span id="MJXc-Node-706" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-707" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-708" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">C</span></span><span id="MJXc-Node-709" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">P</span></span><span id="MJXc-Node-710" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-711" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-712" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">h</span></span><span id="MJXc-Node-713" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-714" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-715" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-716" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-717" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-718" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-719" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.513em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.725em; top: -1.275em;"><span id="MJXc-Node-720" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">3</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.725em; bottom: -0.557em;"><span id="MJXc-Node-721" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.445em; padding-bottom: 0.279em;">4</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 0.513em;"></span></span><span class="mjx-vsize" style="height: 1.295em; vertical-align: -0.394em;"></span></span><span id="MJXc-Node-722" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.255em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.775em; top: -1.26em;"><span id="MJXc-Node-723" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">W</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.775em; bottom: -0.556em;"><span id="MJXc-Node-724" class="mjx-mrow" style=""><span id="MJXc-Node-725" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-726" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-727" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 1.255em;"></span></span><span class="mjx-vsize" style="height: 1.284em; vertical-align: -0.393em;"></span></span><span id="MJXc-Node-728" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-729" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-730" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">y</span></span><span id="MJXc-Node-731" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-732" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-733" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-734" class="mjx-texatom"><span id="MJXc-Node-735" class="mjx-mrow"><span id="MJXc-Node-736" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">/</span></span></span></span><span id="MJXc-Node-737" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span><span id="MJXc-Node-738" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-739" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">a</mi>
                                                <mi mathvariant="monospace">v</mi>
                                                <mi mathvariant="monospace">g</mi>
                                                <mtext mathvariant="monospace">&nbsp;</mtext>
                                                <mi mathvariant="monospace">T</mi>
                                                <mi mathvariant="monospace">C</mi>
                                                <mi mathvariant="monospace">P</mi>
                                                <mtext mathvariant="monospace">&nbsp;</mtext>
                                                <mi mathvariant="monospace">t</mi>
                                                <mi mathvariant="monospace">h</mi>
                                                <mi mathvariant="monospace">r</mi>
                                                <mi mathvariant="monospace">u</mi>
                                                <mi mathvariant="monospace">p</mi>
                                                <mi mathvariant="monospace">u</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mo mathvariant="monospace">=</mo>
                                                <mfrac>
                                                    <mn mathvariant="monospace">3</mn>
                                                    <mn mathvariant="monospace">4</mn>
                                                </mfrac>
                                                <mfrac>
                                                    <mi mathvariant="monospace">W</mi>
                                                    <mrow>
                                                        <mi mathvariant="monospace">R</mi>
                                                        <mi mathvariant="monospace">T</mi>
                                                        <mi mathvariant="monospace">T</mi>
                                                    </mrow>
                                                </mfrac>
                                                <mtext mathvariant="monospace">&nbsp;</mtext>
                                                <mi mathvariant="monospace">b</mi>
                                                <mi mathvariant="monospace">y</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mi mathvariant="monospace">e</mi>
                                                <mi mathvariant="monospace">s</mi>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                    <mo mathvariant="monospace">/</mo>
                                                </mrow>
                                                <mi mathvariant="monospace">s</mi>
                                                <mi mathvariant="monospace">e</mi>
                                                <mi mathvariant="monospace">c</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-56">\tt avg\ TCP\ thruput = \frac{3}{4} \frac{W}{RTT}\ bytes/sec</script>
                                </span>
                            </li>
                            <li>最理想狀況，都是觸發 fast trasmission，而不是 timeout <img src="https://i.imgur.com/hiAdTML.png" alt=""></li>
                        </ul>
                    </li>
                    <li>
                        TCP Futures：TCP over “long, fat pipes” (長距離，大頻寬)
                        <ul>
                            <li>Ex：1500 byte segments、100ms RTT、 10 Gbps throughput</li>
                            <li>需要 W = 83,333 in-flight segments</li>
                            <li>
                                throughput in terms of segment loss probability, L [Mathis 1997]:
                                <ul>
                                    <li>
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-57-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>T</mi><mi mathvariant=&quot;monospace&quot;>C</mi><mi mathvariant=&quot;monospace&quot;>P</mi><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>h</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>o</mi><mi mathvariant=&quot;monospace&quot;>u</mi><mi mathvariant=&quot;monospace&quot;>g</mi><mi mathvariant=&quot;monospace&quot;>h</mi><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>u</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mfrac><mrow><mn mathvariant=&quot;monospace&quot;>1.22</mn><mo>&amp;#x00D7;</mo><mi mathvariant=&quot;monospace&quot;>M</mi><mi mathvariant=&quot;monospace&quot;>S</mi><mi mathvariant=&quot;monospace&quot;>S</mi></mrow><mrow><mi mathvariant=&quot;monospace&quot;>R</mi><mi mathvariant=&quot;monospace&quot;>T</mi><mi mathvariant=&quot;monospace&quot;>T</mi><msqrt><mi mathvariant=&quot;monospace&quot;>L</mi></msqrt></mrow></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-740" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-741" class="mjx-mrow"><span id="MJXc-Node-742" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-743" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">C</span></span><span id="MJXc-Node-744" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">P</span></span><span id="MJXc-Node-745" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-746" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-747" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">h</span></span><span id="MJXc-Node-748" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-749" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-750" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-751" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">g</span></span><span id="MJXc-Node-752" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">h</span></span><span id="MJXc-Node-753" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-754" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">u</span></span><span id="MJXc-Node-755" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-756" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-757" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 3.29em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 4.653em; top: -1.275em;"><span id="MJXc-Node-758" class="mjx-mrow" style=""><span id="MJXc-Node-759" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1.22</span></span><span id="MJXc-Node-760" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-761" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">M</span></span><span id="MJXc-Node-762" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">S</span></span><span id="MJXc-Node-763" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">S</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 4.653em; bottom: -0.994em;"><span id="MJXc-Node-764" class="mjx-mrow" style=""><span id="MJXc-Node-765" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-766" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-767" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-768" class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.501em; padding-bottom: 0.556em;">√</span></span><span class="mjx-box" style="padding-top: 0.157em; border-top: 1px solid;"><span id="MJXc-Node-769" class="mjx-mrow"><span id="MJXc-Node-770" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">L</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 3.29em;"></span></span><span class="mjx-vsize" style="height: 1.604em; vertical-align: -0.703em;"></span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi mathvariant="monospace">T</mi>
                                                        <mi mathvariant="monospace">C</mi>
                                                        <mi mathvariant="monospace">P</mi>
                                                        <mtext mathvariant="monospace">&nbsp;</mtext>
                                                        <mi mathvariant="monospace">t</mi>
                                                        <mi mathvariant="monospace">h</mi>
                                                        <mi mathvariant="monospace">r</mi>
                                                        <mi mathvariant="monospace">o</mi>
                                                        <mi mathvariant="monospace">u</mi>
                                                        <mi mathvariant="monospace">g</mi>
                                                        <mi mathvariant="monospace">h</mi>
                                                        <mi mathvariant="monospace">p</mi>
                                                        <mi mathvariant="monospace">u</mi>
                                                        <mi mathvariant="monospace">t</mi>
                                                        <mo mathvariant="monospace">=</mo>
                                                        <mfrac>
                                                            <mrow>
                                                                <mn mathvariant="monospace">1.22</mn>
                                                                <mo>×</mo>
                                                                <mi mathvariant="monospace">M</mi>
                                                                <mi mathvariant="monospace">S</mi>
                                                                <mi mathvariant="monospace">S</mi>
                                                            </mrow>
                                                            <mrow>
                                                                <mi mathvariant="monospace">R</mi>
                                                                <mi mathvariant="monospace">T</mi>
                                                                <mi mathvariant="monospace">T</mi>
                                                                <msqrt>
                                                                    <mi mathvariant="monospace">L</mi>
                                                                </msqrt>
                                                            </mrow>
                                                        </mfrac>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-57">\tt TCP\ throughput =\frac{1.22\times MSS}{RTT\sqrt L}</script>
                                        </span>
                                    </li>
                                    <li>為達成 10 Gbps throughput，需要 loss rate of L = 2 * 10<sup>-10</sup> (很小的遺失率)</li>
                                </ul>
                            </li>
                            <li>new versions of TCP for high-speed</li>
                        </ul>
                    </li>
                    <li>
                        TCP Fairness
                        <ul>
                            <li>最理想狀態是平均分配給每個 sessions</li>
                            <li>大部分的情況下，頻寬的分配會是均勻的 (不能看瞬時，會不準)</li>
                            <li>
                                但還是有可能發生霸凌狀況 → 當兩邊的 RTT 不同的時候，RTT 大的比較佔優勢
                                <ul>
                                    <li>前言：觸發 fast transmit 時會比觸發 timeout 還要快，可以少等一些時間，如果一邊一直觸發，另一邊一直沒觸發，沒觸發的那一邊就被霸凌了！</li>
                                    <li>當 RTT 較大的時候，window size 可以比較大，掉封包的時候後面有很多封包可以幫她集到 3 個</li>
                                    <li>當 RTT 較小的時候，能同時在線上傳輸的封包較少，可能無法集到三個而導致她就需要一直等超時 → 就被霸凌了！</li>
                                </ul>
                            </li>
                            <li>
                                不同協定本身的傳遞特徵差異導致的不公平
                                <ul>
                                    <li>UDP 的話可以定速</li>
                                    <li>TCP 相比起來比較吃虧，因為會一直降速</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Explicit Congestion Notification (ECN)
                        <ul>
                            <li>IP header 用 2 bit 來顯示中間 router 的狀態，然後一路傳下去到收端，收端回 ACK 傳到送端(裡面包含 ECE 顯示收到封包裡所傳達的交通狀態)，讓送端知道路上有遇到塞車</li>
                            <li>送端收到塞車封包後 → 同掉封包的處理方式來進行(但封包其實沒真的掉)</li>
                            <li>基本上作業系統與近年來的較先進的路由器等等都有此功能，不過只有 IOS 有預設開啟</li>
                        </ul>
                    </li>
                </ul>
                <h2 id="Network-Layer"><a class="anchor hidden-xs" href="#Network-Layer" title="Network-Layer"><span class="octicon octicon-link"></span></a>Network Layer</h2>
                <h3 id="Overview-of-Network-layer"><a class="anchor hidden-xs" href="#Overview-of-Network-layer" title="Overview-of-Network-layer"><span class="octicon octicon-link"></span></a>Overview of Network layer</h3>
                <ul>
                    <li>
                        network-layer functions
                        <ul>
                            <li>routing：決定把封包送去哪個輸出端 (演算法-找router的shortest path)</li>
                            <li>forwarding：把封包從輸入端送到輸出端</li>
                        </ul>
                    </li>
                    <li>
                        Data plane
                        <ul>
                            <li>local、per-router function</li>
                            <li>決定如何將來到輸入端的 datagram 送到輸出端 → forwarding function</li>
                        </ul>
                    </li>
                    <li>
                        Control plane
                        <ul>
                            <li>network-wide logic</li>
                            <li>決定如何在路由器之間將 datagram 從 src host 到 dst host 的 end-end path 路由</li>
                            <li>
                                <strong>Per-router control plane</strong> (traditional routing algorithms)：
                                <ul>
                                    <li>實作於路由器，會看到<strong>離散</strong>的電腦或路由器…等等</li>
                                    <li>每個路由器都有 routing table，各自交換訊息以得到其他路由器的資料再合併得到最佳的路徑，不需匯集所有資料再一台電腦上就可以進行<br>
                                        <img src="https://i.imgur.com/mHGsGmK.png" alt="">
                                    </li>
                                    <li>目前大多數的網路運用此方法</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Logically centralized control plane</strong> (software-defined networking (SDN))：
                                <ul>
                                    <li>實作於 (remote) servers，回歸到單一電腦決定整個網路的運作，只讓一台有智慧，其他人都是白癡，全部都聽他號令<br>
                                        <img src="https://i.imgur.com/eE2fP7S.png" alt="">
                                    </li>
                                    <li>邏輯上只有一台 (primary)，但物理上會有備案的那一台 (secondary)，當今天這台壞掉，還有人可以接替他的工作</li>
                                    <li>缺點：一台電腦可負荷的路由器通常 200 多台就是極限了 → 無法構造大型網路</li>
                                    <li>目前主要運用在 data center 的網路(封閉、同質性高)</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Network service model
                        <ul>
                            <li>in-order datagram delivery</li>
                            <li>guaranteed minimum bandwidth to flow</li>
                            <li>restrictions on changes in inter-packet spacing</li>
                            <li>在同一個 flow of datagrams 上可能因為中間的延遲…等等，封包間的間隔時間會變動 (jitter 抖動) → 網路如果使間隔時間改變是不行的，尤其對於影片和音樂等等，會跟著延遲</li>
                            <li>甚麼都沒有保證 → best effort <img src="https://i.imgur.com/43Ao3fd.png" alt=""></li>
                            <li>
                                ATM (Asynchronous transport mode)：他想提供一個有保證的網路，想取代原電信網路的 circuit switching → 並不通行
                                <ul>
                                    <li>UBR (Unspecified Bit Rate)：對傳輸速率沒有指定，但可靠性要求很高，即 Best Effort，用於局域網仿真(LAN Emulation)</li>
                                    <li>CBR (Constant Bit Rate)：有固定的帶寬(速率)要求，適用實時的話音和視頻信號傳輸</li>
                                    <li>ABR (Available Bit Rate)：只需指定峰值(Peak)和谷值(Minimum)信元速率，應用不多</li>
                                    <li>VBR (Variable Bit Rate)：允許隨時可變的帶寬，但必須指定峰值帶寬、最大突發數據長度和必須維持的最低速率(為了影片)</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Router-內部"><a class="anchor hidden-xs" href="#Router-內部" title="Router-內部"><span class="octicon octicon-link"></span></a>Router 內部</h3>
                <p><img src="https://i.imgur.com/yJIGQBY.png" alt=""></p>
                <ul>
                    <li>
                        <strong>Switch Fabric Capacity</strong>：bits per second (
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-58-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>b</mi><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-771" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-772" class="mjx-mrow"><span id="MJXc-Node-773" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-774" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-775" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi mathvariant="monospace">b</mi>
                                        <mi mathvariant="monospace">p</mi>
                                        <mi mathvariant="monospace">s</mi>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-58">\tt bps</script>
                        </span>
                        )
                        <ul>
                            <li>因為通常是 full duplex (雙向可同時進行)，所以通常實際上是他的 2 倍</li>
                            <li>線上能同時通過的最大資料量</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Forwarding Rate</strong>：packets per second (
                        <span class="mathjax">
                            <span class="MathJax_Preview" style="color: inherit;"></span>
                            <span id="MathJax-Element-59-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                <span id="MJXc-Node-776" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-777" class="mjx-mrow"><span id="MJXc-Node-778" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-779" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-780" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span>
                                <span class="MJX_Assistive_MathML" role="presentation">
                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                        <mi mathvariant="monospace">p</mi>
                                        <mi mathvariant="monospace">p</mi>
                                        <mi mathvariant="monospace">s</mi>
                                    </math>
                                </span>
                            </span>
                            <script type="math/tex" id="MathJax-Element-59">\tt pps</script>
                        </span>
                        )
                        <ul>
                            <li>在隨機封包大小下，他能做到的查表速度</li>
                        </ul>
                    </li>
                    <li>
                        在理想的情況下，是線的傳輸上限限制了速度(假設查表查很快的情況下)
                        <ul>
                            <li>但因為幾乎沒有廠商可以把路由器的查表做這麼快 → 路由器以 pps 記規格</li>
                            <li>故通常是查表速度影響整體速度 (查表所需的高速記憶體是非常貴的)</li>
                        </ul>
                    </li>
                    <li>
                        每個埠都有輸入和輸出的功能
                        <ul>
                            <li>十年前這些操作是做再輸入端 → input buffer</li>
                            <li>現今的都放在輸出端 → output buffer</li>
                            <li>每一代的技術都對應不同要求，視要求來選購</li>
                        </ul>
                    </li>
                    <li>
                        Input port functions <img src="https://i.imgur.com/8KwBOP4.png" alt="">
                        <ul>
                            <li>每個埠都有自己的表，好處是可以平行處理 (用空間很貴很快，換時間)</li>
                            <li>
                                destination-based forwarding：僅基於 dst IP 來 forward (traditional) <img src="https://i.imgur.com/C5tXJ5F.png" alt="">
                                <ul>
                                    <li>把同一個網段/區間當一個 entry 就可以省 2<sup>16</sup> (/16) 的空間 (不用每個IP都特別記) <img src="https://i.imgur.com/1C3ZZVl.png" alt=""></li>
                                    <li>Longest prefix matching (LPM)：最長配對，如果有多個都配對到，就送給 net mask 較大的 → 更明確的路由</li>
                                </ul>
                                <blockquote>
                                    <p>longest prefix matching: often performed using ternary content addressable memories (TCAMs)<br>
                                        content addressable: present address to TCAM: retrieve address in one clock cycle, regardless of table size<br>
                                        Cisco Catalyst: can up ~1M routing table entries in TCAM
                                    </p>
                                </blockquote>
                            </li>
                            <li>
                                generalized forwarding：用 header field values 來 forward
                                <ul>
                                    <li>每個 router 都有個 flow table 由一個大腦電腦來計算與給定</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>gateway 會定在路由器上或 L3 switch</li>
                    <li>有較多特殊功能：VPN、NAT</li>
                    <li>Routing table：Dst IP、mask、gateway、Interface (介面，要出去的出口)、meric (測量值，表示路徑遠近)</li>
                    <li>
                        自我學習 :
                        <ul>
                            <li>但是是藉由 spanning tree 演算法 (STP) 來算出節點間的距離</li>
                            <li>就是特地發封包，來更新 forwarding table</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Switching-fabrics-交換的方法"><a class="anchor hidden-xs" href="#Switching-fabrics-交換的方法" title="Switching-fabrics-交換的方法"><span class="octicon octicon-link"></span></a>Switching fabrics (交換的方法)</h4>
                <ul>
                    <li>
                        switching rate：pkts 從輸入端 → 輸出端的傳遞速率
                        <ul>
                            <li>通常以輸入/輸出的 line rate 的倍數來衡量</li>
                            <li>N inputs：switching rate N times line rate desirable</li>
                        </ul>
                    </li>
                    <li>三種類型：<img src="https://i.imgur.com/reShRqt.png" alt=""></li>
                    <li>
                        Memory：<img src="https://i.imgur.com/LpF9AV0.png" alt="">
                        <ul>
                            <li>用普通電腦的linux，轉 switch mode 就可以用了</li>
                            <li>把封包存在記憶體裡，然後用應用程式讀他，來決定要分給哪個介面，再從那裡送出去</li>
                            <li>需要寫一次、讀一次</li>
                            <li>會被記憶體侷限，適合每個埠頻寬小、總埠數少</li>
                        </ul>
                    </li>
                    <li>
                        Bus：
                        <ul>
                            <li>不要寫進記憶體哩，直接就從輸入介面到輸出介面 (by shared bus)</li>
                            <li>同一時間一條 bus 只能容納一個 pkt</li>
                            <li>被 bus bandwidth 侷限</li>
                        </ul>
                    </li>
                    <li>
                        Crossbar：
                        <ul>
                            <li>用多條 bus 平行使用，克服 bus bandwidth 的限制</li>
                            <li>會切成多個固定長度的 cell 來傳送，到輸出端再合起來</li>
                            <li>同時間有很多條路可以走，比較不會塞車</li>
                            <li>但到同一個輸出端一定會經過同一段 bus</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Queuing"><a class="anchor hidden-xs" href="#Queuing" title="Queuing"><span class="octicon octicon-link"></span></a>Queuing</h4>
                <ul>
                    <li>
                        <p>Input port queuing <img src="https://i.imgur.com/qioWsm8.png" alt=""></p>
                        <ul>
                            <li>在輸入端排隊，送到對的輸出端就送出去，但有 HOL 問題</li>
                            <li>Head-of-the-Line (HOL) blocking：沒辦法同時傳送兩個不同輸入的封包到相同輸出<br>
                                Ex. 下面的紅色就要等上面的紅色傳完才能繼續傳<br>
                                　 → 但如果一開始就送綠的，整體效率會比較好
                            </li>
                            <li>輸入端的 buffer 是 FIFO(最便宜)</li>
                            <li>效率低，所以現在很少人用輸入端來做交換</li>
                        </ul>
                    </li>
                    <li>
                        <p>Output port queuing <img src="https://i.imgur.com/pKCNL2z.png" alt=""></p>
                        <ul>
                            <li>先從輸入分到輸出，再在輸出端才排隊，buffer 放在輸出端 → 沒有浪費時間等待的問題</li>
                            <li>如果 buffer 沒有空位就會 drop，buffer 是用來接納突然的暴衝</li>
                            <li>如果 buffer 弄得很大的確可以容納較多封包，但 queuing delay 會變很大 (如果再加到更大就跟電腦沒甚麼差別了，不需要)</li>
                            <li><img src="https://i.imgur.com/IYB2XkE.png" alt=""></li>
                            <li>
                                buffering：當 datagrams 從 fabric 的速度大於傳出去的速度 (transmission rate) 就需要
                                <ul>
                                    <li>Datagram (packets) 會因為 congestion 而弄丟 → 稀少的 buffers</li>
                                </ul>
                            </li>
                            <li>
                                scheduling：有規則的選擇要傳哪個 queue 裡的 datagram
                                <ul>
                                    <li>達網路中立性 (network neutrality)</li>
                                </ul>
                            </li>
                            <li>
                                RFC 3439 rule of thumb: average buffering equal to “typical”RTT (say 250 msec) times link capacity C<br>
                                •e.g., C = 10 Gpbs link: 2.5 Gbit buffer<br>
                                recent recommendation: with Nflows, buffering equal to 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-60-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfrac><mrow><mi mathvariant=&quot;monospace&quot;>R</mi><mi mathvariant=&quot;monospace&quot;>T</mi><mi mathvariant=&quot;monospace&quot;>T</mi><mo>&amp;#x00D7;</mo><mi mathvariant=&quot;monospace&quot;>C</mi></mrow><mrow><msqrt><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>(</mo></msqrt><mi mathvariant=&quot;monospace&quot;>N</mi><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-781" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-782" class="mjx-mrow"><span id="MJXc-Node-783" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.176em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 3.078em; top: -1.275em;"><span id="MJXc-Node-784" class="mjx-mrow" style=""><span id="MJXc-Node-785" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-786" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-787" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span><span id="MJXc-Node-788" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-789" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">C</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 3.078em; bottom: -0.994em;"><span id="MJXc-Node-790" class="mjx-mrow" style=""><span id="MJXc-Node-791" class="mjx-msqrt"><span class="mjx-box" style="padding-top: 0.045em;"><span class="mjx-surd"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.501em; padding-bottom: 0.556em;">√</span></span><span class="mjx-box" style="padding-top: 0.075em; border-top: 1px solid;"><span id="MJXc-Node-792" class="mjx-mrow"><span id="MJXc-Node-793" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">(</span></span></span></span></span></span><span id="MJXc-Node-794" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">N</span></span><span id="MJXc-Node-795" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">)</span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 2.176em;"></span></span><span class="mjx-vsize" style="height: 1.604em; vertical-align: -0.703em;"></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mfrac>
                                                    <mrow>
                                                        <mi mathvariant="monospace">R</mi>
                                                        <mi mathvariant="monospace">T</mi>
                                                        <mi mathvariant="monospace">T</mi>
                                                        <mo>×</mo>
                                                        <mi mathvariant="monospace">C</mi>
                                                    </mrow>
                                                    <mrow>
                                                        <msqrt>
                                                            <mo mathvariant="monospace" stretchy="false">(</mo>
                                                        </msqrt>
                                                        <mi mathvariant="monospace">N</mi>
                                                        <mo mathvariant="monospace" stretchy="false">)</mo>
                                                    </mrow>
                                                </mfrac>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-60">\tt \frac{RTT\times C}{\sqrt(N)}</script>
                                </span>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>scheduling：choose next packet to send on link</p>
                        <ul>
                            <li>FIFO (first in first out) scheduling：一到達的順序送出，目前都是用這個，進不來的丟掉，便宜</li>
                            <li>
                                discard policy：封包到達一個滿的 queue，要怎麼決定要丟掉誰？
                                <ul>
                                    <li>tail drop：丟掉最後來的</li>
                                    <li>priority：依據 priority 高低來判斷</li>
                                    <li>random：隨機丟</li>
                                </ul>
                            </li>
                            <li>
                                priority scheduling：選擇優先度高的封包先送出 <img src="https://i.imgur.com/ALTl78B.png" alt=""><br>
                                <img src="https://i.imgur.com/7SgL04y.png" alt="">
                                <ul>
                                    <li>多種 class，每一種有不同的 priority，一個 class 一個 queue</li>
                                    <li>封包到了先以標頭裡的 class 記號分類</li>
                                    <li>高優先的封包還有就不會處理低優先的</li>
                                    <li>第二通行，沒其他那麼貴但又有功能</li>
                                    <li>題外話：<code>CPU schedualing 解決 starving → 如果在低優先度的佇列裡等太久都送不出去，就把它改成高優先，防止他永遠送不出去</code></li>
                                </ul>
                            </li>
                            <li>
                                Round Robin (RR) scheduling： <img src="https://i.imgur.com/qYkkcGA.png" alt="">
                                <ul>
                                    <li>多種 class，每一種有不同的 priority，一個 class 一個 queue</li>
                                    <li>有幾個 queue 就輪流每個 queue 取一個封包送</li>
                                    <li>較公平</li>
                                </ul>
                            </li>
                            <li>
                                Weighted Fair Queuing (WFQ)：有權重的 Round Robin <img src="https://i.imgur.com/c5wAGvj.png" alt="">
                                <ul>
                                    <li>每個 queue 分配不同大小的頻寬比重，依比重來分配</li>
                                    <li>要考慮封包數和封包內容大小</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="IP"><a class="anchor hidden-xs" href="#IP" title="IP"><span class="octicon octicon-link"></span></a>IP</h3>
                <ul>
                    <li>總覽 <img src="https://i.imgur.com/j9t5wqR.png" alt=""></li>
                    <li>
                        封包格式 <img src="https://i.imgur.com/5EOsxIH.png" alt="">
                        <ul>
                            <li><strong>Vers (version) :</strong> (4 bits) iPv?</li>
                            <li><strong>HLEN :</strong> (4 bits) header 總長 (in unit of 4 bytes)</li>
                            <li><strong>TOS (Type Of Service) :</strong></li>
                            <li>
                                <strong>Total Length :</strong> 16-bit, header + data of IP datagram. (? bytes)
                                <ul>
                                    <li>limits the datagram to at most 65535 bytes</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Flags :</strong> (3 bits)
                                <ul>
                                    <li>bit 0 : 保留未定義</li>
                                    <li>bit 1 : Don’t Fragment (DF) ? 1 : 0</li>
                                    <li>bit 2 : More Fragment (MF) ? 1 : 0</li>
                                </ul>
                            </li>
                            <li><strong>Fragment offset :</strong> (13 bits) 在原封包中的位移量，以byte為單位</li>
                            <li><strong>Time to Live (TTL) :</strong> (8 bits) 預設 64 hops，遇到一個路由器就減一</li>
                            <li><strong>Upper layer</strong>：寫接下來跟的是 TCP、UDP、ICMP…等等的 header</li>
                            <li><strong>Header Checksum :</strong> (16 bits) error (corruption) detection method</li>
                            <li>每個 router 上都有一個 forwarding table，到每一站都要找路，source host 無法決定走哪條路到達目的地，由網路層自行決定怎麼走。 (如果中間有掛掉，會自己換條路走，較優)</li>
                            <li>除非使用 option 中的 source routing (分兩種)，source host可以決定， 循著已寫好的路走，可以 1.寫死 2.指定必經的某幾點，其他隨意。 (缺點是寫好的 router 掛掉，路會不通)</li>
                        </ul>
                    </li>
                    <li>
                        IP fragmentation, reassembly <img src="https://i.imgur.com/OvZoiRe.png" alt=""><br>
                        <img src="https://i.imgur.com/6LlHiX0.png" alt="">
                        <ul>
                            <li>
                                <p>藍色是 header、紅色是 data</p>
                            </li>
                            <li>
                                <p>link 上 MTU(max. transfer size) 的大小設定</p>
                                <ul>
                                    <li>太大：整個頻寬都被占</li>
                                    <li>太小：header overhead，標頭占整個封包比太大，浪費頻寬</li>
                                </ul>
                            </li>
                            <li>
                                <p>從大 MTU 走到小 MTU 的 link：就要把封包切塊</p>
                                <ul>
                                    <li>每個分割包可能會走不同的路，都到達目的地才會再組合起來</li>
                                    <li>切完之後在 IP 標頭裡 fragment offset 裡改成它的分割的編號</li>
                                    <li>從 0 開始數，第二包編號為第一個 byte 在原封包的第幾 byte 在除以 8 (只算資料部分，不算標頭)</li>
                                    <li>也會在裡面表示<strong>此分割包後面是否還有分割包</strong> → <code>fragflag == 1 ? 有 : 無</code></li>
                                </ul>
                            </li>
                            <li>
                                <p>封包分割範例分析 <img src="https://i.imgur.com/5OTwH9t.png" alt=""></p>
                                <ul>
                                    <li>原本 4000 → data 3980，扣掉 header 20 bytes</li>
                                    <li>1500 → data 1480、offset = 0、fragflag = 1</li>
                                    <li>1500 → data 1480、offset = 1480 / 8 = 185、fragflag = 1</li>
                                    <li>data 剩 3980 - 1480 * 2 = 1020 → + 20 = 1040 總長、 offset = 2960 / 8 = 370、fragflag = 0</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h4 id="IP-addressing-introduction"><a class="anchor hidden-xs" href="#IP-addressing-introduction" title="IP-addressing-introduction"><span class="octicon octicon-link"></span></a>IP addressing: introduction</h4>
                <ul>
                    <li>
                        <p>interface (介面)：用來連接 host/router/physical link，L3 的介面才會有 IP(或是 HOST)</p>
                        <ul>
                            <li>router 通常有多個 interfaces</li>
                            <li>host 通常有 1 個 或 2 個 interfaces (例如：有限的 Ethernet、無限網路 802.11)</li>
                            <li><img src="https://i.imgur.com/ibtpiOg.png" alt=""></li>
                            <li>switch的port沒有 IP adress， blue tooth 也沒有</li>
                        </ul>
                    </li>
                    <li>
                        <p>Subnets：<br>
                            <img src="https://i.imgur.com/GSdXfmc.png" alt="">
                        </p>
                    </li>
                    <li>
                        <p>32-bit IP address</p>
                        <ul>
                            <li>
                                <p>classful 看前幾個 bit 就可以知道他是哪個 class</p>
                                <ul>
                                    <li>class A：/8</li>
                                    <li>class B：/16</li>
                                    <li>class C：/24<br>
                                        <img src="https://i.imgur.com/91anu0w.png" alt="">
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p>CIDR (Classless InterDomain Routing)：</p>
                                <ul>
                                    <li>/XX 可以不是 8 的倍數，可依需求切網段</li>
                                    <li>adress format : a.b.c.d/x</li>
                                    <li><img src="https://i.imgur.com/t1vvb4K.png" alt=""></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>broadcast：在自己的 LAN 廣播、傳到遠端的 LAN 廣播</p>
                    </li>
                    <li>
                        <p>網路遮罩 netmask :</p>
                        <ul>
                            <li>IP AND mask 得到網路位址 → <strong>網路位址相同才算在同一個LAN</strong></li>
                            <li>192.168.2.3/24 → 24 叫 prefix</li>
                            <li>192.168.2.3/11111111.11111111.11111111.00000000 → 遮罩有 24 個 1 所以寫 24</li>
                            <li>192.168.2 裡共有253個IP</li>
                        </ul>
                    </li>
                    <li>
                        <p>子網路分割 subnetting :</p>
                        <ul>
                            <li>ClassC：平時前 24bit 是網路位址, 後 8bit 是主機位址 -&gt; 遮罩(mask) 255.255.255.0</li>
                            <li>調整幾個 bit 的 networkID 來調整控制一網段下幾台電腦，用 /num 來表示拿幾 bit 來當 nwid</li>
                            <li>192.168.2.3/27 -&gt; (24+3) bit -&gt; 8 subnet, 32 Host<br>
                                <img src="https://i.imgur.com/KxF1nc0.jpg" alt="">
                            </li>
                            <li>對 subnet 總 IP 數要扣掉 <strong>網路位址(第一個 IP)</strong> 和 <strong>廣播位址(最後一個 IP)</strong>，共2個</li>
                            <li>對可用 HostIP 要扣掉一個選出來的 Default Gatewy Address</li>
                        </ul>
                    </li>
                    <li>
                        <p>supernetting : 把網路合併，使 prefix 變小即可</p>
                    </li>
                    <li>
                        <p>gateway</p>
                        <ul>
                            <li>發現目的地 IP 不在自己所在的 LAN 裡面時(用遮罩 and 看看)，就送到 gateway</li>
                            <li>if ip 遮罩(EX. 設/24但應是/25)亂設，別的LAN裡的電腦傳給你然後要回覆的時候，會因為自己以為對方在自己 LAN 裡就直接 ARP，想要直接用 mac 對傳，而不是送去他所在的 LAN 所以送不回去</li>
                            <li>if /25 第一個IP會是128，通常第一個和最後一個IP不會用，然後gateway會是第一個可以用的或最後可用的 → .129 / .254</li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Dynamic-Host-Configuration-Protocol-DHCP"><a class="anchor hidden-xs" href="#Dynamic-Host-Configuration-Protocol-DHCP" title="Dynamic-Host-Configuration-Protocol-DHCP"><span class="octicon octicon-link"></span></a>Dynamic Host Configuration Protocol (DHCP)</h3>
                <ul>
                    <li>
                        <p>Before DHCP (DHCP → extension of BOOTP)</p>
                        <ul>
                            <li>手動分配</li>
                            <li>Reverse ARP (RARP) → 過時，將 IP 分給 MAC</li>
                            <li>BOOTstrap Protocol (BOOTP) → 通常是靜態的，較少與IP相關的配置</li>
                        </ul>
                    </li>
                    <li>
                        <p>動態分配IP，也有提供靜態的。任何連到這個網路的裝置就能得到網路相關資訊，適用 UDP 的實作</p>
                        <ul>
                            <li>有時效性</li>
                            <li>同一個IP adress過期後，如果沒有reuse，會給別人用</li>
                            <li>缺點:兩個users用同一個IP adress?? ack送得出去，卻收不到回復(可能回錯)</li>
                        </ul>
                    </li>
                    <li>
                        <p>可以用 relay agent 來服務其他 LAN 的電腦，就不用每個 LAN 都架一個 DHCP server<br>
                            <img src="https://i.imgur.com/7jUNSHQ.png" alt="">
                        </p>
                        <ul>
                            <li>要動態取得的功能，此網路上必定要有DHCP server</li>
                        </ul>
                    </li>
                    <li>
                        <p>過程：</p>
                        <ul>
                            <li>host → broadcasts <strong>DHCP discover</strong> msg [optional] (UDP port 68)</li>
                            <li>DHCP server → responds with <strong>DHCP offer</strong> msg [optional] (UDP port 67)</li>
                            <li>host → requests IP address：<strong>DHCP request</strong> msg (UDP port 68)</li>
                            <li>DHCP server → sends address：<strong>DHCP ack</strong> msg (UDP port 67)</li>
                        </ul>
                        <p><img src="https://i.imgur.com/7GMpCEL.png" alt=""></p>
                    </li>
                    <li>
                        <p>細節：</p>
                        <ul>
                            <li>外面包的是 UDP，廣播的時候是用 L2 的 FF:FF:FF:FF:FF:FF (MAC)</li>
                            <li>DHCP 回傳時可不只 allocated IP，還可包括 gateway IP、DNS sever IP、network mask</li>
                            <li>DHCP request 依序封裝 (encapsulated) 在 UDP → IP → 802.1 Ethernet 裡 <img src="https://i.imgur.com/Rux7DOH.png" alt=""></li>
                        </ul>
                    </li>
                    <li>
                        <p>範例 <img src="https://i.imgur.com/RgV6U70.png" alt=""></p>
                    </li>
                    <li>
                        <p>IP adresses : how to get one? <img src="https://i.imgur.com/nbeIqNZ.png" alt=""></p>
                    </li>
                    <li>
                        <p>Hierarchical addressing<br>
                            <img src="https://i.imgur.com/oeMxmzF.png" alt="">
                        </p>
                        <ul>
                            <li>
                                <p>Route Aggregation 聚合：if 在自己階層下的目的地(網段)，會把所有網段合併(if has auto summention)，跟外面講都送來我這 → 收縮到同一團</p>
                            </li>
                            <li>
                                <p>奇怪的特例：<img src="https://i.imgur.com/i6P8ou6.png" alt=""></p>
                                <ul>
                                    <li>要把特例告訴別人，但會使 routing table 裡面變較多</li>
                                    <li>∵ 路由用 longest prefix matching (LPM) 就能把封包送到那個特例</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>好處：不需人力，自動完成，好管理 (網管看紀錄就甚麼都知道了)，支援攜帶性裝置</p>
                    </li>
                    <li>
                        <p><img src="https://i.imgur.com/0K5lTCl.png" alt=""></p>
                    </li>
                    <li>
                        <p>Lease Renewal Times <img src="https://i.imgur.com/7OVUMKT.png" alt=""></p>
                        <ul>
                            <li>
                                T1 &lt; T2 &lt; Lease time
                                <ul>
                                    <li>T1 default value = 1/2 of lease time</li>
                                    <li>T2 default value = 7/8 of lease time</li>
                                </ul>
                            </li>
                            <li>
                                Communicated via DHCPOFFER, DHCPACK
                                <ul>
                                    <li>Client actions when times elapse</li>
                                    <li>T1: client must renew address with the DHCP server</li>
                                    <li>T2: client must renew address with any DHCP server</li>
                                    <li>Lease time：client must stop using IP address</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>DHCP Relay</p>
                        <ul>
                            <li><img src="https://i.imgur.com/2YnH0Jb.png" alt=""></li>
                            <li>中間的路由器要 config 讓 DHCP 的廣播可以過去另一邊</li>
                        </ul>
                        <ol>
                            <li>DHCP client 在 local link 上廣播</li>
                            <li>
                                DHCP Relay Agent 收到然後 unicasts 他收到的訊息給 DHCP servers
                                <ul>
                                    <li>Stores (fakes) 他自己的 IP address 在 DHCP 封包裡的 GIADDR</li>
                                </ul>
                            </li>
                            <li>
                                DHCP server 利用 GIADDR-value
                                <ul>
                                    <li>辨認送出來的封包是在哪個子網段，再依子網段分配 IP</li>
                                    <li>用 unicast 回覆給 GIADDR-address</li>
                                </ul>
                            </li>
                            <li>DHCP Relay Agent 再把回應回給原本發送的裝置</li>
                            <li>DHCP Client 收到被分配的 IP，不知道中間有一個 Relay</li>
                        </ol>
                    </li>
                </ul>
                <h3 id="Network-Address-Translation-NAT"><a class="anchor hidden-xs" href="#Network-Address-Translation-NAT" title="Network-Address-Translation-NAT"><span class="octicon octicon-link"></span></a>Network Address Translation (NAT)</h3>
                <ul>
                    <li>
                        <p>把 prtivate IP 轉成外部的 IP，用註冊過的 IP 放外面來跟外部溝通(裡面的外面是連不到) <img src="https://i.imgur.com/Zw2ELvV.png" alt=""></p>
                        <ul>
                            <li>內部網路不需要知道 NAT，外面也不用知道裡面就可以運作，內部自己獨立，還有安全，外面怎麼換都沒關係，這樣就可以減少 IP 的消耗</li>
                            <li>註：IPv6 本來是為解決 IP 不夠用的問題，用 128 bits</li>
                        </ul>
                    </li>
                    <li>
                        <p>NAT router 上實作：<img src="https://i.imgur.com/13veEZv.png" alt=""></p>
                        <ul>
                            <li>NAT translation table：記住每個 src IP、port # 對應的 NAT IP、new port #</li>
                            <li>出去的 datagrams：src IP、port # → NAT IP、new port #，對方會以收到的 IP 來回覆</li>
                            <li>進來的 datagrams：dst NAT IP、new port # → src IP、port #</li>
                            <li>可能對外只有一 IP，那轉進來就看 NAT 怎麼分配，裡面哪台壞了都跟外面沒關係</li>
                            <li>把自己切成 inside (loacl IP) 和 outside (global IP) 兩部分</li>
                            <li>可以 statical config，也可以 dynamical 有連線再分配給你，還有防火牆的功能</li>
                        </ul>
                    </li>
                    <li>
                        <p>NAT overload</p>
                        <ul>
                            <li>用 Network Address Port Translation (NAPT) 或 Port Address Translation (PAT) 來完成 <img src="https://i.imgur.com/jkQorjB.png" alt=""></li>
                            <li>把多個沒註冊的 IP，對應到一個有註冊的 IP (多對一)</li>
                            <li>NAPT：包含 IP、protocal、port</li>
                            <li>fi-tuple：兩IP、兩port、一protcal，這樣就可以獨一無二的建造一個資料流(flow)</li>
                        </ul>
                    </li>
                    <li>
                        <p>Dynamic NAT 和 NAT Overload 都是動態對應</p>
                        <ul>
                            <li>Dynamic NAT 是 one-to-one，NAT Overload 是 many-to-one.</li>
                        </ul>
                    </li>
                    <li>
                        <p>port reserving：不改變你的 port，那別的 IP 的對應這個 port 的對應表就會把它對應到別的埠上去</p>
                    </li>
                    <li>
                        <p>Source NAT (SNAT)：在決定 routing <strong>之後</strong>執行</p>
                        <ul>
                            <li>改變 Src IP，dst IP 不變 → 讓裡面連去外面</li>
                        </ul>
                    </li>
                    <li>
                        <p>Destination NAT (DNAT)：在決定 routing <strong>之前</strong>執行</p>
                        <ul>
                            <li>改變 dst IP，src IP 不變 → 讓外面連到裡面</li>
                            <li>port forwarding：把裡面對外面的 IP 的不同 port 對應到內部不同的 IP</li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Routing-Protocol-amp-Static-Route"><a class="anchor hidden-xs" href="#Routing-Protocol-amp-Static-Route" title="Routing-Protocol-amp-Static-Route"><span class="octicon octicon-link"></span></a>Routing Protocol &amp; Static Route</h3>
                <ul>
                    <li>
                        routing algorithm + forwarding table
                        <ul>
                            <li>用演算法算出把下一步 (out port) 放在表裡</li>
                        </ul>
                    </li>
                    <li>
                        Destination Based Route ←→ Policy based 另外寫規則，可依 IP 以外的東西
                        <ul>
                            <li>Next-hop Routing：只存 <strong>addr of next hop</strong>，而不是完整的路由</li>
                            <li>Network-Specific Routing：存 <strong>netid</strong> 而不是 <strong>hostid</strong> (減少 entry 數)</li>
                            <li>
                                Host-Specific Routing :
                                <ul>
                                    <li>儲存 <strong>destinㄚation host address</strong></li>
                                    <li>可以有較多的控制(為了安全等等)</li>
                                    <li>雖然效率降低，但有更多優點</li>
                                </ul>
                            </li>
                            <li>Default Routing：都找不到時就往那邊丟</li>
                        </ul>
                    </li>
                    <li>
                        Inter &amp; Interdomain routing <img src="https://i.imgur.com/bOPHSVr.png" alt="">
                        <ul>
                            <li>
                                Autonomous system (AS)：
                                <ul>
                                    <li>網際網路分成多個 AS，連線到國際的話，AS 要是唯一的，要申請</li>
                                </ul>
                            </li>
                            <li>Intra-domain (AS) routing：AS 裡的路由 → Interior Gateway Protocol (IGP)</li>
                            <li>Inter-domain (AS) routing：AS 間的路由 → Exterior Gateway Protocol (EGP)</li>
                        </ul>
                    </li>
                    <li>
                        Network Routing Entries <img src="https://i.imgur.com/hDeFnjf.png" alt="">
                        <ul>
                            <li>
                                administrative distance (AD)：Cisco 裡將不同的路由協定給一個數值
                                <ul>
                                    <li>AD 數值表現路由協定 “trustworthiness”，越低越好</li>
                                    <li>
                                        如果到同一 dst 有兩種協定的路由，選 AD 較小的那一條
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th style="text-align:left">Route Source</th>
                                                    <th style="text-align:center">Administrative Distance</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td style="text-align:left">Connected</td>
                                                    <td style="text-align:center">0</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">Static</td>
                                                    <td style="text-align:center">1</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">EIGRP summary route</td>
                                                    <td style="text-align:center">5</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">External BGP</td>
                                                    <td style="text-align:center">20</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">Internal EIGRP</td>
                                                    <td style="text-align:center">90</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">IGRP</td>
                                                    <td style="text-align:center">100</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">OSPF</td>
                                                    <td style="text-align:center">110</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">RIP</td>
                                                    <td style="text-align:center">120</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">External EIGRP</td>
                                                    <td style="text-align:center">170</td>
                                                </tr>
                                                <tr>
                                                    <td style="text-align:left">Internal BGP</td>
                                                    <td style="text-align:center">200</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </li>
                                </ul>
                            </li>
                            <li>metric 也是越低越好</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Dijkstra’s-algorithm-Link-State"><a class="anchor hidden-xs" href="#Dijkstra’s-algorithm-Link-State" title="Dijkstra’s-algorithm-Link-State"><span class="octicon octicon-link"></span></a>Dijkstra’s algorithm (Link State)</h4>
                <ul>
                    <li>讓每個router都有整個網路的拓譜資訊(net topology) ，收到每個node的相鄰資訊</li>
                    <li>
                        notation:
                        <ul>
                            <li>c(x, y)：x 到 y 的花費，如果不相鄰就 = ∞</li>
                            <li>D(v)：目前從 src 到 v (dst) 的最小花費</li>
                            <li>p(v)：目前從 src 到 v (dst) 的最小花費的路徑裡，v 的 predecessor</li>
                            <li>N’：包含所有已知有有限的最短路徑的點集合</li>
                        </ul>
                    </li>
                    <li>
                        演算法 <img src="https://i.imgur.com/1Bp8PZF.png" alt="">
                        <ul>
                            <li>先找沒被走過中擁有最小的邊的其中一端點，加入 N’</li>
                            <li>取出所有連接此點的邊更新他們之間的距離，並拿出這些之中最小的邊(選擇走他)</li>
                            <li>將被選擇的點再加入 N’，繼續更新他相鄰的邊，如果相鄰點的原本的距離比此點加上此邊的距離還常的話就更新他</li>
                            <li>直到所有點都在 N’ 為止<br>
                                <img src="https://i.imgur.com/i3rygLC.png" alt="">
                            </li>
                            <li>iterative：經過 k 次迭代，知道到達 k 目標的最小成本路徑</li>
                        </ul>
                    </li>
                    <li>
                        複雜度：n 節點
                        <ul>
                            <li>每次 iteration：需要檢查所有不在 N’ 裡的點</li>
                            <li>n(n+1)/2 次比較：O(n<sup>2</sup>)</li>
                            <li>較有效率的實作：O(nlogn)</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Distance-vector-algorithm-Bellman-Ford"><a class="anchor hidden-xs" href="#Distance-vector-algorithm-Bellman-Ford" title="Distance-vector-algorithm-Bellman-Ford"><span class="octicon octicon-link"></span></a>Distance vector algorithm (Bellman-Ford)</h4>
                <ul>
                    <li>
                        <p>d<sub>x</sub>(y) := x 能到達 y 的最小成本 <img src="https://i.imgur.com/UfNKIEz.png" alt=""></p>
                        <ul>
                            <li>Ex. du(z) = min { c(u,v) + dv(z), c(u,x) + dx(z), c(u,w) + dw(z) }</li>
                            <li>Dx(y)= estimate of least cost from x to y</li>
                            <li>x maintains distance vector Dx= [Dx(y) : y є N]</li>
                        </ul>
                    </li>
                    <li>
                        <p>流程<br>
                            <img src="https://i.imgur.com/xzmxWyx.png" alt="">
                        </p>
                        <ul>
                            <li>一開始的 table 只知道到隔壁要多少</li>
                            <li>每個點都要週期性把自己的資訊告訴隔壁，也會收到隔壁傳來的資訊</li>
                            <li>如果有更改就看有無需要更新，若有更新就馬上把更新完的資訊傳給鄰居</li>
                            <li>每個 local iteration 起因為來自鄰居的 local link cost change DV update message</li>
                            <li>
                                distributed：(分散、去中心化)
                                <ul>
                                    <li>每個節點僅在其DV變化時通知鄰居</li>
                                    <li>鄰居然後在必要時通知鄰居</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>link cost changes：</p>
                        <ul>
                            <li>節點偵測到 local link 花費變了，就更新並告訴鄰居</li>
                            <li>鄰居收到新的資訊，如果 DV 更改，也告訴鄰居</li>
                            <li><strong>good news travels fast</strong> <img src="https://i.imgur.com/Z8wZSjl.png" alt=""></li>
                            <li>
                                <strong>bad news travels slow</strong> → “count to infinity” problem！ <img src="https://i.imgur.com/Zhb96F5.png" alt="">
                                <ul>
                                    <li>44 iterations before algorithm stabilizes</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>舉例：<img src="https://i.imgur.com/z4MFKdD.png" alt=""></p>
                    </li>
                    <li>
                        <p>算法收斂所需的最大迭代次數可以計算如下：在每次迭代中，網絡中的節點將與其鄰居交換距離表的信息。</p>
                        <ul>
                            <li>
                                在第一次迭代之後，到當前節點的所有相鄰節點將知道到當前節點的最短路徑成本
                                <ul>
                                    <li>有 X、Y 兩節點，它們是鄰居</li>
                                    <li>然後，在第一次迭代之後，Y 的所有鄰居都會知道到節點 X 的最短路徑成本</li>
                                </ul>
                            </li>
                            <li>假設d（網絡直徑）是最長路徑的長度，並且網絡中<strong>任何兩個節點之間都沒有迴路</strong></li>
                            <li>根據上述類比，執行d-1迭代後，所有節點都將了解到d到所有其他節點的最短路徑成本</li>
                            <li>如果路徑長度大於d跳，則路徑包含循環。循環的刪除將算法結果最多收斂到d-1次迭代</li>
                            <li>跳數大於d的任何路徑都由循環組成，這些循環導致算法的結果最多收斂d-1個迭代。因此，距離向量算法的結果最多收斂d-1次迭代</li>
                        </ul>
                    </li>
                </ul>
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th>LS</th>
                            <th>DV</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>複雜度</td>
                            <td>每個節點都必須知道網路中所有連結的成本</td>
                            <td>只須跟相鄰的節點交換訊息</td>
                        </tr>
                        <tr>
                            <td>收斂速度</td>
                            <td>
                                實作是一個
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-61-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>|</mo><mi>N</mi><msup><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>|</mo><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-796" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-797" class="mjx-mrow"><span id="MJXc-Node-798" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.279em;">O</span></span><span id="MJXc-Node-799" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-800" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span><span id="MJXc-Node-801" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-802" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-803" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-804" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.39em; padding-bottom: 0.335em;">2</span></span></span></span><span id="MJXc-Node-805" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>O</mi>
                                                <mo stretchy="false">(</mo>
                                                <mo fence="false" stretchy="false">|</mo>
                                                <mi>N</mi>
                                                <msup>
                                                    <mo fence="false" stretchy="false">|</mo>
                                                    <mn>2</mn>
                                                </msup>
                                                <mo stretchy="false">)</mo>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-61">O(\vert N\vert^2)</script>
                                </span>
                                ，需要
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-62-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>|</mo><mi>N</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>|</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>|</mo><mi>E</mi><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>|</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-806" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-807" class="mjx-mrow"><span id="MJXc-Node-808" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.279em;">O</span></span><span id="MJXc-Node-809" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">(</span></span><span id="MJXc-Node-810" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span><span id="MJXc-Node-811" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-812" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span><span id="MJXc-Node-813" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span><span id="MJXc-Node-814" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.445em; padding-bottom: 0.279em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-815" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">|</span></span><span id="MJXc-Node-816" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.611em;">)</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi>O</mi>
                                                <mo stretchy="false">(</mo>
                                                <mo fence="false" stretchy="false">|</mo>
                                                <mi>N</mi>
                                                <mo fence="false" stretchy="false">|</mo>
                                                <mo fence="false" stretchy="false">|</mo>
                                                <mi>E</mi>
                                                <mo fence="false" stretchy="false">|</mo>
                                                <mo stretchy="false">)</mo>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-62">O(\vert N\vert \vert E\vert)</script>
                                </span>
                                比訊息
                            </td>
                            <td>若最長 hop 為 d，總迭代數需 d-1</td>
                        </tr>
                    </tbody>
                </table>
                <h4 id="Routing-Information-Protocol-RIP"><a class="anchor hidden-xs" href="#Routing-Information-Protocol-RIP" title="Routing-Information-Protocol-RIP"><span class="octicon octicon-link"></span></a>Routing Information Protocol (RIP)</h4>
                <ul>
                    <li>RIP 採用 Distance Vector ，以 hop 數來做為距離的判斷</li>
                    <li>缺點：如果有迴圈的話，他只會選比較 hop count 少的來決定，不會以速度來決定(不看 cost)</li>
                </ul>
                <h4 id="OSPF-Open-Shortest-Path-First"><a class="anchor hidden-xs" href="#OSPF-Open-Shortest-Path-First" title="OSPF-Open-Shortest-Path-First"><span class="octicon octicon-link"></span></a>OSPF (Open Shortest Path First)</h4>
                <ul>
                    <li>切多個區域，每個區域都有不同的規則 → 難</li>
                    <li>
                        Singal area：所有區域都一樣且都是0
                        <ol>
                            <li>Establish Neighbor Adjacencies</li>
                            <li>Exchange Link-State Advertisements (LSA)</li>
                            <li>Build the Topology Table</li>
                            <li>Execute the SPF Algorithm</li>
                            <li>Modify the routing table</li>
                        </ol>
                    </li>
                    <li>
                        封包格式：<img src="https://i.imgur.com/mtbL55t.png" alt="">
                        <ol>
                            <li>放 Dst multicast 所有的 MAC 之一</li>
                            <li>IPv4 dst address 包含 protocol 變數 → OSPF 為 89</li>
                            <li>標示 OSPF pkt type、router ID (用來表示不同的路由器，盡量先設，因為開啟的時候就會把它廣播出去，太晚設他就不會廣播出去)、area ID (分區塊進行)</li>
                            <li>依不同的類型放不同的內容</li>
                        </ol>
                    </li>
                    <li>
                        5 種封包
                        <ol>
                            <li>Hello pkt：用於與其他 OSPF 路由器建立和維護鄰居關係</li>
                            <li>
                                Database Descriptor (DBD) pkt
                                <ul>
                                    <li>包含送端路由器的 Link-State Database（LSDB）的縮寫列表</li>
                                    <li>給收端路由器來檢查日期數據庫同步</li>
                                    <li>內容包含：Link type、advertising router 的地址、Link’s cost、Sequence #</li>
                                </ul>
                            </li>
                            <li>Link-State Request (LSR) pkt：用來請求有關 DBD 中任何條目的更多信息</li>
                            <li>Link-State Update (LSU) pkt：用於答复 LSR 和宣布新信息</li>
                            <li>Link-State Acknowledgment (LSAck) pkt：路由器發送以確認收到 LSU</li>
                        </ol>
                    </li>
                    <li>
                        OSPF 會經過許多狀態以達收斂：
                        <ul>
                            <li>Down → Init state：發 Hello 封包到所有有 OSPF 介面出去</li>
                            <li>Init state：如果收到不是鄰居的 Hello 封包，就將她加入鄰居行列</li>
                            <li>Two-Way state：如果收到鄰居的 Hello 封包，就進入此狀態，然後開始交換其他四種封包來達成 synchronizing DBs</li>
                            <li>ExStart state：兩相鄰路由器會決定誰要先發 DBD 封包，ID 高的先發(僅決定順序)</li>
                            <li>Exchange state：依決定的順序互相發 DBD</li>
                            <li>Loading state：如果收到較新的 DBD，進入此狀態</li>
                            <li>Full state：全部完成</li>
                        </ul>
                    </li>
                    <li>
                        Designate Router (DR) &amp; Backup Designate Router (BDR)
                        <ul>
                            <li>DR election：依 priority、router ID 來決定高下</li>
                            <li>
                                擁有最高 priority 會當選 DR：為 0 – 255、預設 = 1、如果 = 0 代表不參選
                                <ul>
                                    <li>如果平手就是 ID 大的當選 (在每個介面上可能扮演不一樣的角色)</li>
                                </ul>
                            </li>
                            <li>BDR 就是 DR 以外選出來最好的那個</li>
                            <li>路由連到交換時，介面鄰居會變多個</li>
                            <li>DR 掛了之後，先讓 BDR 頂替，剩下的在選一個 BDR，再跟 DR 比一次，選出真正的 DR</li>
                            <li>pre-emptive (先發制人)：就比較容易當選，要另外開啟</li>
                        </ul>
                    </li>
                    <li>
                        Loopback Interface
                        <ul>
                            <li>永遠都會啟動的介面</li>
                            <li>用來連他自己、讓與介面連接的裝置能連到他</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Static-route-amp-Default-route"><a class="anchor hidden-xs" href="#Static-route-amp-Default-route" title="Static-route-amp-Default-route"><span class="octicon octicon-link"></span></a>Static route &amp; Default route</h4>
                <ul>
                    <li>
                        沒有直接連上又沒有其他路由協定時，就要設 statcic route 才會通，2 種設法：
                        <ol>
                            <li>接 IP：就是下一個 HOP 的 IP</li>
                            <li>接介面：就是要出去的介面</li>
                        </ol>
                        <ul>
                            <li>如果同一條兩種都下時，就會把兩個合併起來</li>
                            <li>
                                差異就是 routing table 會搜尋幾次
                                <ul>
                                    <li>接 IP 就會先拿到 IP，再去搜尋這個 IP 要從哪個介面出去，共 2 次</li>
                                    <li>接介面就直接可以出去，共 1 次</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        如果路由器只有唯一的出口(接路由器)，或者出口接很少，就直接設定 static route 就不用花時間跑 table (孤獨的網路，出去如果是國際的就不行這樣設)
                        <ul>
                            <li>Summary Static Route： static 和學習的一起用</li>
                            <li>Floating Static Route：當 static  壞掉時就用學習到的那一個</li>
                        </ul>
                    </li>
                    <li>
                        routing table
                        <ul>
                            <li>S：手設的路由</li>
                            <li>C：顯示自己連到的地方(自己所在子往段)</li>
                            <li>L：顯示自己這台的 IP</li>
                        </ul>
                    </li>
                    <li>default route：static route 為 0.0.0.0/0，不管是誰都會被 match 到</li>
                </ul>
                <h3 id="Access-Control-List-ACL"><a class="anchor hidden-xs" href="#Access-Control-List-ACL" title="Access-Control-List-ACL"><span class="octicon octicon-link"></span></a>Access Control List (ACL)</h3>
                <ul>
                    <li>
                        Wildcard Masking：把整個網段直接全部(擋掉 / 通過)
                        <ul>
                            <li>0：<strong>Match</strong> 對應地址同位置的 bit</li>
                            <li>1：<strong>Ignore</strong> 對應地址同位置的 bit</li>
                            <li>若要擋奇數的IP → deny x.x.x.1 0.0.0.254 → 0.0.0.11111110</li>
                            <li>any 就是除了有規定的 IP 之外所有其他 IP</li>
                        </ul>
                    </li>
                    <li>Inbound ACL：ACL 會發生在查 routing table 之前 (過濾要進來的封包)</li>
                    <li>Outbound ACL：已經查過 routing table 之後再決定要不要送 (過濾要出去進來的封包)</li>
                    <li>按照條目順序比對，比對到了就執行</li>
                    <li>
                        Standard ACL 大多用這個，1-100、1300-1999
                        <ul>
                            <li>只看 src ip，放在離 dst 近的地方</li>
                            <li>若放在離 src 近的地方，會導致他無法達到其他網段</li>
                        </ul>
                    </li>
                    <li>
                        Extended ACL 進階ACL，101-199、2000-2699
                        <ul>
                            <li>可以過濾 src、dst、協定種類、在哪個 port 上</li>
                            <li>established : 新進的不讓進，以前進過的就在讓她進</li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Simple-Network-Management-Protocol"><a class="anchor hidden-xs" href="#Simple-Network-Management-Protocol" title="Simple-Network-Management-Protocol"><span class="octicon octicon-link"></span></a>Simple Network Management Protocol</h3>
                <ul>
                    <li>預防勝於治療，五大需求(FCAPS)：Fault-management、Configuration、Accounting、Performance、Security</li>
                    <li>於應用層的 protocal (RFC 1157)，主要拿來管理網路設備 <img src="https://i.imgur.com/NVeO0Dr.png" alt=""></li>
                    <li>Network Management Stations (NMS)：用來管理的軟體，稱 SNMP Collector、Manager</li>
                    <li>
                        Network Elements：扮演管理者、被管的網路設備
                        <ul>
                            <li>
                                Management Agents (SNMP Manager)
                                <ul>
                                    <li>可以執行 NMS 的命令，讓他去跟 agent 要，再由她回 MIB</li>
                                    <li>可以用 “get” 來收集 SNMP agent 的資訊</li>
                                    <li>可以用 “set” 來在 agent 上交換 configuration</li>
                                    <li>SNMPv2c：可用 “GetNext” 來問下一個資訊</li>
                                </ul>
                            </li>
                            <li>
                                SNMP Agents
                                <ul>
                                    <li>若 manager 用 “traps”，可設定條件，滿足後就自動回報，就不用等他來問 → 減少處於 boring 的狀態</li>
                                    <li>SNMPv2c：可用 “Inform” 來發送 ACK 給 SNMP Manager</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        SNMP Protocol<br>
                        <img src="https://i.imgur.com/dxWVEGR.png" alt="">
                        <ul>
                            <li>定義如何於 SNMP Manager 和 Agents 間交換管理的資訊，不負責解讀 MIB 的資訊</li>
                            <li>SNMP Manager → SNMP Agents：<strong>UDP port 161</strong></li>
                            <li>SNMP Agents → SNMP Manager：<strong>UDP port 162</strong></li>
                        </ul>
                    </li>
                    <li>
                        Management Information Base (MIB)：需另外用軟體去解讀
                        <ul>
                            <li>儲存有關裝置的資料、operational statistics、user authentication</li>
                            <li>保障兩邊交換的資料是有(標準)結構的 (固定形式以便判斷數值等等)</li>
                            <li>Standard MIB：每一家廠商的網路設備都有的物件</li>
                            <li>Private MIBs (extension)：某家設備獨有的物件</li>
                            <li>
                                Structure of Management Information (SMI) (RFC 1155)
                                <ul>
                                    <li>Defines the general framework for defining SNMP MIBs</li>
                                    <li>描述 <strong>Managed Objects (MOs)</strong> 在 MIB 裡如何被定義、可以擁有的 data types 和 values、如何被取名</li>
                                    <li>Abstract Syntax Notation One (ASN.1) 用來定義 MIB-I 的 MOs：讓你去跨平台</li>
                                    <li>RFC 1212 用來定義 MIB-II 的 MOs：現今最常用</li>
                                </ul>
                            </li>
                            <li>
                                SNMP MIB 只能儲存 simple data types
                                <ul>
                                    <li>Scalars、2-dimensional arrays of scalars</li>
                                    <li>MOs 就是階層結構的 rooted tree：葉子是 MOs，每個都有唯一的 Object Identifier (OID) 來分辨是甚麼的資訊 <img src="https://i.imgur.com/K42CFmd.png" alt=""> <img src="https://i.imgur.com/npITWNt.png" alt=""> <img src="https://i.imgur.com/c4h61DJ.png" alt=""></li>
                                    <li>那麼多 entry 代表的其實是二維的表格，用一個序列來表示 <img src="https://i.imgur.com/THQkUVa.png" alt=""> <img src="https://i.imgur.com/OfIFjrJ.png" alt=""></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h2 id="Data-Link-Layer"><a class="anchor hidden-xs" href="#Data-Link-Layer" title="Data-Link-Layer"><span class="octicon octicon-link"></span></a>Data-Link Layer</h2>
                <h3 id="Introduction1"><a class="anchor hidden-xs" href="#Introduction1" title="Introduction1"><span class="octicon octicon-link"></span></a>Introduction</h3>
                <ul>
                    <li>
                        Link 為相鄰節點的 communication channels
                        <table>
                            <thead>
                                <tr>
                                    <th>角色</th>
                                    <th>扮演者</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>nodes</td>
                                    <td>hosts、routers</td>
                                </tr>
                                <tr>
                                    <td>link</td>
                                    <td>wired links、wireless links、LANs</td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li>
                        比較
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Layer</th>
                                    <th>pkt name</th>
                                    <th>Protocal</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>5</td>
                                    <td>Application</td>
                                    <td>message</td>
                                    <td>HTTP, FTP, SMTP…</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Transport</td>
                                    <td>segment</td>
                                    <td>TCP, UDP → 程序間的溝通</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>Network</td>
                                    <td>datagram</td>
                                    <td>Internet 協定 → IP → <strong>Router</strong></td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Link</td>
                                    <td>frame</td>
                                    <td>Ethernet 協定 → MAC  → <strong>Switch</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                    <li>
                        datagram 在不同的 link 種類裡用不同的協定來傳遞
                        <ul>
                            <li>Ethernet → 有線、frame relay → LAN、802.11 → 無線</li>
                            <li>個別提供不同的服務 (不一定有 Reliable Data Transfer)</li>
                        </ul>
                    </li>
                    <li>
                        framing, link access
                        <ul>
                            <li>datagram 去 header(頭)、trailer(尾) 變成 frame</li>
                            <li>shared medium (共用的東西EX：switch) 的 channel access，因為沒弄好可能會碰撞 → 解決碰撞之後，錯開的機制是否公平</li>
                            <li><strong>MAC</strong>(Medium Access Control) 為 frame 裡用的地址，每個製造商會先錯開，他再用流水號錯開</li>
                        </ul>
                    </li>
                    <li>
                        相鄰節點的 reliable delivery
                        <ul>
                            <li>we learned how to do this already (chapter 3)</li>
                            <li>鮮少用到 low bit-error link：fiber、some twisted pair</li>
                            <li>wireless links：high error rates</li>
                        </ul>
                    </li>
                    <li>flow control：目前乙太是不做的，但可開啟</li>
                    <li>
                        收送種類限制：
                        <ul>
                            <li>Simplex：只能單向</li>
                            <li>
                                half-duplex：不能同時雙向
                                <ul>
                                    <li>wifi：(是用震幅來判斷高低)，因為訊號的介質是空氣，同時收送的話，訊號會重疊相加，就看不出來正確的高低了</li>
                                </ul>
                            </li>
                            <li>
                                full-duplex：可以同時雙向
                                <ul>
                                    <li>乙太：裡面算四條線，兩條給收，兩條給送</li>
                                    <li>4G：因為是一個頻帶，它可以將頻帶切成多個頻道，有些拿來送，有些拿來收</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        網卡 <strong>NIC</strong> network interface card <img src="https://i.imgur.com/NVS8Ld8.png" alt="">
                        <ul>
                            <li>combination of hardware, software, firmware(韌體，運作在 controller 上的程式)</li>
                            <li>
                                Adaptors communicating <img src="https://i.imgur.com/TzWXNdE.png" alt="">
                                <ul>
                                    <li>
                                        發送端
                                        <ul>
                                            <li>封裝 datagram → frame</li>
                                            <li>增加 error checking bits、rdt、flow control</li>
                                        </ul>
                                    </li>
                                    <li>
                                        接收端
                                        <ul>
                                            <li>檢查 errors、rdt、flow control</li>
                                            <li>解 frame 封裝 → datagram，再傳給上層</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Error-detection"><a class="anchor hidden-xs" href="#Error-detection" title="Error-detection"><span class="octicon octicon-link"></span></a>Error detection</h3>
                <ul>
                    <li>
                        EDC= Error Detection and Correction bits (redundancy)<br>
                        D = Data protected by error checking, may include header fields
                        <ul>
                            <li>Error detection 並非 100% 可靠！</li>
                            <li>protocol 可能沒偵測出錯誤，但很少</li>
                            <li>但若是 larger EDC field 會有比較好的 detection and correction <img src="https://i.imgur.com/7KtG65u.png" alt=""></li>
                        </ul>
                    </li>
                    <li>
                        要先講好要用 even / odd  parity <img src="https://i.imgur.com/sdTuwuQ.png" alt="">
                        <ul>
                            <li>二維就可以直接知道哪個 bit 有問題由收端直接改掉即可 → error correction</li>
                            <li>但要是連錯偶數個 bit，就無法偵測出是哪裡錯(但機率不高)</li>
                            <li>但要偵測就需要傳送比較多的 bit，要付出相應代價</li>
                            <li>如今並不通用，都直接使用 retransmittion</li>
                        </ul>
                    </li>
                    <li>
                        Cyclic redundancy check (CRC)
                        <ul>
                            <li>可看成 L2 的 checksum，是放在封包的後面 <img src="https://i.imgur.com/nkeljqP.png" alt=""></li>
                            <li>more powerful error-detection：多攜帶同樣 bit 數，卻表現比較好</li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-63-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>D</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-817" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-818" class="mjx-mrow"><span id="MJXc-Node-819" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">D</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">D</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-63">\tt D</script>
                                </span>
                                為 data 用 bits 來看，binary number
                            </li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-64-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>G</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-820" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-821" class="mjx-mrow"><span id="MJXc-Node-822" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">G</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">G</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-64">\tt G</script>
                                </span>
                                choose <strong>r+1</strong> bit pattern (generator)，送收端都知道
                            </li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-65-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>R</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-823" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-824" class="mjx-mrow"><span id="MJXc-Node-825" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">R</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-65">\tt R</script>
                                </span>
                                choose <strong>r</strong> CRC bits 滿足
                                <ul>
                                    <li>&lt;D,R&gt; 必須整除 G (in modulo 2 → 相減時不用借位的算法)</li>
                                    <li>收端知道 G，把收到的 data 拿去除以 G，如果餘數不是 0 → error detected!</li>
                                    <li>可以偵測到所有小於 r+1 bits 的 errors</li>
                                </ul>
                            </li>
                            <li>通用於 Ethernet、802.11 WiFi、ATM</li>
                            <li>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-66-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>l</mi><mi mathvariant=&quot;monospace&quot;>l</mi><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mi mathvariant=&quot;monospace&quot;>b</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>t</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mi mathvariant=&quot;monospace&quot;>D</mi><mo>&amp;#x00D7;</mo><msup><mn mathvariant=&quot;monospace&quot;>2</mn><mi mathvariant=&quot;monospace&quot;>r</mi></msup><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mi mathvariant=&quot;monospace&quot;>X</mi><mi mathvariant=&quot;monospace&quot;>O</mi><mi mathvariant=&quot;monospace&quot;>R</mi><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mi mathvariant=&quot;monospace&quot;>R</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-826" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-827" class="mjx-mrow"><span id="MJXc-Node-828" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-829" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">l</span></span><span id="MJXc-Node-830" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">l</span></span><span id="MJXc-Node-831" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-832" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">b</span></span><span id="MJXc-Node-833" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-834" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-835" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-836" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">D</span></span><span id="MJXc-Node-837" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-838" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-839" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">2</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.529em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-840" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span></span></span><span id="MJXc-Node-841" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-842" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">X</span></span><span id="MJXc-Node-843" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">O</span></span><span id="MJXc-Node-844" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span><span id="MJXc-Node-845" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-846" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">R</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="monospace">a</mi>
                                                <mi mathvariant="monospace">l</mi>
                                                <mi mathvariant="monospace">l</mi>
                                                <mtext mathvariant="monospace">&nbsp;</mtext>
                                                <mi mathvariant="monospace">b</mi>
                                                <mi mathvariant="monospace">i</mi>
                                                <mi mathvariant="monospace">t</mi>
                                                <mo mathvariant="monospace">=</mo>
                                                <mi mathvariant="monospace">D</mi>
                                                <mo>×</mo>
                                                <msup>
                                                    <mn mathvariant="monospace">2</mn>
                                                    <mi mathvariant="monospace">r</mi>
                                                </msup>
                                                <mtext mathvariant="monospace">&nbsp;</mtext>
                                                <mi mathvariant="monospace">X</mi>
                                                <mi mathvariant="monospace">O</mi>
                                                <mi mathvariant="monospace">R</mi>
                                                <mtext mathvariant="monospace">&nbsp;</mtext>
                                                <mi mathvariant="monospace">R</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-66">\tt all\ bit = D\times 2^r\ XOR\ R</script>
                                </span>
                                <ul>
                                    <li>先把向左移 r bits，移完後面那段會是 0，用 XOR 來將 R貼到後面 <img src="https://i.imgur.com/BHedtY9.png" alt=""></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Multiple-access-protocols"><a class="anchor hidden-xs" href="#Multiple-access-protocols" title="Multiple-access-protocols"><span class="octicon octicon-link"></span></a>Multiple access protocols</h3>
                <ul>
                    <li>
                        point-to-point
                        <ul>
                            <li>PPP for dial-up access</li>
                            <li>point-to-point link between Ethernet switch, host</li>
                        </ul>
                    </li>
                    <li>
                        broadcast (shared wire or medium)
                        <ul>
                            <li>old-fashioned Ethernet</li>
                            <li>upstream HFC</li>
                            <li>802.11 wireless LAN</li>
                        </ul>
                    </li>
                    <li>
                        如果是多個裝置要存取同一裝置，EX：wifi、MAC
                        <ul>
                            <li>因為無法同時所以要特地去設計每個時間點下可用的分配規則</li>
                            <li>用 distributed algorithm 決定節點如何分享 channel (節點甚麼時候可以傳輸)</li>
                        </ul>
                    </li>
                    <li>
                        理想狀態：
                        <ul>
                            <li>broadcast channel of rate R bps</li>
                            <li>當只有單一節點在傳輸時，可拿到 rate R</li>
                            <li>當有 M 要傳輸，每個點可拿 R/M，希望分配平均</li>
                            <li>
                                fully decentralized：(不要有中控來控制)
                                <ul>
                                    <li>不要有特殊的節點來主控大家</li>
                                    <li>不要同步時間(太麻煩)</li>
                                    <li>因為如果這台掛了就會讓整個系統癱瘓</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>MAC protocols：taxonomy (分類) → 共三種作法</li>
                </ul>
                <h4 id="Channel-Partitioning"><a class="anchor hidden-xs" href="#Channel-Partitioning" title="Channel-Partitioning"><span class="octicon octicon-link"></span></a>Channel Partitioning</h4>
                <ul>
                    <li>把 channel 切成小塊 (可依照 time slots、frequency、code)，做不同的作用</li>
                    <li>
                        TDMA (time division multiple access)：依<strong>時間</strong>切割
                        <ul>
                            <li>每個周期內每個 slot 都會固定會分配到一段時間(= packet transmission time)是專門給他傳送，他如果不傳就空著</li>
                            <li>缺點：沒有達到最大使用率、會延遲 (因為要等下一輪)</li>
                            <li>EX：6-station LAN、1,3,4 have packets to send、slots 2,5,6 idle <img src="https://i.imgur.com/xQIwMvD.png" alt=""></li>
                        </ul>
                    </li>
                    <li>
                        FDMA (frequency division multiple access)：用<strong>頻率</strong>切割
                        <ul>
                            <li>每個人有自己的頻道，沒用的就空著</li>
                            <li>EX：6-station LAN、1,3,4 have packet to send、frequency bands 2,5,6 idle<img src="https://i.imgur.com/j6MPXAv.png" alt=""></li>
                            <li>EX：手機講電話時，要保證好的通話品質，那你不講是你的損失</li>
                            <li>優：保證傳輸品質，缺：沒有達到最大使用率</li>
                        </ul>
                    </li>
                    <li>
                        效率：
                        <ul>
                            <li>high load：公平、有效率</li>
                            <li>low load：效率低、delay in channel access、單點傳輸也只能拿到 1/N 頻寬</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Random-Access"><a class="anchor hidden-xs" href="#Random-Access" title="Random-Access"><span class="octicon octicon-link"></span></a>Random Access</h4>
                <ul>
                    <li>
                        <p>並沒有切割 channel，且允許 collisions → 要修復碰撞</p>
                        <ul>
                            <li>頻道都是滿的 rate R (除非大家都不送)</li>
                            <li>節點間沒有 prioricoordination (事先協調)</li>
                        </ul>
                    </li>
                    <li>
                        <p>需要的能力：</p>
                        <ul>
                            <li>要有能力偵測碰撞</li>
                            <li>如何修復碰撞，重送不加一點延遲可能再撞一次</li>
                        </ul>
                    </li>
                    <li>
                        <p>Slotted ALOHA<img src="https://i.imgur.com/xNPMylq.png" alt=""></p>
                        <ul>
                            <li>夏威夷的人發明的，因為島多通訊要用，把封包打到衛星，再打下去，可突破中間有海的地理限制</li>
                            <li>
                                Assumptions：
                                <ul>
                                    <li>frames 大小相同，時間也切成相同大小，節點是 synchronized (同步的)</li>
                                    <li>只有在一個 slot 開始的那一刻才能開始發送封包，與窗格對齊</li>
                                    <li>如果 2 個以上的節點在同 slot 傳輸，所有節點都偵測到碰撞</li>
                                </ul>
                            </li>
                            <li>
                                Operation：
                                <ul>
                                    <li>如果節點觀察到 fresh frame，在下個 slot 送</li>
                                    <li>沒碰撞：下個 slot 也可以送封包</li>
                                    <li>碰撞：要重送，用機率來決定自己要不要在下一個 slot 重送(如果大家都在下一次重送的話會再撞一次)</li>
                                </ul>
                            </li>
                            <li>
                                優點：
                                <ul>
                                    <li>如果只有一個點要送，就可以持續佔滿它</li>
                                    <li>highly decentralized(去中心化)：只有 slot 要同步，其他不用 (同步的項目少 → 簡單)</li>
                                </ul>
                            </li>
                            <li>
                                缺點：
                                <ul>
                                    <li>collisions 可能造成 idle slots 浪費、校正時間不好做</li>
                                    <li>節點需要用比傳送封包還要少的時間去 detect collision</li>
                                </ul>
                            </li>
                            <li>
                                效率：
                                <ul>
                                    <li>假設有 N 個有很多 frame 要送的節點，碰撞後決定下次送的機率為 p</li>
                                    <li>自己要送成功的機率 = p(1-p)<sup>N-1</sup></li>
                                    <li>有一個點成功的機率 = Np(1-p)<sup>N-1</sup></li>
                                    <li>Max Efficiency：找到一個 p’ 使 Np(1-p)<sup>N-1</sup> 為最大值</li>
                                    <li>
                                        N → 無限，Np’(1-p’)<sup>N-1</sup> → 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-67-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>m</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>x</mi><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>f</mi><mi mathvariant=&quot;monospace&quot;>f</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>y</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mn mathvariant=&quot;monospace&quot;>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo mathvariant=&quot;monospace&quot;>/</mo></mrow><mi mathvariant=&quot;monospace&quot;>e</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mn mathvariant=&quot;monospace&quot;>0.37</mn></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-847" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-848" class="mjx-mrow"><span id="MJXc-Node-849" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em; padding-right: 0.011em;">m</span></span><span id="MJXc-Node-850" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-851" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">x</span></span><span id="MJXc-Node-852" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-853" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-854" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">f</span></span><span id="MJXc-Node-855" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">f</span></span><span id="MJXc-Node-856" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-857" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-858" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-859" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-860" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-861" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-862" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">y</span></span><span id="MJXc-Node-863" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-864" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span><span id="MJXc-Node-865" class="mjx-texatom"><span id="MJXc-Node-866" class="mjx-mrow"><span id="MJXc-Node-867" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">/</span></span></span></span><span id="MJXc-Node-868" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-869" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-870" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.445em; padding-bottom: 0.279em;">0.37</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi mathvariant="monospace">m</mi>
                                                        <mi mathvariant="monospace">a</mi>
                                                        <mi mathvariant="monospace">x</mi>
                                                        <mtext mathvariant="monospace">&nbsp;</mtext>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">f</mi>
                                                        <mi mathvariant="monospace">f</mi>
                                                        <mi mathvariant="monospace">i</mi>
                                                        <mi mathvariant="monospace">c</mi>
                                                        <mi mathvariant="monospace">i</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                        <mi mathvariant="monospace">c</mi>
                                                        <mi mathvariant="monospace">y</mi>
                                                        <mo mathvariant="monospace">=</mo>
                                                        <mn mathvariant="monospace">1</mn>
                                                        <mrow class="MJX-TeXAtom-ORD">
                                                            <mo mathvariant="monospace">/</mo>
                                                        </mrow>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mo mathvariant="monospace">=</mo>
                                                        <mn mathvariant="monospace">0.37</mn>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-67">\tt max\ efficiency = 1/e = 0.37</script>
                                        </span>
                                    </li>
                                    <li>頻道有 37% 時間是被有用的傳輸佔用</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>Pure (unslotted) ALOHA</p>
                        <ul>
                            <li>when frame first arrives 想送就送、較簡單、非同步化</li>
                            <li>collision 機率增加：在 t<sub>0</sub> 送的訊框會跟在 [t<sub>0</sub>-1, t<sub>0</sub>+1] 傳送的封包碰撞<img src="https://i.imgur.com/2D0Tp3x.png" alt=""></li>
                            <li>
                                效率：比 slotted Aloha 還糟<br>
                                P(自己成功)<br>
                                = P(傳輸機率) × P(沒有其他人在 [t<sub>0</sub>-1, t<sub>0</sub>] 傳送)× P(沒有其他人在 [t<sub>0</sub>, t<sub>0</sub>+1] 傳送)<br>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-68-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo mathvariant=&quot;monospace&quot;>=</mo><mi mathvariant=&quot;monospace&quot;>p</mi><mo>&amp;#x00D7;</mo><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>(</mo><mn mathvariant=&quot;monospace&quot;>1</mn><mo mathvariant=&quot;monospace&quot;>&amp;#x2212;</mo><mi mathvariant=&quot;monospace&quot;>p</mi><msup><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;monospace&quot;>N</mi><mo mathvariant=&quot;monospace&quot;>&amp;#x2212;</mo><mn mathvariant=&quot;monospace&quot;>1</mn></mrow></msup><mo>&amp;#x00D7;</mo><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>(</mo><mn mathvariant=&quot;monospace&quot;>1</mn><mo mathvariant=&quot;monospace&quot;>&amp;#x2212;</mo><mi mathvariant=&quot;monospace&quot;>p</mi><msup><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;monospace&quot;>N</mi><mo mathvariant=&quot;monospace&quot;>&amp;#x2212;</mo><mn mathvariant=&quot;monospace&quot;>1</mn></mrow></msup></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-871" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-872" class="mjx-mrow"><span id="MJXc-Node-873" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-874" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-875" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-876" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">(</span></span><span id="MJXc-Node-877" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span><span id="MJXc-Node-878" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-879" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-880" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-881" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-882" class="mjx-texatom" style=""><span id="MJXc-Node-883" class="mjx-mrow"><span id="MJXc-Node-884" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">N</span></span><span id="MJXc-Node-885" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-886" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span></span></span></span></span><span id="MJXc-Node-887" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-888" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">(</span></span><span id="MJXc-Node-889" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span><span id="MJXc-Node-890" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-891" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-892" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-893" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-894" class="mjx-texatom" style=""><span id="MJXc-Node-895" class="mjx-mrow"><span id="MJXc-Node-896" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">N</span></span><span id="MJXc-Node-897" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-898" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span></span></span></span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mo mathvariant="monospace">=</mo>
                                                <mi mathvariant="monospace">p</mi>
                                                <mo>×</mo>
                                                <mo mathvariant="monospace" stretchy="false">(</mo>
                                                <mn mathvariant="monospace">1</mn>
                                                <mo mathvariant="monospace">−</mo>
                                                <mi mathvariant="monospace">p</mi>
                                                <msup>
                                                    <mo mathvariant="monospace" stretchy="false">)</mo>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi mathvariant="monospace">N</mi>
                                                        <mo mathvariant="monospace">−</mo>
                                                        <mn mathvariant="monospace">1</mn>
                                                    </mrow>
                                                </msup>
                                                <mo>×</mo>
                                                <mo mathvariant="monospace" stretchy="false">(</mo>
                                                <mn mathvariant="monospace">1</mn>
                                                <mo mathvariant="monospace">−</mo>
                                                <mi mathvariant="monospace">p</mi>
                                                <msup>
                                                    <mo mathvariant="monospace" stretchy="false">)</mo>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mi mathvariant="monospace">N</mi>
                                                        <mo mathvariant="monospace">−</mo>
                                                        <mn mathvariant="monospace">1</mn>
                                                    </mrow>
                                                </msup>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-68">\tt = p \times (1-p)^{N-1}\times (1-p)^{N-1}</script>
                                </span>
                                <br>
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-69-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo mathvariant=&quot;monospace&quot;>=</mo><mi mathvariant=&quot;monospace&quot;>p</mi><mo>&amp;#x00D7;</mo><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>(</mo><mn mathvariant=&quot;monospace&quot;>1</mn><mo mathvariant=&quot;monospace&quot;>&amp;#x2212;</mo><mi mathvariant=&quot;monospace&quot;>p</mi><msup><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn mathvariant=&quot;monospace&quot;>2</mn><mo>&amp;#x00D7;</mo><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>(</mo><mi mathvariant=&quot;monospace&quot;>N</mi><mo mathvariant=&quot;monospace&quot;>&amp;#x2212;</mo><mn mathvariant=&quot;monospace&quot;>1</mn><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>)</mo></mrow></msup><mo mathvariant=&quot;monospace&quot;>=</mo></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-899" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-900" class="mjx-mrow"><span id="MJXc-Node-901" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-902" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-903" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-904" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">(</span></span><span id="MJXc-Node-905" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span><span id="MJXc-Node-906" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-907" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-908" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-909" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-910" class="mjx-texatom" style=""><span id="MJXc-Node-911" class="mjx-mrow"><span id="MJXc-Node-912" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">2</span></span><span id="MJXc-Node-913" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">×</span></span><span id="MJXc-Node-914" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">(</span></span><span id="MJXc-Node-915" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">N</span></span><span id="MJXc-Node-916" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.279em; padding-bottom: 0.445em;">−</span></span><span id="MJXc-Node-917" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span><span id="MJXc-Node-918" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">)</span></span></span></span></span></span><span id="MJXc-Node-919" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mo mathvariant="monospace">=</mo>
                                                <mi mathvariant="monospace">p</mi>
                                                <mo>×</mo>
                                                <mo mathvariant="monospace" stretchy="false">(</mo>
                                                <mn mathvariant="monospace">1</mn>
                                                <mo mathvariant="monospace">−</mo>
                                                <mi mathvariant="monospace">p</mi>
                                                <msup>
                                                    <mo mathvariant="monospace" stretchy="false">)</mo>
                                                    <mrow class="MJX-TeXAtom-ORD">
                                                        <mn mathvariant="monospace">2</mn>
                                                        <mo>×</mo>
                                                        <mo mathvariant="monospace" stretchy="false">(</mo>
                                                        <mi mathvariant="monospace">N</mi>
                                                        <mo mathvariant="monospace">−</mo>
                                                        <mn mathvariant="monospace">1</mn>
                                                        <mo mathvariant="monospace" stretchy="false">)</mo>
                                                    </mrow>
                                                </msup>
                                                <mo mathvariant="monospace">=</mo>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-69">\tt = p \times (1-p)^{2\times (N-1)}=</script>
                                </span>
                                (N → 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-70-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-920" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-921" class="mjx-mrow"><span id="MJXc-Node-922" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">∞</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mi mathvariant="normal">∞</mi>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-70">\infty</script>
                                </span>
                                ) 
                                <span class="mathjax">
                                    <span class="MathJax_Preview" style="color: inherit;"></span>
                                    <span id="MathJax-Element-71-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn mathvariant=&quot;monospace&quot;>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo mathvariant=&quot;monospace&quot;>/</mo></mrow><mn mathvariant=&quot;monospace&quot;>2</mn><mi mathvariant=&quot;monospace&quot;>e</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mn mathvariant=&quot;monospace&quot;>0.18</mn></math>" role="presentation" style="font-size: 113%; position: relative;">
                                        <span id="MJXc-Node-923" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-924" class="mjx-mrow"><span id="MJXc-Node-925" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span><span id="MJXc-Node-926" class="mjx-texatom"><span id="MJXc-Node-927" class="mjx-mrow"><span id="MJXc-Node-928" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">/</span></span></span></span><span id="MJXc-Node-929" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">2</span></span><span id="MJXc-Node-930" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-931" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-932" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">0.18</span></span></span></span>
                                        <span class="MJX_Assistive_MathML" role="presentation">
                                            <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                <mn mathvariant="monospace">1</mn>
                                                <mrow class="MJX-TeXAtom-ORD">
                                                    <mo mathvariant="monospace">/</mo>
                                                </mrow>
                                                <mn mathvariant="monospace">2</mn>
                                                <mi mathvariant="monospace">e</mi>
                                                <mo mathvariant="monospace">=</mo>
                                                <mn mathvariant="monospace">0.18</mn>
                                            </math>
                                        </span>
                                    </span>
                                    <script type="math/tex" id="MathJax-Element-71">\tt 1/2e = 0.18</script>
                                </span>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>CSMA (carrier sense multiple access)</p>
                        <ul>
                            <li>傳輸前先聽：idle → 傳輸、busy → 延遲傳輸 (不要在講話的時候講話)</li>
                            <li>
                                collision：整個封包的傳輸時間都浪費掉
                                <ul>
                                    <li>distance &amp; propagation delay play role in in determining collision probability</li>
                                    <li>就算有先聽再送，還是會因為傳遞延遲(propagation delay)而導致你以為沒人在講話而講話，造成碰撞</li>
                                    <li>若要偵測碰撞：邊送邊聽，如果沒碰撞，邊聽的時候應該要聽到自己所發出的封包</li>
                                    <li>因為無偵測碰撞功能，所以還是堅持送完 → 浪費</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>CSMA/CD (collision detection)</p>
                        <ul>
                            <li>
                                加入偵測碰撞功能 (知道跟別人同時講話就不要再講了) <img src="https://i.imgur.com/IB7GXds.png" alt="">
                                <ul>
                                    <li>在短時間內偵測碰撞，偵測到就馬上停止傳輸，減少浪費</li>
                                    <li>有線 LAN：因為訊號不會減弱，容易比較聽到的和自己傳出去的是否相同</li>
                                    <li>無線 LAN：因為訓好強弱差很多，很難比較</li>
                                    <li>在用一個機率來定要甚麼時候聽 (把 sence channel 也錯開)</li>
                                </ul>
                            </li>
                            <li>
                                Ethernet CSMA/CD 演算法
                                <ol>
                                    <li>NIC 收到網路層的 datagram → 封裝成 frame</li>
                                    <li>如果 NIC 偵測到 idle → 開始傳送 frame，若沒有則等到 idle 再傳</li>
                                    <li>如果沒偵測到其他在人搶就會全部傳完</li>
                                    <li>如果遇碰撞就停止送，然後再多傳幾個位元給別人(怕別人沒偵測到碰撞)</li>
                                    <li>
                                        停止之後，NIC 進入 binary (exponential) backoff 狀態
                                        <ul>
                                            <li>在 m<sup>th</sup> 碰撞後，NIC 在 {0,1,2, …, 2m-1} 裡隨機選一個 K</li>
                                            <li>NIC 會等 K×512 bit times 才會返回 2.</li>
                                            <li>如果連續撞，下一次就會等更久(TCP 也是設計成越等越久)失敗超過一定次數就會 fail → 不送了</li>
                                        </ul>
                                    </li>
                                </ol>
                            </li>
                            <li>
                                效率：
                                <ul>
                                    <li>T<sub>prop</sub> = 兩節點間的 max prop delay</li>
                                    <li>t<sub>trans</sub> = 傳送 max-size frame 所需時間</li>
                                    <li>
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-72-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>f</mi><mi mathvariant=&quot;monospace&quot;>f</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>y</mi><mo mathvariant=&quot;monospace&quot;>=</mo><mfrac><mn mathvariant=&quot;monospace&quot;>1</mn><mrow><mn mathvariant=&quot;monospace&quot;>1</mn><mo mathvariant=&quot;monospace&quot;>+</mo><mn mathvariant=&quot;monospace&quot;>5</mn><msub><mi mathvariant=&quot;monospace&quot;>T</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>o</mi><mi mathvariant=&quot;monospace&quot;>p</mi></mrow></msub><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo mathvariant=&quot;monospace&quot;>/</mo></mrow><msub><mi mathvariant=&quot;monospace&quot;>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>s</mi></mrow></msub></mrow></mfrac></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-933" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-934" class="mjx-mrow"><span id="MJXc-Node-935" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-936" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">f</span></span><span id="MJXc-Node-937" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">f</span></span><span id="MJXc-Node-938" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-939" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-940" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-941" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-942" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-943" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-944" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">y</span></span><span id="MJXc-Node-945" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.224em;">=</span></span><span id="MJXc-Node-946" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 5.153em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 7.287em; top: -1.263em;"><span id="MJXc-Node-947" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 7.287em; bottom: -0.927em;"><span id="MJXc-Node-948" class="mjx-mrow" style=""><span id="MJXc-Node-949" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span><span id="MJXc-Node-950" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.224em;">+</span></span><span id="MJXc-Node-951" class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">5</span></span><span id="MJXc-Node-952" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-953" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-954" class="mjx-texatom" style=""><span id="MJXc-Node-955" class="mjx-mrow"><span id="MJXc-Node-956" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-957" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-958" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-959" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span></span></span></span></span><span id="MJXc-Node-960" class="mjx-mtext"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-961" class="mjx-texatom"><span id="MJXc-Node-962" class="mjx-mrow"><span id="MJXc-Node-963" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.501em; padding-bottom: 0.335em;">/</span></span></span></span><span id="MJXc-Node-964" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-965" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-966" class="mjx-texatom" style=""><span id="MJXc-Node-967" class="mjx-mrow"><span id="MJXc-Node-968" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-969" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-970" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-971" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-972" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.285em; width: 5.153em;"></span></span><span class="mjx-vsize" style="height: 1.548em; vertical-align: -0.656em;"></span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">f</mi>
                                                        <mi mathvariant="monospace">f</mi>
                                                        <mi mathvariant="monospace">i</mi>
                                                        <mi mathvariant="monospace">c</mi>
                                                        <mi mathvariant="monospace">i</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                        <mi mathvariant="monospace">c</mi>
                                                        <mi mathvariant="monospace">y</mi>
                                                        <mo mathvariant="monospace">=</mo>
                                                        <mfrac>
                                                            <mn mathvariant="monospace">1</mn>
                                                            <mrow>
                                                                <mn mathvariant="monospace">1</mn>
                                                                <mo mathvariant="monospace">+</mo>
                                                                <mn mathvariant="monospace">5</mn>
                                                                <msub>
                                                                    <mi mathvariant="monospace">T</mi>
                                                                    <mrow class="MJX-TeXAtom-ORD">
                                                                        <mi mathvariant="monospace">p</mi>
                                                                        <mi mathvariant="monospace">r</mi>
                                                                        <mi mathvariant="monospace">o</mi>
                                                                        <mi mathvariant="monospace">p</mi>
                                                                    </mrow>
                                                                </msub>
                                                                <mtext mathvariant="monospace">&nbsp;</mtext>
                                                                <mrow class="MJX-TeXAtom-ORD">
                                                                    <mo mathvariant="monospace">/</mo>
                                                                </mrow>
                                                                <msub>
                                                                    <mi mathvariant="monospace">t</mi>
                                                                    <mrow class="MJX-TeXAtom-ORD">
                                                                        <mi mathvariant="monospace">t</mi>
                                                                        <mi mathvariant="monospace">r</mi>
                                                                        <mi mathvariant="monospace">a</mi>
                                                                        <mi mathvariant="monospace">n</mi>
                                                                        <mi mathvariant="monospace">s</mi>
                                                                    </mrow>
                                                                </msub>
                                                            </mrow>
                                                        </mfrac>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-72">\tt efficiency=\frac{1}{1+5T_{prop}\ /t_{trans}}</script>
                                        </span>
                                    </li>
                                    <li>
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-73-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>f</mi><mi mathvariant=&quot;monospace&quot;>f</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>i</mi><mi mathvariant=&quot;monospace&quot;>e</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>c</mi><mi mathvariant=&quot;monospace&quot;>y</mi><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>&amp;#x2192;</mo><mn mathvariant=&quot;monospace&quot;>1</mn></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-973" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-974" class="mjx-mrow"><span id="MJXc-Node-975" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-976" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">f</span></span><span id="MJXc-Node-977" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">f</span></span><span id="MJXc-Node-978" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-979" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-980" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">i</span></span><span id="MJXc-Node-981" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">e</span></span><span id="MJXc-Node-982" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-983" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">c</span></span><span id="MJXc-Node-984" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">y</span></span><span id="MJXc-Node-985" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">→</span></span><span id="MJXc-Node-986" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">1</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">f</mi>
                                                        <mi mathvariant="monospace">f</mi>
                                                        <mi mathvariant="monospace">i</mi>
                                                        <mi mathvariant="monospace">c</mi>
                                                        <mi mathvariant="monospace">i</mi>
                                                        <mi mathvariant="monospace">e</mi>
                                                        <mi mathvariant="monospace">n</mi>
                                                        <mi mathvariant="monospace">c</mi>
                                                        <mi mathvariant="monospace">y</mi>
                                                        <mo mathvariant="monospace" stretchy="false">→</mo>
                                                        <mn mathvariant="monospace">1</mn>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-73">\tt efficiency→1</script>
                                        </span>
                                        時 
                                        <span class="mathjax">
                                            <span class="MathJax_Preview" style="color: inherit;"></span>
                                            <span id="MathJax-Element-74-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;monospace&quot;>T</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;monospace&quot;>p</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>o</mi><mi mathvariant=&quot;monospace&quot;>p</mi></mrow></msub><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>&amp;#x2192;</mo><mn mathvariant=&quot;monospace&quot;>0</mn><mo mathvariant=&quot;monospace&quot;>,</mo><mtext mathvariant=&quot;monospace&quot;>&amp;#xA0;</mtext><msub><mi mathvariant=&quot;monospace&quot;>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;monospace&quot;>t</mi><mi mathvariant=&quot;monospace&quot;>r</mi><mi mathvariant=&quot;monospace&quot;>a</mi><mi mathvariant=&quot;monospace&quot;>n</mi><mi mathvariant=&quot;monospace&quot;>s</mi></mrow></msub><mo mathvariant=&quot;monospace&quot; stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                <span id="MJXc-Node-987" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-988" class="mjx-mrow"><span id="MJXc-Node-989" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-990" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">T</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-991" class="mjx-texatom" style=""><span id="MJXc-Node-992" class="mjx-mrow"><span id="MJXc-Node-993" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span><span id="MJXc-Node-994" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-995" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">o</span></span><span id="MJXc-Node-996" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.501em;">p</span></span></span></span></span></span><span id="MJXc-Node-997" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">→</span></span><span id="MJXc-Node-998" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.39em; padding-bottom: 0.279em;">0</span></span><span id="MJXc-Node-999" class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="margin-top: -0.053em; padding-bottom: 0.39em;">,</span></span><span id="MJXc-Node-1000" class="mjx-mtext MJXc-space1"><span class="mjx-char" style="margin-top: -0.218em; padding-bottom: 0.003em;"><span class="mjx-charbox MJXc-TeX-type-R" style="padding-bottom: 0.233em; margin-right: 0.275em;">&nbsp;</span></span></span><span id="MJXc-Node-1001" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1002" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1003" class="mjx-texatom" style=""><span id="MJXc-Node-1004" class="mjx-mrow"><span id="MJXc-Node-1005" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.335em; padding-bottom: 0.279em;">t</span></span><span id="MJXc-Node-1006" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">r</span></span><span id="MJXc-Node-1007" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">a</span></span><span id="MJXc-Node-1008" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-1009" class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span></span></span><span id="MJXc-Node-1010" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.224em; padding-bottom: 0.335em;">→</span></span><span id="MJXc-Node-1011" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.169em; padding-bottom: 0.335em;">∞</span></span></span></span>
                                                <span class="MJX_Assistive_MathML" role="presentation">
                                                    <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                        <msub>
                                                            <mi mathvariant="monospace">T</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                                <mi mathvariant="monospace">p</mi>
                                                                <mi mathvariant="monospace">r</mi>
                                                                <mi mathvariant="monospace">o</mi>
                                                                <mi mathvariant="monospace">p</mi>
                                                            </mrow>
                                                        </msub>
                                                        <mo mathvariant="monospace" stretchy="false">→</mo>
                                                        <mn mathvariant="monospace">0</mn>
                                                        <mo mathvariant="monospace">,</mo>
                                                        <mtext mathvariant="monospace">&nbsp;</mtext>
                                                        <msub>
                                                            <mi mathvariant="monospace">t</mi>
                                                            <mrow class="MJX-TeXAtom-ORD">
                                                                <mi mathvariant="monospace">t</mi>
                                                                <mi mathvariant="monospace">r</mi>
                                                                <mi mathvariant="monospace">a</mi>
                                                                <mi mathvariant="monospace">n</mi>
                                                                <mi mathvariant="monospace">s</mi>
                                                            </mrow>
                                                        </msub>
                                                        <mo mathvariant="monospace" stretchy="false">→</mo>
                                                        <mi mathvariant="normal">∞</mi>
                                                    </math>
                                                </span>
                                            </span>
                                            <script type="math/tex" id="MathJax-Element-74">\tt T_{prop} → 0,\ t_{trans} → \infty</script>
                                        </span>
                                    </li>
                                    <li>較簡單、較便宜、去中心化、效率佳</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>CSMA/CA (Collision Avoidence)： (wifi 在用)</p>
                        <ul>
                            <li>訊號強弱差太多沒辦法比，無法偵測碰撞 → 改成碰撞避免機制</li>
                            <li>carry sense：訊號傳遞範圍有限，要先聽也聽不到，且可能造成浪費</li>
                            <li>送出資料前，聆聽網路上的狀態，如果沒有人使用，維持一段時間後，再等待一段隨機的時間後如果還沒有人使用，才送出資料。由於每一個裝置採用的隨機時間不同，可以減少碰撞的機會</li>
                            <li>送出資料前，先送一個RTS (Request to Send) 封包給目標端，等待目標端做出回應有就是送出 CTS(Clear to Send) 封包後，才開始傳送</li>
                            <li>有人要送封包出來時，先送一個含 RTS (request) 的封包給大家，收到的人就在這個時間內閉嘴</li>
                            <li>有人已經聽到別人的封包時，廣播一個含 CTS (clear) 的封包，讓大家知道有人發東西來了，叫大家閉嘴</li>
                            <li>可重送 4 / 7 次，超過就 drop，也有 ACK 機制</li>
                        </ul>
                    </li>
                    <li>
                        <p>效率：</p>
                        <ul>
                            <li>efficient at low load：單點可用滿整個頻道</li>
                            <li>high load：collision overhead</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="“Taking-Turns”"><a class="anchor hidden-xs" href="#“Taking-Turns”" title="“Taking-Turns”"><span class="octicon octicon-link"></span></a>“Taking Turns”</h4>
                <ul>
                    <li>
                        polling：
                        <ul>
                            <li>master 輪流 “邀請” slave 來傳遞封包</li>
                            <li>通常跟 “dumb” slave 裝置一起用</li>
                            <li>
                                缺點：
                                <ul>
                                    <li>polling 花費、latency(延遲)</li>
                                    <li>master 掛掉：設一個 timeout，如果太久沒人過問，就先假設 master 掛了，用演算法選出下個 master</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        token passing (權杖)：
                        <ul>
                            <li>大家輪流拿 control token，拿到才能發東西出來</li>
                            <li>
                                缺點：
                                <ul>
                                    <li>token 花費、latency(延遲)</li>
                                    <li>
                                        token 消失時：
                                        <ul>
                                            <li>設 timeout，很久沒收到就當他不見了，就自己造一個權杖放回網路</li>
                                            <li>token 的碰撞：也要用演算法舉行選舉，看要用誰 token</li>
                                        </ul>
                                    </li>
                                    <li>還要加上 token pkt transmission time，如果中間都沒人要送，就要等他繞一圈回來才能送</li>
                                </ul>
                            </li>
                            <li>優點：很公平、token 本身幾十 bytes 而已，占全部的資料傳輸空間也不多</li>
                            <li>high load：運用率很高</li>
                            <li>low load：沒有要發也只是把權杖給下一個而已</li>
                        </ul>
                    </li>
                    <li>Bluetooth, FDDI, token ring</li>
                    <li>效率：綜合前兩者的優點</li>
                </ul>
                <h3 id="MAC-address"><a class="anchor hidden-xs" href="#MAC-address" title="MAC-address"><span class="octicon octicon-link"></span></a>MAC address</h3>
                <ul>
                    <li><code>ifconfig</code> 來查看介面上的資訊，<code>em0, em1</code>為 em 這個廠商的第 1, 2 張網卡，不同廠商有不同的開頭</li>
                    <li>48-bit MAC：為 6 * 2 個 16 進位的數字組成，中間用 “<code>:</code>” 來分隔，EX: 12:36:3d:8a:3b:c1</li>
                    <li>Flat address：刻在卡上拿到哪裡都不會變，可帶去別的 LAN (但要跟別人重新要IP)</li>
                    <li>broadcast : FF-FF-FF-FF-FF-FF(48bit 都是1，只能廣播自己的LAN)</li>
                    <li>
                        網卡只收3種封包
                        <ol>
                            <li>Unicast 以自己為目的地 mac</li>
                            <li>Multi-cast 有加入的 1 對多</li>
                            <li>Broadcast 廣播</li>
                        </ol>
                        <ul>
                            <li>監聽是要改成 promisculus mode 就可收所有封包 EX.wireshark (無法監聽 wifi 的封包)</li>
                        </ul>
                    </li>
                    <li>不同的 interface 有不同的 table、MAC (面對不同的LAN)</li>
                </ul>
                <h3 id="ARP-address-resolution-protocol"><a class="anchor hidden-xs" href="#ARP-address-resolution-protocol" title="ARP-address-resolution-protocol"><span class="octicon octicon-link"></span></a>ARP (address resolution protocol)</h3>
                <ul>
                    <li>用於MAC和IP轉換 <img src="https://i.imgur.com/ey0pR39.png" alt="" width="150" height="100"></li>
                    <li>每個 IP node (host、router) on LAN 都有 ARP table</li>
                    <li>IP/MAC 對應其他人：&lt; IP address；MAC address；TTL&gt;</li>
                    <li>ARP “plug-and-play”：會自己完成，不須手動每個去設定</li>
                    <li>發生在LAN的行為，乙太內的 MAC 和 ARP 裡的 MAC 會填的不一樣</li>
                    <li>
                        封包格式：包在ethernet的標頭裡面<img src="https://i.imgur.com/1YghLSY.png" alt="">
                        <ul>
                            <li>發封包還沒回覆時先在目標MAC填0、A 要跟 B 建連線</li>
                            <li>順序：src-ip、src-mac、dst-ip、dst-mac</li>
                            <li>request 封包：A-ip、A-mac、B-ip、00:00:00:00:00:00</li>
                            <li>reply 封包：B-ip、B-mac、A-ip、A-mac</li>
                            <li>if 中間會經過 router 會先問他的 MAC，他在去問下一步的 MAC</li>
                            <li>if 是透過 ARPproxy server，mac 會是收到的 server 的同一面的mac位址</li>
                        </ul>
                    </li>
                    <li>
                        流程：<img src="https://i.imgur.com/QXeW9gn.jpg" alt="">
                        <ul>
                            <li>當 A 想傳封包 (datagram) 給 B 時，只有 IP 卻沒有 MAC，就發 ARP 來問</li>
                        </ul>
                        <ol>
                            <li>先找 cache 裡有沒有他要的 ? 直接連線 : 執行2.~4.</li>
                            <li>srcHost broadcast ARP request 封包 (dst = FF-FF-FF-FF-FF-FF): 通知LAN裡所有主機看誰是他要找的</li>
                            <li>dstHost 回 ARP reply 封包 : 告訴src自己的MAC (非目標就會把此包discard)</li>
                            <li>
                                加入 ARP table (視為 cache，直到 TTL timeout 才刪除)
                                <ul>
                                    <li>Soft state：一直送封包 → 用此達到 keepalive</li>
                                    <li>TTL (Time To Live)：得到的 MAC 資訊還有多久要被忘記 (通常 20 min)，中間有傳輸就reset</li>
                                </ul>
                            </li>
                        </ol>
                    </li>
                    <li>
                        send datagram from A to B via R(路由器)<img src="https://i.imgur.com/dnRfPJj.png" alt="">
                        <ul>
                            <li>格式：src-ip、src-mac、dst-ip、dst-mac</li>
                            <li>A → R：A-ip、A-mac、B-ip、R-mac (A gateway)</li>
                            <li>R → B：A-ip、R-mac (B gateway)、B-ip、B-mac</li>
                            <li><img src="https://i.imgur.com/WmYb8OM.png" alt=""></li>
                            <li><img src="https://i.imgur.com/2ymCA0l.png" alt=""></li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Ethernet"><a class="anchor hidden-xs" href="#Ethernet" title="Ethernet"><span class="octicon octicon-link"></span></a>Ethernet</h3>
                <ul>
                    <li>
                        <p>“dominant” 主宰 wired LAN 技術：</p>
                        <ul>
                            <li>single chip、多種速度、簡單、便宜</li>
                            <li>最早廣泛使用的有線 LAN 技術</li>
                            <li>速度：10 Mbps –10 Gbps</li>
                        </ul>
                    </li>
                    <li>
                        <p>乙太拓樸<img src="https://i.imgur.com/Jd3g85E.png" alt=""></p>
                        <ul>
                            <li>
                                bus：popular through mid 90s (過時)
                                <ul>
                                    <li>傳遞訊號時會到同一條線上 → 碰撞</li>
                                    <li>同時間只能有一個傳輸在進行</li>
                                </ul>
                            </li>
                            <li>
                                star 星狀拓樸：現今仍在使用
                                <ul>
                                    <li>switch 當中心點，還可以增加 throughput (可同時進行)</li>
                                    <li>訊號到交換器就會停下來，並不會發生訊號碰撞的問題<br>
                                        → CSMA/CD 根本就不需要了，直接一直猛送就行
                                    </li>
                                    <li>但還是有可能在 buffer 掉封包，但送端不會知道 → 需依靠 TCP 的重送</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>header (802.3 Frame) <img src="https://i.imgur.com/J56rHgL.png" alt=""></p>
                        <ul>
                            <li>
                                <strong>preamble</strong>：8 bytes
                                <ul>
                                    <li>
                                        <p>原本都傳 10101010… (7 bytes，用來達成同步) 直到出現 10101011 就代表下一個 bit 開始是地址的部分，preamble 部分結束</p>
                                    </li>
                                    <li>
                                        <p>要把 bit time 的時間間隔講好，難在同步 clock rates</p>
                                    </li>
                                    <li>
                                        <p>物理上用高低電壓，他會在每個 bit time 去偵測電壓來判斷是 0 或 1，但如果沒對在波的中間(高峰，實際上的波不會是方波而是曲線波)，他就可能把 1 對到 0<br>
                                            <img src="https://i.imgur.com/51POawg.png" alt="">
                                        </p>
                                    </li>
                                    <li>
                                        <p>所以其實封包不是送到的那瞬間全部收到，還是一個個位元依序收，收完才收到的</p>
                                    </li>
                                    <li>
                                        <p>
                                            <span class="mathjax">
                                                <span class="MathJax_Preview" style="color: inherit;"></span>
                                                <span id="MathJax-Element-75-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                    <span id="MJXc-Node-1012" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1013" class="mjx-mrow"><span id="MJXc-Node-1014" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.445em;">Q</span></span></span></span>
                                                    <span class="MJX_Assistive_MathML" role="presentation">
                                                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                            <mi>Q</mi>
                                                        </math>
                                                    </span>
                                                </span>
                                                <script type="math/tex" id="MathJax-Element-75">Q</script>
                                            </span>
                                            ：為何 WIFI 的速率要一直改？<br>
                                            <span class="mathjax">
                                                <span class="MathJax_Preview" style="color: inherit;"></span>
                                                <span id="MathJax-Element-76-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mi>n</mi><mi>s</mi></math>" role="presentation" style="font-size: 113%; position: relative;">
                                                    <span id="MJXc-Node-1015" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1016" class="mjx-mrow"><span id="MJXc-Node-1017" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.501em; padding-bottom: 0.279em;">A</span></span><span id="MJXc-Node-1018" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">n</span></span><span id="MJXc-Node-1019" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.224em; padding-bottom: 0.279em;">s</span></span></span></span>
                                                    <span class="MJX_Assistive_MathML" role="presentation">
                                                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                                                            <mi>A</mi>
                                                            <mi>n</mi>
                                                            <mi>s</mi>
                                                        </math>
                                                    </span>
                                                </span>
                                                <script type="math/tex" id="MathJax-Element-76">Ans</script>
                                            </span>
                                            ：因為bit error率與傳送速率成正比，傳送速率 = 1/bit time，當 bit time 越短，他去偵測會因為她還沒昇或降電壓而測到錯誤值，所以錯誤率越大 → 所以當錯誤率大時，降速來提升準確率
                                        </p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <strong>addresses</strong>：6 byte src、dst MAC
                                <ul>
                                    <li>如果 adapter 收到 dst mac 是自己的或廣播 mac，才會解封裝傳給上層，否則丟棄</li>
                                </ul>
                            </li>
                            <li><strong>type</strong>：表示上層是哪個協定，通常是 IP，但也有其他的 EX. Novell IPX、AppleTalk</li>
                            <li><strong>CRC</strong>：收端會 cyclic redundancy check，若有出錯就丟棄</li>
                        </ul>
                    </li>
                    <li>
                        <p>特色：</p>
                        <ul>
                            <li>connectionless：不須 handshaking，要送就直接送</li>
                            <li>unreliable：收端 NIC 不會回送 acks 或 nacks → 用高層協定來修復</li>
                            <li>運用 unslotted CSMA/CD with binary backoff</li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Ethernet-switch"><a class="anchor hidden-xs" href="#Ethernet-switch" title="Ethernet-switch"><span class="octicon octicon-link"></span></a>Ethernet switch</h3>
                <ul>
                    <li>
                        link-layer 裝置：
                        <ul>
                            <li>store &amp; forward Ethernet frames</li>
                            <li>溝通通常在同一個LAN，24/48 port</li>
                            <li>檢查收到的封包是否要去的是 LAN，不是的會就送給預設閘道</li>
                            <li>是的話就送到他該去的地方</li>
                            <li>transparent：hosts 是不知道交換器存在的</li>
                            <li>plug-and-play、self-learning：插上網路線就可以用，不用設定就自己完成</li>
                        </ul>
                    </li>
                    <li>
                        自我學習 (MAC learning)：
                        <ul>
                            <li>在哪裡收到 A 的資料，他就在哪個 interface，將她的 MAC 寫進表裡</li>
                            <li>
                                如果不知道目的地在哪裡，就對 A 以外的介面 unicast (flood) = <strong>selected forward</strong>
                                <ul>
                                    <li>選擇性傳送到 1 個或多個 link</li>
                                </ul>
                            </li>
                            <li>透過傳送接收來不斷填滿table，而知道大家的位置，時間(TTL)到了會清</li>
                            <li>if 多階也可以學習再沿路回去</li>
                        </ul>
                        <pre><code class="c hljs"><span class="token keyword">if</span><span class="token punctuation">(</span>entry found <span class="token keyword">for</span> dst<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>dst is the place where its come from<span class="token punctuation">)</span> drop frame
    <span class="token keyword">else</span> forward frame on interface indicated by entry
<span class="token punctuation">}</span>
<span class="token keyword">else</span> flood <span class="token comment">// forward on all interfaces except arriving interface </span>
</code></pre>
                    </li>
                    <li>
                        <strong>Router vs. Switch</strong>
                        <table>
                            <thead>
                                <tr>
                                    <th>VS.</th>
                                    <th>Router</th>
                                    <th>Switch</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Layer</td>
                                    <td>Network (Datagram)</td>
                                    <td>Link (Frame)</td>
                                </tr>
                                <tr>
                                    <td>forwarding table</td>
                                    <td>compute</td>
                                    <td>learn</td>
                                </tr>
                                <tr>
                                    <td>所使用方法</td>
                                    <td>routing algorithm, ip</td>
                                    <td>flooding : 不知道送哪就選擇性全部送<br> learning, MAC address</td>
                                </tr>
                            </tbody>
                        </table>
                    </li>
                </ul>
                <h3 id="VLAN-Virtual-LAN"><a class="anchor hidden-xs" href="#VLAN-Virtual-LAN" title="VLAN-Virtual-LAN"><span class="octicon octicon-link"></span></a>VLAN (Virtual LAN)</h3>
                <ul>
                    <li>LAN：不需要路由的區域</li>
                    <li>
                        作用：<img src="https://i.imgur.com/JHP4A0X.png" alt="">
                        <ul>
                            <li>在實體網路用邏輯等切成幾個不同的 LAN，但物理上是同一個</li>
                            <li>用 L2 的方法把 LAN 切成多個 broadcast domain → L2’s VLAN</li>
                            <li>是一個邏輯的連線，而不是實體的連線</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="IEEE-8021Q-Frame："><a class="anchor hidden-xs" href="#IEEE-8021Q-Frame：" title="IEEE-8021Q-Frame："><span class="octicon octicon-link"></span></a>IEEE 802.1Q (Frame)：</h4>
                <ul>
                    <li>最常見/經典的 VLAN protocal</li>
                    <li>定義：如何在 headers 裡打上 tag、碰到tag如何反應作用</li>
                    <li>
                        在 switch 打上 tag (4bytes) 來表示是哪個 VLAN<img src="https://i.imgur.com/iqes8RM.png" alt="">
                        <ul>
                            <li><strong>Type</strong>：(4-byte) 包括 Tag Protocol Identifier (TPID)、Tag Control Information (TCI)</li>
                            <li>
                                <strong>TPID</strong>：(2-byte)
                                <ul>
                                    <li>VLAN：0x8100、ARP：0x0806、IP：0x0800</li>
                                    <li>如果看到0x8100而且認識，會直接繼續解讀後面 VLAN 的資料</li>
                                </ul>
                            </li>
                            <li>
                                <strong>TCI</strong>：(2-byte)
                                <ul>
                                    <li><strong>User priority</strong>：(3-bit) 可以讓有標籤的訊框攜帶優先權資訊通過無法支援優先權的網路 （如Ethernet），優先權的範圍為 0 ~ 7</li>
                                    <li>
                                        <strong>Canonical Format Identifier (CFI)</strong>：(1-bit)
                                        <ul>
                                            <li>CFI = 1 表示此標籤標頭中包含 RIF 欄位，而且 RIF 中的 NCFI 旗標值決定訊框資料中所攜帶的MAC位址是「制式格式」 (Canonical format) 或「非制式格式」(Non-canonical format)</li>
                                            <li>CFI = 0 則表示此標籤標頭中不包含RIF欄位，而且訊框中所包裝的MAC位址都是「制式格式」</li>
                                            <li>這裡所謂的「制式格式」是指一個位元組的位元在網路上傳送的順序。如果最高位元 (most significant bit) 先傳送，則稱為「制式格式」，相反的，如果最低位元 (least significant bit) 先傳送，則稱為「非制式格式」。</li>
                                        </ul>
                                    </li>
                                    <li><strong>VLAN ID (VID)</strong>：(12-bit) 1 ~ 4096</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>如果無法處理 VLAN 的裝置還是可以接收此封包，只是會把它丟掉</li>
                </ul>
                <h4 id="VLAN-aware-Network："><a class="anchor hidden-xs" href="#VLAN-aware-Network：" title="VLAN-aware-Network："><span class="octicon octicon-link"></span></a>VLAN-aware Network：<img src="https://i.imgur.com/ivNJKPs.png" alt="" width="350" height="120"></h4>
                <ul>
                    <li>進入時會打上 tag，出去時拿掉，一台中間的可以連接多個 VLAN</li>
                    <li>可在這裡面流通卻不會打 tag 就是 native VLAN → 不上標籤的例外 (預設 VLAN 1)</li>
                    <li>
                        Default VLAN：
                        <ul>
                            <li>通常是 VLAN 1、開機就會存在</li>
                            <li>所有 L2 的控制都跑在這個 VLAN 上</li>
                            <li>如果不是我們設定的，就是預設VLAN</li>
                            <li>通常是拿來管理自己的IP的，所以希望大家都能收到他</li>
                            <li>所以只要遇到 native VLAN 就會幫她剝掉 (VLAN1 可以送到任何VLAN，因為都會幫忙剝掉)</li>
                        </ul>
                    </li>
                    <li>Data VLAM：用來切割這些電腦的 VLAN、拿來將電腦分群</li>
                </ul>
                <ol>
                    <li>
                        untagged (access) port：
                        <ul>
                            <li>從外面進來 (in)：打上此 port 所設定的 VLAN tag</li>
                            <li>從裡面出去 (out)：如果此封包的 tag 符合此 port 的 VLAN #，就幫他剝掉</li>
                            <li>也有學習的功能(學MAC address)，像原始的switch</li>
                        </ul>
                    </li>
                    <li>
                        tagged (trunk) port：
                        <ul>
                            <li>從外面進來 (in)：如果此封包的 tag 符合此 port 的 VLAN #，就讓它進來</li>
                            <li>從裡面出去 (out)：如果此封包的 tag 符合此 port 的 VLAN #，就幫他傳出去</li>
                            <li>等於出去也是 tagged，所以不會剝掉，設定過濾標籤，就可以達到 access control</li>
                            <li>如果已有 tag 就不會改他，如果不符合的就丟掉</li>
                            <li>如果收到沒有 tag 就把它當成 native VLAN(VLAN 1)，出去還是不會幫他加上去</li>
                            <li>兩頭的vative VLAN要設一樣不然會搞混，也會學，但是是學 VID</li>
                        </ul>
                    </li>
                </ol>
                <ul>
                    <li>一個 switch 進出的 port 都有不同的 config</li>
                    <li>
                        Example<img src="https://i.imgur.com/RRhXRKW.png" alt="" width="300" height="60">
                        <ul>
                            <li>S1-1, S2-2 untagged, S1-2, S2-1 tagged, All configured with VLAN 10</li>
                        </ul>
                        <ol>
                            <li>A 送無tag的封包給 B</li>
                            <li>
                                Switch S1 收到無tag的訊框 from untagged Port 1
                                <ul>
                                    <li>S1 加 VLAN 10 tag 再送去 Port2</li>
                                    <li>Port 2 可讓 VLAN 10 通過，由 S1 → S2</li>
                                </ul>
                            </li>
                            <li>
                                Switch S2 收到有 VLAN 10 標籤的訊框 from tagged port 1
                                <ul>
                                    <li>Port 1 allows VLAN 10，讓它進來並決定讓他去 Port 2</li>
                                    <li>port 2 是 untagged port，又符合 VLAN，幫她拔掉在送出去</li>
                                </ul>
                            </li>
                            <li>Host B 照常收訊框，毫無被貼撕標籤的感覺</li>
                        </ol>
                    </li>
                </ul>
                <h4 id="VLAN-間的-routing-→-Inter-VLAN-routing"><a class="anchor hidden-xs" href="#VLAN-間的-routing-→-Inter-VLAN-routing" title="VLAN-間的-routing-→-Inter-VLAN-routing"><span class="octicon octicon-link"></span></a>VLAN 間的 routing → Inter-VLAN routing</h4>
                <ul>
                    <li>涵蓋 L2、L3，還是要 gateway</li>
                    <li>
                        Legacy inter-VLAN routing  <img src="https://i.imgur.com/ibfXmFo.png" alt="">
                        <ul>
                            <li>每個 VLAN 都有一個介面，分別連接到不同的 switch 的 port</li>
                            <li>利用路由器到交換器的兩條線來區別 vlan，dst IP 為 gateway</li>
                        </ul>
                    </li>
                    <li>
                        Router-on-a-Stick <img src="https://i.imgur.com/Kacc4L7.png" alt="">
                        <ul>
                            <li>VI 放在路由器上，中間用 trunk 連接，減少線數、port 數</li>
                        </ul>
                    </li>
                    <li>
                        Layer 3 switching via SVIs (Multilayer Switching) <img src="https://i.imgur.com/7c9ivdF.png" alt="">
                        <ul>
                            <li>可執行基本的 routing，做起來比較路由器快</li>
                            <li>交換 VLAN 不是用演算法，管理者 config 就可以做到</li>
                            <li>
                                Switch virtual interface (SVI)
                                <ul>
                                    <li>每個 VLAN 把某個 SVI 當成default gateway</li>
                                    <li>進來是 trunk port，一個 port 就可以接收很多VLAN</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>vty 只支持 extended vlan</li>
                </ul>
                <h3 id="STP-Spanning-Tree-Protocal-8021D"><a class="anchor hidden-xs" href="#STP-Spanning-Tree-Protocal-8021D" title="STP-Spanning-Tree-Protocal-8021D"><span class="octicon octicon-link"></span></a>STP (Spanning Tree Protocal) (802.1D)</h3>
                <ul>
                    <li>
                        沒有 STP 的三種下場
                        <ul>
                            <li>database instability：MAC 對應表一直改變，因為從不同埠收到相同來源的封包</li>
                            <li>broadcast storms：因為如果收件者不是自己就會幫她傳下去，結果就是大家一直來回傳，switch 形成一個圈，然有有任一台發封包，然後此 dst 不再 arp 表裡，就會 flood 出去(兩邊)，然後就互相 flood，因為一直有不同來源的封包一直來，他就一直改變 table 裡的 MAC 所以又一直往別的地方傳，就視同一個交換器從不同的 port 收到同個 IP 的封包，他就會很清楚這個 IP 的位置</li>
                            <li>multiple frame transmission：因為是迴圈，往兩邊送，另外一邊也會送到，導致 dst 收到 2 個以上相同的封包</li>
                        </ul>
                    </li>
                    <li>
                        Algorithm：
                        <ul>
                            <li>switch 內部把重複的路徑擋掉 (不拆線是因為哪天線壞了可以馬上換一條)</li>
                            <li>BDPU：屬於L2的控制訊息</li>
                            <li>有問題時，重新計算路徑，重新擋 port</li>
                            <li>STP 速度較慢，所以才有 RSTP (快速STP)</li>
                            <li><img src="https://i.imgur.com/9601IMp.png" alt="" width="200" height="100"> <strong>→</strong> <img src="https://i.imgur.com/QppKOVC.png" alt="" width="150" height="100">　　<img src="https://i.imgur.com/OVrITje.png" alt="" width="150" height="100"></li>
                            <li>
                                <strong>選出 Root Bridge</strong>
                                <ul>
                                    <li>所有 swItch 交換 BDPU (上面有權重，找出最小的 bridge ID)，就是 root bridge</li>
                                </ul>
                            </li>
                            <li>
                                <strong>非 Root Switch 決定 Root Port</strong>：每台一個，擁有到 Root Bridge 成本最少的路徑
                                <ul>
                                    <li>只有 Root Bridge 沒有 RP，直接連接到 Root Bridge 的那個埠都是 RP</li>
                                </ul>
                            </li>
                            <li>
                                <strong>每條 Link 決定其中一端作為 Designated Port</strong>：依交換的 BPDU 來決定
                                <ul>
                                    <li>root bridge 上每個埠都是 DP</li>
                                    <li>如果 link 的一端是 RP，另一端一定是 DP (相反不一定)</li>
                                    <li>如果每一個 link 上都有一個DP時，要轉換的時候會比較快</li>
                                    <li>每一個 DP 到 Root 橋接器的距離是基於收到 BPDU 中的設定值，並加上下列的比較計算出來</li>
                                    <li>
                                        第一優先：比較 root path cost 的值
                                        <ul>
                                            <li>各橋接器在轉送 BPDU 的時候，會將封包中 root path cost 值加上設定的 path cost。 因此 root path cost 值即是各個埠到 Root 橋接器的總和</li>
                                        </ul>
                                    </li>
                                    <li>第二優先：root path cost 相同的話，則比較 BID</li>
                                    <li>
                                        第三優先：若是 BID 相同時(每一個埠都連接到相同的橋接器)，則比較 DP ID
                                        <ul>
                                            <li>前 2 byte：連接埠優先權、後 2 byte：連接埠編號</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <strong>暫停使用 Blocking Port</strong>
                                <ul>
                                    <li>每條 link 上只會有一端是 BP(BLK)，另一端就是 DP(FWD)</li>
                                    <li>可以收 BPDU 但不能送任何封</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        共 5 狀態：<img src="https://i.imgur.com/e4i1wQ9.png" alt="">
                        <ul>
                            <li>DISABLE：無效連接埠，忽略所有接收到的封包</li>
                            <li>BLOCK：僅接受 BPDU 封包</li>
                            <li>LISTEN：接受及傳送 BPDU 封包</li>
                            <li>LEARN：接受、傳送 BPDU 封包及學習 MAC 位址</li>
                            <li>FORWARD：接受、傳送 BPDU 封包、學習 MAC 及訊框的傳送</li>
                        </ul>
                    </li>
                    <li>
                        有包含 VLAN 的 STP (by Cisco)
                        <ul>
                            <li>
                                Per-VLAN Spanning Tree (PVST)：STP adding the VLAN feature our STP
                                <ul>
                                    <li>VLAN 單獨改變不會影響整棵樹，一個 VLAN 自己一棵樹</li>
                                </ul>
                            </li>
                            <li>Per-VLAN Spanning Tree Plus (PVST+)：improved PVST</li>
                            <li>Rapid-PVST+：快速的 PVST+</li>
                            <li>
                                MSTP (Multiple Spanning Tree Protocol) (not Cisco)
                                <ul>
                                    <li>STP 和 RSTP 的擴展，用於有 VLAN 的網絡</li>
                                    <li>最初定義 IEEE 802.1S 為 802.1Q 的修訂版，最後被合併為 IEEE 802.1Q-2005</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h4 id="RSTP-Rapid-Spanning-Tree-Protocol-8021W"><a class="anchor hidden-xs" href="#RSTP-Rapid-Spanning-Tree-Protocol-8021W" title="RSTP-Rapid-Spanning-Tree-Protocol-8021W"><span class="octicon octicon-link"></span></a>RSTP (Rapid Spanning Tree Protocol) (802.1W)</h4>
                <ul>
                    <li>演算法是同一個，只是記住了一些狀態，可以較快收斂</li>
                    <li>
                        有三狀態：
                        <ul>
                            <li>Discarding：被 BLK 掉，只可收不能送</li>
                            <li>Learning：能傳資料的時候才會學習</li>
                            <li>Forwarding：可以收也可以送</li>
                        </ul>
                    </li>
                    <li>一個機器一開始加入時會經歷 blocking → listening → learing → forwarding</li>
                    <li>
                        RSTP 還會把這種 port 儲存成三種狀態<img src="https://i.imgur.com/9xysPKM.png" alt="">
                        <ul>
                            <li>Alternate Port：普通可以收 BPDU 的 blocked port</li>
                            <li>Backup ports：可以收同一台 bridge 的 BPDU 的 blocked port，當兩條接到一樣時</li>
                            <li>Disabled ports：shut down 的 port</li>
                        </ul>
                    </li>
                    <li>比較<img src="https://i.imgur.com/dnEciV4.png" alt=""></li>
                </ul>
                <h4 id="BDPU-Bridge-Protocol-Data-Units-8023-Ethernet"><a class="anchor hidden-xs" href="#BDPU-Bridge-Protocol-Data-Units-8023-Ethernet" title="BDPU-Bridge-Protocol-Data-Units-8023-Ethernet"><span class="octicon octicon-link"></span></a>BDPU (Bridge Protocol Data Units) (802.3 Ethernet)</h4>
                <ul>
                    <li>
                        因為802.3所以沒有ethernet type<img src="https://i.imgur.com/IvqvutU.png" alt="">
                        <ul>
                            <li>Length &lt;= 1500 802.2 LLC (??? Logic Control)</li>
                            <li>Length ≥ 1536 802.3 Ethernet II</li>
                            <li>
                                802.3 header 標示 src 和 dst of BPDU frame
                                <ul>
                                    <li>Source：a unique MAC address from its origin port</li>
                                    <li>Destination：a multicast address as destination MAC for the spanning tree group</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        Bridge ID (BID) 是由 switch 的 Priority Value、Extended System ID、MAC Address 組成<img src="https://i.imgur.com/k2LIMWA.png" alt="" width="250" height="100"><img src="https://i.imgur.com/3iY2lq6.png" alt="" width="330" height="100">
                        <ul>
                            <li>Bridge Priority：自動設定的，但可以被更改</li>
                            <li>MAC address：送端 switch 的 MAC</li>
                            <li>
                                Extended System ID
                                <ul>
                                    <li>VLAN ID 或  multiple spanning tree protocol (MSTP) instance ID</li>
                                    <li>proiority 要是4096的倍數，因為在extended Id (12bits) 前面</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="Virtual-Private-Network-VPN-"><a class="anchor hidden-xs" href="#Virtual-Private-Network-VPN-" title="Virtual-Private-Network-VPN-"><span class="octicon octicon-link"></span></a>Virtual Private Network (VPN) <img src="https://i.imgur.com/UA356DT.png" alt=""></h3>
                <ul>
                    <li>
                        Tunnel：不用管路由，就用隧道直達，很像兩者直接相連，有加密的連線
                        <ul>
                            <li>把一 protocal 包在別的 protocal 裡面，然後就像兩個網路接起來一樣</li>
                            <li>EX：把 L2 的封包整個包在 UDP 裡面、IPv4 包在 IPv6 裡面<img src="https://i.imgur.com/il4PVFT.png" alt=""></li>
                            <li>
                                Point-to-Point Tunneling Protocol (PPTP) [2637] <img src="https://i.imgur.com/siI8Wn3.png" alt="">
                                <ul>
                                    <li>Point-to-Point Tunneling Protocol (PPTP)：PPP + encryption + enhanced GRE</li>
                                    <li>Layer Two Tunneling Protocol (L2TP)：PPTP + L2F</li>
                                    <li>
                                        Generic Routing Encapsulation (GRE)：
                                        <ul>
                                            <li>多加一個 header 在 inside、outside IP 中間</li>
                                            <li>enhanced 版：提供 flow 和 congestion control</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>Remote Access Over the Internet <img src="https://i.imgur.com/2HegnDk.png" alt=""></li>
                    <li>Connecting Networks Over the Internet (Site to Site VPN) <img src="https://i.imgur.com/FjqIvIj.png" alt=""></li>
                    <li>Connecting Computers over an Intranet <img src="https://i.imgur.com/mhgmyU6.png" alt=""></li>
                </ul>
                <h3 id="Security"><a class="anchor hidden-xs" href="#Security" title="Security"><span class="octicon octicon-link"></span></a>Security</h3>
                <ul>
                    <li>
                        Common LAN Attacks on Layer 2
                        <ul>
                            <li>
                                拿到控制權
                                <ul>
                                    <li>Cisco Discovery Protocol (CDP)：cisco 專有，通用的是 LLDP</li>
                                    <li>Telnet Attacks</li>
                                </ul>
                            </li>
                            <li>
                                癱瘓網路
                                <ul>
                                    <li>ARP Spoofing、VLAN Attacks、DHCP Attacks</li>
                                    <li>MAC Spoofing and Address Table Flooding Attacks</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h4 id="Cisco-Discovery-Protocol-CDP"><a class="anchor hidden-xs" href="#Cisco-Discovery-Protocol-CDP" title="Cisco-Discovery-Protocol-CDP"><span class="octicon octicon-link"></span></a>Cisco Discovery Protocol (CDP)</h4>
                <ul>
                    <li>廣播為 periodic、unencrypted、unauthenticated</li>
                    <li>解決：使用者端其實不需要連上去(擋掉)、改成有加密的模式</li>
                </ul>
                <h4 id="Telnet-Attacks"><a class="anchor hidden-xs" href="#Telnet-Attacks" title="Telnet-Attacks"><span class="octicon octicon-link"></span></a>Telnet Attacks</h4>
                <ul>
                    <li>天生不安全，攻擊者可能利用 Telnet 獲得對 Cisco 網絡設備的遠程訪問</li>
                    <li><strong>Brute Force Password Attack</strong>：密碼設太簡單被暴力破解</li>
                    <li><strong>Telnet DoS Attack</strong>：攻擊者不斷請求 Telnet 連線，以試圖使 Telnet 癱瘓，以阻止管理員遠程訪問 switch</li>
                    <li>解決：增加安全性</li>
                </ul>
                <h4 id="ARP-Spoofing"><a class="anchor hidden-xs" href="#ARP-Spoofing" title="ARP-Spoofing"><span class="octicon octicon-link"></span></a>ARP Spoofing</h4>
                <ul>
                    <li>一種 man-in-the-middle 攻擊，也稱作 ARP poisoning</li>
                    <li>
                        攻擊者發送包含偽造 MAC 的 ARP 封包
                        <ul>
                            <li>“中毒” 受害者的 ARP 緩存表會包含錯誤的 IP-to-MAC  mappings</li>
                            <li>要送給該 IP 的任何流量都發送給攻擊者</li>
                            <li>攻擊者可能會攔截網絡上的封包，修改流量或停止所有流量</li>
                            <li>自己送封包 → 更改對應表，但有時候這樣做是為了好的用途</li>
                            <li>但壞人會利用這個來收本來收不到的封包或讓別人收不到封包</li>
                        </ul>
                    </li>
                    <li>
                        解決：Dynamic ARP Inspection (DAI)
                        <ul>
                            <li>檢查 ARP 的封包，把所有這類的封包攔截下來，檢查是否是有效的 ARP</li>
                            <li>
                                DAI 的運作
                                <ul>
                                    <li>攔截所有 ARP 的 requests、responses</li>
                                    <li>驗證攔截的數據包是否具有有效的 MAC-to-IP bindings</li>
                                    <li>丟棄無效的 ARP packets</li>
                                </ul>
                            </li>
                            <li>
                                需要一個 trusted database 來存儲有效的 MAC-to-IP bindings
                                <ul>
                                    <li>Built at runtime by DHCP snooping (explained later)</li>
                                </ul>
                            </li>
                            <li>
                                Switch ports 預設為 untrusted
                                <ul>
                                    <li>連接到 hosts 的 ports 設為 untrusted，因為會有其他人連上來，所以要特別檢查</li>
                                    <li>連接到 switches 的 ports 設為 trusted，因為確定不會有人動手腳，就可以不用檢查 ARP 封包</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h4 id="MAC-Spoofing"><a class="anchor hidden-xs" href="#MAC-Spoofing" title="MAC-Spoofing"><span class="octicon octicon-link"></span></a>MAC Spoofing</h4>
                <ul>
                    <li>更改網絡面的 factory-assigned MAC 地址的技術</li>
                    <li>
                        MAC Spoofing Attack
                        <ul>
                            <li>嗅探網絡以獲取有效的 MAC 地址，並更改其 MAC 地址以使其成為有效 MAC 地址之一</li>
                            <li>繞過 servers、routers 上的 ACL…等</li>
                        </ul>
                    </li>
                    <li>
                        MAC Address Table Flooding Attack
                        <ul>
                            <li>
                                送很多 ARP 封包，傳把 CAM Table 佔滿，佔滿後會進入 fail-open mode
                                <ul>
                                    <li>Switch 廣播所有封包給所有 LAN 裡的裝置</li>
                                    <li>攻擊者就可以拿到所有的封包 → 更慘</li>
                                </ul>
                            </li>
                            <li>解決：開啟 port security</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="VLAN-Hopping"><a class="anchor hidden-xs" href="#VLAN-Hopping" title="VLAN-Hopping"><span class="octicon octicon-link"></span></a>VLAN Hopping</h4>
                <ul>
                    <li>欺騙 switch 讓他幫你傳遞不同 VLAN 間的訊息 (all through Layer 2 switching)<img src="https://i.imgur.com/ty8waNS.png" alt=""></li>
                    <li>解決：改 native vlan #、強迫 native vlan 上 tag</li>
                </ul>
                <h4 id="Two-types-of-DHCP-attacks"><a class="anchor hidden-xs" href="#Two-types-of-DHCP-attacks" title="Two-types-of-DHCP-attacks"><span class="octicon octicon-link"></span></a>Two types of DHCP attacks</h4>
                <ul>
                    <li>
                        DHCP Spoofing attack
                        <ul>
                            <li>偽造假的 DHCP server 讓他發 IP 給 clients，讓他拿到錯的 DNS、gateway</li>
                        </ul>
                    </li>
                    <li>
                        DHCP Starvation attack
                        <ul>
                            <li>一直跟 DHCP 發 discover 封包 (且不斷換 MAC)，讓他一直發 IP 發到完</li>
                            <li>
                                Denial-of-Service (DoS) attack：
                                <ul>
                                    <li>用非法流量超載特定設備和網絡服務，從而防止合法流量到達那些資源</li>
                                    <li>讓真正要用的裝置沒 IP 可要，使它用不了網路</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        解決
                        <ul>
                            <li>
                                DHCP Snooping 有 2 種 ports，預設是 untrusted
                                <ul>
                                    <li>Trusted Ports：連接到上游 DHCP servers 的 ports，可收 DHCP 的封包</li>
                                    <li>Untrusted ports：連到 hosts 的 Ports，不應該收到 DHCP 的封包</li>
                                </ul>
                            </li>
                            <li>
                                可開啟 DHCP Option 82 for port security
                                <ul>
                                    <li>又名 Agent Relay Information Option 或 Agent Information Option (RFC 3046)</li>
                                    <li>允許 DHCP relay agent 標示自己和原發送 DHCP 的 client</li>
                                    <li>可以成為 DHCP relay agent 的裝置：switch、router、firewall、server…等</li>
                                    <li>他就只會接收帶上選項的封包<img src="https://i.imgur.com/u31NeyK.png" alt=""></li>
                                    <li>運作<img src="https://i.imgur.com/cGuemYK.png" alt=""></li>
                                    <li>
                                        Suboption <img src="https://i.imgur.com/8tv2GA7.png" alt=""><img src="https://i.imgur.com/7GBPQdR.png" alt=""><img src="https://i.imgur.com/cEeRtQH.png" alt="">
                                        <ul>
                                            <li>Circuit ID：標示收到請求的 port or VLAN<img src="https://i.imgur.com/bGgw7dc.png" alt=""></li>
                                            <li>
                                                Remote ID：<img src="https://i.imgur.com/j4DEM92.png" alt="">
                                                <ul>
                                                    <li>標示 DHCP Relay Agent 的 hostname 或其他描述</li>
                                                    <li>預設為 switch 的 MAC address</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="EtherChannel-Link-Aggregation"><a class="anchor hidden-xs" href="#EtherChannel-Link-Aggregation" title="EtherChannel-Link-Aggregation"><span class="octicon octicon-link"></span></a>EtherChannel (Link Aggregation)</h3>
                <ul>
                    <li>讓物理上多條線變成邏輯上的一條線(不會被 STP 擋)，讓頻寬變大<img src="https://i.imgur.com/ep2h2a2.png" alt=""></li>
                    <li>
                        特性：
                        <ul>
                            <li>Fast 和 Gigabit 不能混用，要同一種</li>
                            <li>兩端的數量、VLAN…等設置要一樣</li>
                            <li>最多 8 條一組，Cisco 接收最多 6 EtherChannel</li>
                        </ul>
                    </li>
                    <li>
                        2 Negotiation Protocols <img src="https://i.imgur.com/i1JYlZ6.png" alt="">
                        <ul>
                            <li>
                                <strong>Port Aggregation Protocol (PAgP)</strong> (Cisco 專有)
                                <ul>
                                    <li>On：沒啟用</li>
                                    <li>Auto：只會回應收到的 PAgP，另一端要是 Desirable 才會運作 (預設)</li>
                                    <li>Desirable：會主動發 PAgP，也會回應</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Link Aggregation Control Protocol (LACP)</strong> (IEEE 802.3ad)
                                <ul>
                                    <li>On：沒啟用 (預設)</li>
                                    <li>Passive：只會回應收到的 LACP，另一端要是 Active 才會運作</li>
                                    <li>Active：會主動發 LACP，也會回應</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <h3 id="First-Hop-Redundancy-Protocols-FHRP"><a class="anchor hidden-xs" href="#First-Hop-Redundancy-Protocols-FHRP" title="First-Hop-Redundancy-Protocols-FHRP"><span class="octicon octicon-link"></span></a>First Hop Redundancy Protocols (FHRP)</h3>
                <ul>
                    <li>第一個 hop 會是 default gateway，此協定就是讓他有備用 gateway</li>
                    <li>平常設定只能設定一個閘道</li>
                    <li>
                        作法：
                        <ul>
                            <li>兩個 gateway 聯合騙 client 只有一個閘道，形成一個 virtual gateway，對外溝通都用這個虛擬閘道 (有 virtaul ip 和 MAC)</li>
                            <li>一個是 forwarding router，一個是 stand-by router<img src="https://i.imgur.com/k8kDgwC.png" alt=""></li>
                            <li>所以他們會一直交換封包，如果 standby 很久沒收到 active 的封包，就覺得它掛了，然後取代它的位置<img src="https://i.imgur.com/zEQlMRn.png" alt=""></li>
                            <li>其實可以大於兩個，剩下的就是 listen router，當 standby 取代了原本的 active，就會有一個 listen 變成 standby</li>
                        </ul>
                    </li>
                    <li>可用協定：HSRP、VRRP、GLBP</li>
                </ul>
                <h4 id="Hot-Standby-Router-Protocol-HSRP"><a class="anchor hidden-xs" href="#Hot-Standby-Router-Protocol-HSRP" title="Hot-Standby-Router-Protocol-HSRP"><span class="octicon octicon-link"></span></a>Hot Standby Router Protocol (HSRP)</h4>
                <ul>
                    <li>A CISCO proprietary protocol, which provides redundancy for a local subnet.</li>
                    <li>
                        HSRP group
                        <ul>
                            <li>每個 group 都有一個有 MAC addr、IP addr 的 virtual router</li>
                            <li>其中包含 1 個 Active router、1 個 Standby router、0 個以上的 Listening router</li>
                            <li>服務不同的人，會有 group ID</li>
                            <li>Hosts 要將 virtual router 設成 default gateway</li>
                            <li>只有 Active router 負責當 virtual router</li>
                            <li>active 掛了由 standby 接手</li>
                        </ul>
                    </li>
                    <li>
                        Priority：選舉中用來決定誰是 Active router
                        <ul>
                            <li>HSRP priority 為 0 ~ 255，預設為 100</li>
                            <li>由最高 priority 當 Active router</li>
                            <li>如果 priority 相同，則擁有較高 IPv4 address 當 active</li>
                        </ul>
                    </li>
                    <li>
                        Preemption
                        <ul>
                            <li>預設如果一個 router 變成 active router，除非壞掉不然都不會換人，就算有一個較高 HSRP priority 的路由器上限也不換人</li>
                            <li>開啟 preemption 強制重新舉行 HSRP 選舉，以保證最高 priority 的人當 active router</li>
                            <li>如果沒有開 pre-emption，第一個開機的 router 就會變成 active router (如果沒有其他路由器開這要一起選舉)</li>
                            <li>如果 priority 相同，則擁有較高 IPv4 address 不會去搶著當 active</li>
                        </ul>
                    </li>
                    <li>有兩個版本：都是 UDP port 1985 (被標註的是 HSRP group number)<img src="https://i.imgur.com/paL2I3j.png" alt=""></li>
                    <li>Interface Tracking：如果被追蹤的介面掛掉，就自動扣 Priorty (預設 60)</li>
                    <li>狀態轉變<img src="https://i.imgur.com/U2Zv1aN.png" alt=""><img src="https://i.imgur.com/d0lk6tK.png" alt=""></li>
                </ul>
                <h4 id="Virtual-Router-Redundancy-Protocol-VRRP-RFC-2338"><a class="anchor hidden-xs" href="#Virtual-Router-Redundancy-Protocol-VRRP-RFC-2338" title="Virtual-Router-Redundancy-Protocol-VRRP-RFC-2338"><span class="octicon octicon-link"></span></a>Virtual Router Redundancy Protocol (VRRP) (RFC 2338<img src="https://i.imgur.com/1FVWwGT.png" alt=""></h4>
                <ul>
                    <li>
                        選舉方法同上，Active = Master，其他都是 Backup<img src="https://i.imgur.com/3Xs5vMH.png" alt="">
                        <ul>
                            <li>被標註的是 Virtual Router IDentifier <strong>VRID</strong></li>
                        </ul>
                    </li>
                    <li>當把 priority 改得比較大時就會自動開啟 preemption</li>
                    <li>比較<img src="https://i.imgur.com/l54xAch.png" alt=""></li>
                </ul>
                <h3 id="網路協定-amp-Port-Number"><a class="anchor hidden-xs" href="#網路協定-amp-Port-Number" title="網路協定-amp-Port-Number"><span class="octicon octicon-link"></span></a>網路協定 &amp; Port Number</h3>
                <table>
                    <thead>
                        <tr>
                            <th>簡稱</th>
                            <th>全名</th>
                            <th>Port</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SMTP</td>
                            <td>Simple Mail Transfer Protocol</td>
                            <td>25</td>
                        </tr>
                        <tr>
                            <td>FTP</td>
                            <td>File Transfer Protocol</td>
                            <td>21</td>
                        </tr>
                        <tr>
                            <td>HTTP</td>
                            <td>Hypertext Transfer Protocol</td>
                            <td>80, 443</td>
                        </tr>
                        <tr>
                            <td>DNS</td>
                            <td>Domain Name System</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>SNMP</td>
                            <td>Simple Network Management Protocol</td>
                            <td>161, 162</td>
                        </tr>
                        <tr>
                            <td>SCTP</td>
                            <td>Stream Control Transmission Protocol</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>TCP</td>
                            <td>Transmission Control Protocol</td>
                            <td>6</td>
                        </tr>
                        <tr>
                            <td>UDP</td>
                            <td>User Datagram Protocol</td>
                            <td>17</td>
                        </tr>
                        <tr>
                            <td>ICMP</td>
                            <td>Internet Control Message Protocol</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>IGMP</td>
                            <td>Interne Group Management Protocol</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>IP</td>
                            <td>Internet Protocol</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>ARP</td>
                            <td>Address Resolution Protocol</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>RARP</td>
                            <td>Reversed Address Resolution Protocol</td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
                <div class="pull-right dropdown">
                    <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                    <i class="fa fa-bars"></i>
                    </a>
                    <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                        <div class="toc">
                            <ul class="nav">
                                <li class=""><a href="#Directory" title="Directory">Directory</a></li>
                                <li class="">
                                    <a href="#Introduction" title="Introduction">Introduction</a>
                                    <ul class="nav">
                                        <li class=""><a href="#“Nuts-and-Bolts”-View" title="“Nuts and Bolts” View">“Nuts and Bolts” View</a></li>
                                        <li><a href="#Network-Structure" title="Network Structure">Network Structure</a></li>
                                        <li><a href="#Access-networks" title="Access networks">Access networks</a></li>
                                        <li><a href="#Physical-media" title="Physical media">Physical media</a></li>
                                        <li>
                                            <a href="#Network-Core" title="Network Core">Network Core</a>
                                            <ul class="nav">
                                                <li><a href="#Circuit-Switching" title="Circuit Switching">Circuit Switching</a></li>
                                                <li><a href="#Packet-Switching" title="Packet Switching">Packet Switching</a></li>
                                                <li><a href="#比較" title="比較">比較</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#計算" title="計算">計算</a></li>
                                        <li><a href="#Layer--Protocal" title="Layer + Protocal">Layer + Protocal</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#Application-Layer" title="Application Layer">Application Layer</a>
                                    <ul class="nav">
                                        <li>
                                            <a href="#HTTP--HyperText-Transer-Protocal-" title="HTTP ( HyperText Transer Protocal )">HTTP ( HyperText Transer Protocal )</a>
                                            <ul class="nav">
                                                <li><a href="#use-TCP" title="use TCP">use TCP</a></li>
                                                <li><a href="#Stateless-" title="Stateless :">Stateless :</a></li>
                                                <li><a href="#HTTP-Connections-" title="HTTP Connections :">HTTP Connections :</a></li>
                                                <li><a href="#Request-Message" title="Request Message">Request Message</a></li>
                                                <li><a href="#Response-Message" title="Response Message">Response Message</a></li>
                                                <li><a href="#User-server-State--cookie" title="User-server State : cookie">User-server State : cookie</a></li>
                                                <li><a href="#Web-Caches-proxy-server-代理伺服器-" title="Web Caches (proxy server 代理伺服器) :">Web Caches (proxy server 代理伺服器) :</a></li>
                                                <li><a href="#Conditional-GET" title="Conditional GET">Conditional GET</a></li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a href="#Electronic-Email" title="Electronic Email">Electronic Email</a>
                                            <ul class="nav">
                                                <li><a href="#3-major-components" title="3 major components:">3 major components:</a></li>
                                                <li><a href="#過程：" title="過程：">過程：</a></li>
                                                <li><a href="#實作-不需要outlook…等等，打指令即可完成" title="實作 (不需要outlook…等等，打指令即可完成)">實作 (不需要outlook…等等，打指令即可完成)</a></li>
                                                <li><a href="#接收會用到的3種protocal" title="接收會用到的3種protocal">接收會用到的3種protocal</a></li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a href="#DNS-Domain-Name-System" title="DNS (Domain Name System)">DNS (Domain Name System)</a>
                                            <ul class="nav">
                                                <li><a href="#功能" title="功能">功能</a></li>
                                                <li><a href="#Hierarchy-階層性" title="Hierarchy 階層性">Hierarchy 階層性</a></li>
                                                <li><a href="#Name-Severs" title="Name Severs">Name Severs</a></li>
                                                <li><a href="#過程" title="過程">過程</a></li>
                                                <li><a href="#DNS-Records-amp-msg" title="DNS Records &amp; msg">DNS Records &amp; msg</a></li>
                                                <li><a href="#建立新的-DNS-伺服器" title="建立新的 DNS 伺服器">建立新的 DNS 伺服器</a></li>
                                                <li><a href="#Attack-DNS" title="Attack DNS">Attack DNS</a></li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a href="#Video-Streaming-and-Content-Distribution-Networks" title="Video Streaming and Content Distribution Networks">Video Streaming and Content Distribution Networks</a>
                                            <ul class="nav">
                                                <li><a href="#Multimedia--video" title="Multimedia : video">Multimedia : video</a></li>
                                                <li><a href="#Streaming-multimedia--DASH-Dynamic-Adaptive-Streaming-over-HTTP" title="Streaming multimedia : DASH (Dynamic, Adaptive Streaming over HTTP)">Streaming multimedia : DASH (Dynamic, Adaptive Streaming over HTTP)</a></li>
                                                <li><a href="#Content-Distribution-Networks-CDNs" title="Content Distribution Networks (CDNs)">Content Distribution Networks (CDNs)</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#Socket-Programming" title="Socket Programming">Socket Programming</a></li>
                                        <li><a href="#important-themes" title="important themes:">important themes:</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#Transport-Layer" title="Transport Layer">Transport Layer</a>
                                    <ul class="nav">
                                        <li><a href="#Transport-Service" title="Transport Service">Transport Service</a></li>
                                        <li><a href="#TCP" title="TCP">TCP</a></li>
                                        <li><a href="#UDP-User-Datagram-Protocal-RFC-768" title="UDP (User Datagram Protocal) [RFC 768]">UDP (User Datagram Protocal) [RFC 768]</a></li>
                                        <li><a href="#Multiplexingdemultiplexing" title="Multiplexing/demultiplexing">Multiplexing/demultiplexing</a></li>
                                        <li>
                                            <a href="#Principles-of-reliable-data-transfer" title="Principles of reliable data transfer">Principles of reliable data transfer</a>
                                            <ul class="nav">
                                                <li><a href="#Pipelined-Protocal：" title="Pipelined Protocal：">Pipelined Protocal：</a></li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a href="#TCP1" title="TCP">TCP</a>
                                            <ul class="nav">
                                                <li><a href="#TCP-fast-retransmit" title="TCP fast retransmit">TCP fast retransmit</a></li>
                                                <li><a href="#Flow-Control" title="Flow Control">Flow Control</a></li>
                                                <li><a href="#Connection-Management" title="Connection Management">Connection Management</a></li>
                                                <li><a href="#Congestion-Control" title="Congestion Control">Congestion Control</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#Network-Layer" title="Network Layer">Network Layer</a>
                                    <ul class="nav">
                                        <li><a href="#Overview-of-Network-layer" title="Overview of Network layer">Overview of Network layer</a></li>
                                        <li>
                                            <a href="#Router-內部" title="Router 內部">Router 內部</a>
                                            <ul class="nav">
                                                <li><a href="#Switching-fabrics-交換的方法" title="Switching fabrics (交換的方法)">Switching fabrics (交換的方法)</a></li>
                                                <li><a href="#Queuing" title="Queuing">Queuing</a></li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a href="#IP" title="IP">IP</a>
                                            <ul class="nav">
                                                <li><a href="#IP-addressing-introduction" title="IP addressing: introduction">IP addressing: introduction</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#Dynamic-Host-Configuration-Protocol-DHCP" title="Dynamic Host Configuration Protocol (DHCP)">Dynamic Host Configuration Protocol (DHCP)</a></li>
                                        <li><a href="#Network-Address-Translation-NAT" title="Network Address Translation (NAT)">Network Address Translation (NAT)</a></li>
                                        <li>
                                            <a href="#Routing-Protocol-amp-Static-Route" title="Routing Protocol &amp; Static Route">Routing Protocol &amp; Static Route</a>
                                            <ul class="nav">
                                                <li><a href="#Dijkstra’s-algorithm-Link-State" title="Dijkstra’s algorithm (Link State)">Dijkstra’s algorithm (Link State)</a></li>
                                                <li><a href="#Distance-vector-algorithm-Bellman-Ford" title="Distance vector algorithm (Bellman-Ford)">Distance vector algorithm (Bellman-Ford)</a></li>
                                                <li><a href="#Routing-Information-Protocol-RIP" title="Routing Information Protocol (RIP)">Routing Information Protocol (RIP)</a></li>
                                                <li><a href="#OSPF-Open-Shortest-Path-First" title="OSPF (Open Shortest Path First)">OSPF (Open Shortest Path First)</a></li>
                                                <li><a href="#Static-route-amp-Default-route" title="Static route &amp; Default route">Static route &amp; Default route</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#Access-Control-List-ACL" title="Access Control List (ACL)">Access Control List (ACL)</a></li>
                                        <li><a href="#Simple-Network-Management-Protocol" title="Simple Network Management Protocol">Simple Network Management Protocol</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#Data-Link-Layer" title="Data-Link Layer">Data-Link Layer</a>
                                    <ul class="nav">
                                        <li><a href="#Introduction1" title="Introduction">Introduction</a></li>
                                        <li><a href="#Error-detection" title="Error detection">Error detection</a></li>
                                        <li>
                                            <a href="#Multiple-access-protocols" title="Multiple access protocols">Multiple access protocols</a>
                                            <ul class="nav">
                                                <li><a href="#Channel-Partitioning" title="Channel Partitioning">Channel Partitioning</a></li>
                                                <li><a href="#Random-Access" title="Random Access">Random Access</a></li>
                                                <li><a href="#“Taking-Turns”" title="“Taking Turns”">“Taking Turns”</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#MAC-address" title="MAC address">MAC address</a></li>
                                        <li><a href="#ARP-address-resolution-protocol" title="ARP (address resolution protocol)">ARP (address resolution protocol)</a></li>
                                        <li><a href="#Ethernet" title="Ethernet">Ethernet</a></li>
                                        <li><a href="#Ethernet-switch" title="Ethernet switch">Ethernet switch</a></li>
                                        <li>
                                            <a href="#VLAN-Virtual-LAN" title="VLAN (Virtual LAN)">VLAN (Virtual LAN)</a>
                                            <ul class="nav">
                                                <li><a href="#IEEE-8021Q-Frame：" title="IEEE 802.1Q (Frame)：">IEEE 802.1Q (Frame)：</a></li>
                                                <li><a href="#VLAN-aware-Network：" title="VLAN-aware Network：">VLAN-aware Network：</a></li>
                                                <li><a href="#VLAN-間的-routing-→-Inter-VLAN-routing" title="VLAN 間的 routing → Inter-VLAN routing">VLAN 間的 routing → Inter-VLAN routing</a></li>
                                            </ul>
                                        </li>
                                        <li>
                                            <a href="#STP-Spanning-Tree-Protocal-8021D" title="STP (Spanning Tree Protocal) (802.1D)">STP (Spanning Tree Protocal) (802.1D)</a>
                                            <ul class="nav">
                                                <li><a href="#RSTP-Rapid-Spanning-Tree-Protocol-8021W" title="RSTP (Rapid Spanning Tree Protocol) (802.1W)">RSTP (Rapid Spanning Tree Protocol) (802.1W)</a></li>
                                                <li><a href="#BDPU-Bridge-Protocol-Data-Units-8023-Ethernet" title="BDPU (Bridge Protocol Data Units) (802.3 Ethernet)">BDPU (Bridge Protocol Data Units) (802.3 Ethernet)</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#Virtual-Private-Network-VPN-" title="Virtual Private Network (VPN) ">Virtual Private Network (VPN) </a></li>
                                        <li>
                                            <a href="#Security" title="Security">Security</a>
                                            <ul class="nav">
                                                <li><a href="#Cisco-Discovery-Protocol-CDP" title="Cisco Discovery Protocol (CDP)">Cisco Discovery Protocol (CDP)</a></li>
                                                <li><a href="#Telnet-Attacks" title="Telnet Attacks">Telnet Attacks</a></li>
                                                <li><a href="#ARP-Spoofing" title="ARP Spoofing">ARP Spoofing</a></li>
                                                <li><a href="#MAC-Spoofing" title="MAC Spoofing">MAC Spoofing</a></li>
                                                <li><a href="#VLAN-Hopping" title="VLAN Hopping">VLAN Hopping</a></li>
                                                <li><a href="#Two-types-of-DHCP-attacks" title="Two types of DHCP attacks">Two types of DHCP attacks</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#EtherChannel-Link-Aggregation" title="EtherChannel (Link Aggregation)">EtherChannel (Link Aggregation)</a></li>
                                        <li>
                                            <a href="#First-Hop-Redundancy-Protocols-FHRP" title="First Hop Redundancy Protocols (FHRP)">First Hop Redundancy Protocols (FHRP)</a>
                                            <ul class="nav">
                                                <li><a href="#Hot-Standby-Router-Protocol-HSRP" title="Hot Standby Router Protocol (HSRP)">Hot Standby Router Protocol (HSRP)</a></li>
                                                <li><a href="#Virtual-Router-Redundancy-Protocol-VRRP-RFC-2338" title="Virtual Router Redundancy Protocol (VRRP) (RFC 2338">Virtual Router Redundancy Protocol (VRRP) (RFC 2338</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#網路協定-amp-Port-Number" title="網路協定 &amp; Port Number">網路協定 &amp; Port Number</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                        <div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
                    </ul>
                </div>
            </div>
            <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
                <div class="toc">
                    <ul class="nav">
                        <li class=""><a href="#Directory" title="Directory">Directory</a></li>
                        <li class="">
                            <a href="#Introduction" title="Introduction">Introduction</a>
                            <ul class="nav">
                                <li class=""><a href="#“Nuts-and-Bolts”-View" title="“Nuts and Bolts” View">“Nuts and Bolts” View</a></li>
                                <li><a href="#Network-Structure" title="Network Structure">Network Structure</a></li>
                                <li><a href="#Access-networks" title="Access networks">Access networks</a></li>
                                <li><a href="#Physical-media" title="Physical media">Physical media</a></li>
                                <li>
                                    <a href="#Network-Core" title="Network Core">Network Core</a>
                                    <ul class="nav">
                                        <li><a href="#Circuit-Switching" title="Circuit Switching">Circuit Switching</a></li>
                                        <li><a href="#Packet-Switching" title="Packet Switching">Packet Switching</a></li>
                                        <li><a href="#比較" title="比較">比較</a></li>
                                    </ul>
                                </li>
                                <li><a href="#計算" title="計算">計算</a></li>
                                <li><a href="#Layer--Protocal" title="Layer + Protocal">Layer + Protocal</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#Application-Layer" title="Application Layer">Application Layer</a>
                            <ul class="nav">
                                <li>
                                    <a href="#HTTP--HyperText-Transer-Protocal-" title="HTTP ( HyperText Transer Protocal )">HTTP ( HyperText Transer Protocal )</a>
                                    <ul class="nav">
                                        <li><a href="#use-TCP" title="use TCP">use TCP</a></li>
                                        <li><a href="#Stateless-" title="Stateless :">Stateless :</a></li>
                                        <li><a href="#HTTP-Connections-" title="HTTP Connections :">HTTP Connections :</a></li>
                                        <li><a href="#Request-Message" title="Request Message">Request Message</a></li>
                                        <li><a href="#Response-Message" title="Response Message">Response Message</a></li>
                                        <li><a href="#User-server-State--cookie" title="User-server State : cookie">User-server State : cookie</a></li>
                                        <li><a href="#Web-Caches-proxy-server-代理伺服器-" title="Web Caches (proxy server 代理伺服器) :">Web Caches (proxy server 代理伺服器) :</a></li>
                                        <li><a href="#Conditional-GET" title="Conditional GET">Conditional GET</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#Electronic-Email" title="Electronic Email">Electronic Email</a>
                                    <ul class="nav">
                                        <li><a href="#3-major-components" title="3 major components:">3 major components:</a></li>
                                        <li><a href="#過程：" title="過程：">過程：</a></li>
                                        <li><a href="#實作-不需要outlook…等等，打指令即可完成" title="實作 (不需要outlook…等等，打指令即可完成)">實作 (不需要outlook…等等，打指令即可完成)</a></li>
                                        <li><a href="#接收會用到的3種protocal" title="接收會用到的3種protocal">接收會用到的3種protocal</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#DNS-Domain-Name-System" title="DNS (Domain Name System)">DNS (Domain Name System)</a>
                                    <ul class="nav">
                                        <li><a href="#功能" title="功能">功能</a></li>
                                        <li><a href="#Hierarchy-階層性" title="Hierarchy 階層性">Hierarchy 階層性</a></li>
                                        <li><a href="#Name-Severs" title="Name Severs">Name Severs</a></li>
                                        <li><a href="#過程" title="過程">過程</a></li>
                                        <li><a href="#DNS-Records-amp-msg" title="DNS Records &amp; msg">DNS Records &amp; msg</a></li>
                                        <li><a href="#建立新的-DNS-伺服器" title="建立新的 DNS 伺服器">建立新的 DNS 伺服器</a></li>
                                        <li><a href="#Attack-DNS" title="Attack DNS">Attack DNS</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#Video-Streaming-and-Content-Distribution-Networks" title="Video Streaming and Content Distribution Networks">Video Streaming and Content Distribution Networks</a>
                                    <ul class="nav">
                                        <li><a href="#Multimedia--video" title="Multimedia : video">Multimedia : video</a></li>
                                        <li><a href="#Streaming-multimedia--DASH-Dynamic-Adaptive-Streaming-over-HTTP" title="Streaming multimedia : DASH (Dynamic, Adaptive Streaming over HTTP)">Streaming multimedia : DASH (Dynamic, Adaptive Streaming over HTTP)</a></li>
                                        <li><a href="#Content-Distribution-Networks-CDNs" title="Content Distribution Networks (CDNs)">Content Distribution Networks (CDNs)</a></li>
                                    </ul>
                                </li>
                                <li><a href="#Socket-Programming" title="Socket Programming">Socket Programming</a></li>
                                <li><a href="#important-themes" title="important themes:">important themes:</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#Transport-Layer" title="Transport Layer">Transport Layer</a>
                            <ul class="nav">
                                <li><a href="#Transport-Service" title="Transport Service">Transport Service</a></li>
                                <li><a href="#TCP" title="TCP">TCP</a></li>
                                <li><a href="#UDP-User-Datagram-Protocal-RFC-768" title="UDP (User Datagram Protocal) [RFC 768]">UDP (User Datagram Protocal) [RFC 768]</a></li>
                                <li><a href="#Multiplexingdemultiplexing" title="Multiplexing/demultiplexing">Multiplexing/demultiplexing</a></li>
                                <li>
                                    <a href="#Principles-of-reliable-data-transfer" title="Principles of reliable data transfer">Principles of reliable data transfer</a>
                                    <ul class="nav">
                                        <li><a href="#Pipelined-Protocal：" title="Pipelined Protocal：">Pipelined Protocal：</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#TCP1" title="TCP">TCP</a>
                                    <ul class="nav">
                                        <li><a href="#TCP-fast-retransmit" title="TCP fast retransmit">TCP fast retransmit</a></li>
                                        <li><a href="#Flow-Control" title="Flow Control">Flow Control</a></li>
                                        <li><a href="#Connection-Management" title="Connection Management">Connection Management</a></li>
                                        <li><a href="#Congestion-Control" title="Congestion Control">Congestion Control</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li>
                            <a href="#Network-Layer" title="Network Layer">Network Layer</a>
                            <ul class="nav">
                                <li><a href="#Overview-of-Network-layer" title="Overview of Network layer">Overview of Network layer</a></li>
                                <li>
                                    <a href="#Router-內部" title="Router 內部">Router 內部</a>
                                    <ul class="nav">
                                        <li><a href="#Switching-fabrics-交換的方法" title="Switching fabrics (交換的方法)">Switching fabrics (交換的方法)</a></li>
                                        <li><a href="#Queuing" title="Queuing">Queuing</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#IP" title="IP">IP</a>
                                    <ul class="nav">
                                        <li><a href="#IP-addressing-introduction" title="IP addressing: introduction">IP addressing: introduction</a></li>
                                    </ul>
                                </li>
                                <li><a href="#Dynamic-Host-Configuration-Protocol-DHCP" title="Dynamic Host Configuration Protocol (DHCP)">Dynamic Host Configuration Protocol (DHCP)</a></li>
                                <li><a href="#Network-Address-Translation-NAT" title="Network Address Translation (NAT)">Network Address Translation (NAT)</a></li>
                                <li>
                                    <a href="#Routing-Protocol-amp-Static-Route" title="Routing Protocol &amp; Static Route">Routing Protocol &amp; Static Route</a>
                                    <ul class="nav">
                                        <li><a href="#Dijkstra’s-algorithm-Link-State" title="Dijkstra’s algorithm (Link State)">Dijkstra’s algorithm (Link State)</a></li>
                                        <li><a href="#Distance-vector-algorithm-Bellman-Ford" title="Distance vector algorithm (Bellman-Ford)">Distance vector algorithm (Bellman-Ford)</a></li>
                                        <li><a href="#Routing-Information-Protocol-RIP" title="Routing Information Protocol (RIP)">Routing Information Protocol (RIP)</a></li>
                                        <li><a href="#OSPF-Open-Shortest-Path-First" title="OSPF (Open Shortest Path First)">OSPF (Open Shortest Path First)</a></li>
                                        <li><a href="#Static-route-amp-Default-route" title="Static route &amp; Default route">Static route &amp; Default route</a></li>
                                    </ul>
                                </li>
                                <li><a href="#Access-Control-List-ACL" title="Access Control List (ACL)">Access Control List (ACL)</a></li>
                                <li><a href="#Simple-Network-Management-Protocol" title="Simple Network Management Protocol">Simple Network Management Protocol</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="#Data-Link-Layer" title="Data-Link Layer">Data-Link Layer</a>
                            <ul class="nav">
                                <li><a href="#Introduction1" title="Introduction">Introduction</a></li>
                                <li><a href="#Error-detection" title="Error detection">Error detection</a></li>
                                <li>
                                    <a href="#Multiple-access-protocols" title="Multiple access protocols">Multiple access protocols</a>
                                    <ul class="nav">
                                        <li><a href="#Channel-Partitioning" title="Channel Partitioning">Channel Partitioning</a></li>
                                        <li><a href="#Random-Access" title="Random Access">Random Access</a></li>
                                        <li><a href="#“Taking-Turns”" title="“Taking Turns”">“Taking Turns”</a></li>
                                    </ul>
                                </li>
                                <li><a href="#MAC-address" title="MAC address">MAC address</a></li>
                                <li><a href="#ARP-address-resolution-protocol" title="ARP (address resolution protocol)">ARP (address resolution protocol)</a></li>
                                <li><a href="#Ethernet" title="Ethernet">Ethernet</a></li>
                                <li><a href="#Ethernet-switch" title="Ethernet switch">Ethernet switch</a></li>
                                <li>
                                    <a href="#VLAN-Virtual-LAN" title="VLAN (Virtual LAN)">VLAN (Virtual LAN)</a>
                                    <ul class="nav">
                                        <li><a href="#IEEE-8021Q-Frame：" title="IEEE 802.1Q (Frame)：">IEEE 802.1Q (Frame)：</a></li>
                                        <li><a href="#VLAN-aware-Network：" title="VLAN-aware Network：">VLAN-aware Network：</a></li>
                                        <li><a href="#VLAN-間的-routing-→-Inter-VLAN-routing" title="VLAN 間的 routing → Inter-VLAN routing">VLAN 間的 routing → Inter-VLAN routing</a></li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#STP-Spanning-Tree-Protocal-8021D" title="STP (Spanning Tree Protocal) (802.1D)">STP (Spanning Tree Protocal) (802.1D)</a>
                                    <ul class="nav">
                                        <li><a href="#RSTP-Rapid-Spanning-Tree-Protocol-8021W" title="RSTP (Rapid Spanning Tree Protocol) (802.1W)">RSTP (Rapid Spanning Tree Protocol) (802.1W)</a></li>
                                        <li><a href="#BDPU-Bridge-Protocol-Data-Units-8023-Ethernet" title="BDPU (Bridge Protocol Data Units) (802.3 Ethernet)">BDPU (Bridge Protocol Data Units) (802.3 Ethernet)</a></li>
                                    </ul>
                                </li>
                                <li><a href="#Virtual-Private-Network-VPN-" title="Virtual Private Network (VPN) ">Virtual Private Network (VPN) </a></li>
                                <li>
                                    <a href="#Security" title="Security">Security</a>
                                    <ul class="nav">
                                        <li><a href="#Cisco-Discovery-Protocol-CDP" title="Cisco Discovery Protocol (CDP)">Cisco Discovery Protocol (CDP)</a></li>
                                        <li><a href="#Telnet-Attacks" title="Telnet Attacks">Telnet Attacks</a></li>
                                        <li><a href="#ARP-Spoofing" title="ARP Spoofing">ARP Spoofing</a></li>
                                        <li><a href="#MAC-Spoofing" title="MAC Spoofing">MAC Spoofing</a></li>
                                        <li><a href="#VLAN-Hopping" title="VLAN Hopping">VLAN Hopping</a></li>
                                        <li><a href="#Two-types-of-DHCP-attacks" title="Two types of DHCP attacks">Two types of DHCP attacks</a></li>
                                    </ul>
                                </li>
                                <li><a href="#EtherChannel-Link-Aggregation" title="EtherChannel (Link Aggregation)">EtherChannel (Link Aggregation)</a></li>
                                <li>
                                    <a href="#First-Hop-Redundancy-Protocols-FHRP" title="First Hop Redundancy Protocols (FHRP)">First Hop Redundancy Protocols (FHRP)</a>
                                    <ul class="nav">
                                        <li><a href="#Hot-Standby-Router-Protocol-HSRP" title="Hot Standby Router Protocol (HSRP)">Hot Standby Router Protocol (HSRP)</a></li>
                                        <li><a href="#Virtual-Router-Redundancy-Protocol-VRRP-RFC-2338" title="Virtual Router Redundancy Protocol (VRRP) (RFC 2338">Virtual Router Redundancy Protocol (VRRP) (RFC 2338</a></li>
                                    </ul>
                                </li>
                                <li><a href="#網路協定-amp-Port-Number" title="網路協定 &amp; Port Number">網路協定 &amp; Port Number</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
            </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>-->
            
                
            <script>
                var markdown = $(".markdown-body");
                //smooth all hash trigger scrolling
                function smoothHashScroll() {
                    var hashElements = $("a[href^='#']").toArray();
                    for (var i = 0; i < hashElements.length; i++) {
                        var element = hashElements[i];
                        var $element = $(element);
                        var hash = element.hash;
                        if (hash) {
                            $element.on('click', function (e) {
                                // store hash
                                var hash = this.hash;
                                if ($(hash).length <= 0) return;
                                // prevent default anchor click behavior
                                e.preventDefault();
                                // animate
                                $('body, html').stop(true, true).animate({
                                    scrollTop: $(hash).offset().top
                                }, 100, "linear", function () {
                                    // when done, add hash to url
                                    // (default click behaviour)
                                    window.location.hash = hash;
                                });
                            });
                        }
                    }
                }
                
                smoothHashScroll();
                var toc = $('.ui-toc');
                var tocAffix = $('.ui-affix-toc');
                var tocDropdown = $('.ui-toc-dropdown');
                //toc
                tocDropdown.click(function (e) {
                    e.stopPropagation();
                });
                
                var enoughForAffixToc = true;
                
                function generateScrollspy() {
                    $(document.body).scrollspy({
                        target: ''
                    });
                    $(document.body).scrollspy('refresh');
                    if (enoughForAffixToc) {
                        toc.hide();
                        tocAffix.show();
                    } else {
                        tocAffix.hide();
                        toc.show();
                    }
                    $(document.body).scroll();
                }
                
                function windowResize() {
                    //toc right
                    var paddingRight = parseFloat(markdown.css('padding-right'));
                    var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
                    toc.css('right', right + 'px');
                    //affix toc left
                    var newbool;
                    var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
                    //for ipad or wider device
                    if (rightMargin >= 133) {
                        newbool = true;
                        var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                        var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                        tocAffix.css('left', left + 'px');
                    } else {
                        newbool = false;
                    }
                    if (newbool != enoughForAffixToc) {
                        enoughForAffixToc = newbool;
                        generateScrollspy();
                    }
                }
                $(window).resize(function () {
                    windowResize();
                });
                $(document).ready(function () {
                    windowResize();
                    generateScrollspy();
                });
                
                //remove hash
                function removeHash() {
                    window.location.hash = '';
                }
                
                var backtotop = $('.back-to-top');
                var gotobottom = $('.go-to-bottom');
                
                backtotop.click(function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (scrollToTop)
                        scrollToTop();
                    removeHash();
                });
                gotobottom.click(function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (scrollToBottom)
                        scrollToBottom();
                    removeHash();
                });
                
                var toggle = $('.expand-toggle');
                var tocExpand = false;
                
                checkExpandToggle();
                toggle.click(function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    tocExpand = !tocExpand;
                    checkExpandToggle();
                })
                
                function checkExpandToggle () {
                    var toc = $('.ui-toc-dropdown .toc');
                    var toggle = $('.expand-toggle');
                    if (!tocExpand) {
                        toc.removeClass('expand');
                        toggle.text('Expand all');
                    } else {
                        toc.addClass('expand');
                        toggle.text('Collapse all');
                    }
                }
                
                function scrollToTop() {
                    $('body, html').stop(true, true).animate({
                        scrollTop: 0
                    }, 100, "linear");
                }
                
                function scrollToBottom() {
                    $('body, html').stop(true, true).animate({
                        scrollTop: $(document.body)[0].scrollHeight
                    }, 100, "linear");
                }
            </script>
            <footer>
            </footer>
        </div>
        <!-- Copyright -->
        <div id="copyright">
            <ul class="icons alt">
                <li><a href="https://github.com/hcyanyuuu" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
            </ul>
            <ul>
                <li><br>&copy; Untitled</li>
                <li>Design: <a href="https://html5up.net">HTML5 UP</a></li>
            </ul>
        </div>
        <!-- Scripts -->
        <script src="assets/js/jquery.min.js"></script>
        <script src="assets/js/jquery.scrollex.min.js"></script>
        <script src="assets/js/jquery.scrolly.min.js"></script>
        <script src="assets/js/browser.min.js"></script>
        <script src="assets/js/breakpoints.min.js"></script>
        <script src="assets/js/util.js"></script>
        <script src="assets/js/main.js"></script>
    </body>
</html>